import{R as de,j as e,r as d,M as J}from"./react-vendor-CNZAW3Qf.js";import{s as Y,f as z,h as ce,i as me}from"./services-BOnxyvYK.js";import{n as T}from"./chat-services-Br033muk.js";import{r as Z}from"./markdown-vendor-q4liMzTk.js";const xe=({isManualMode:t,onToggle:c,isConnected:n=!1})=>{const m=t?"Manual review is ON (paused). Click to resume auto-sending screenshots.":"Auto-sending is ON. Click to pause and review screenshots manually.";return n?e.jsx("button",{type:"button",onClick:c,className:`w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-gradient-to-r from-[#2E2E2E]/90 to-[#1C1C1C]/90 flex items-center justify-center transition-all duration-300 hover:scale-105 ${t?"text-yellow-400":"text-emerald-400"}`,"aria-pressed":t,"aria-label":t?"Resume auto-sending screenshots":"Pause and review screenshots",title:m,children:t?e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}):e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})}):null},he=de.memo(xe),ue=({isConnected:t,isProcessing:c,isManualUploadMode:n,onRequestConnect:m,usage:u})=>{const[p,r]=d.useState("single"),[g,j]=d.useState(!1),N=d.useRef(null),F=d.useRef(null),l=d.useRef(null),[y,v]=d.useState(!1),i=(u==null?void 0:u.tier)==="pro"||(u==null?void 0:u.tier)==="vanguard_pro",s=(u==null?void 0:u.tier)==="free";d.useEffect(()=>{const h=localStorage.getItem("otakon_screenshot_mode");h==="single"||h==="multi"&&i?r(h):h==="multi"&&!i&&(r("single"),localStorage.setItem("otakon_screenshot_mode","single")),v(!1)},[i]);const w=h=>{h==="multi"&&!i||(r(h),localStorage.setItem("otakon_screenshot_mode",h),j(!1))};d.useEffect(()=>{const h=C=>{N.current&&(N.current.contains(C.target)||j(!1))};return g&&document.addEventListener("mousedown",h,{passive:!0}),()=>document.removeEventListener("mousedown",h)},[g]);const f=h=>{j(!0)},D=h=>{if(h.preventDefault(),h.stopPropagation(),!t){m==null||m();return}f()},x=h=>{if(h.button===2){if(h.preventDefault(),h.stopPropagation(),!t){m==null||m();return}f()}},E=()=>{l.current&&window.clearTimeout(l.current),l.current=window.setTimeout(()=>{if(!t){m==null||m();return}f()},1750)},A=()=>{l.current&&(window.clearTimeout(l.current),l.current=null)},I=async()=>{if(!t){m==null||m();return}if(c||p==="multi"&&!i)return;const C={type:"screenshot_request",mode:p,processImmediate:n?!1:p==="single"};p==="multi"&&(C.count=5),typeof Y=="function"?(Y(C),console.log("ðŸ“¸ Screenshot request sent:",C)):console.warn("WebSocket send function not available")},H=()=>{if(!i){j(!1);return}w("multi")};return e.jsxs("div",{ref:N,className:"relative",children:[e.jsx("button",{ref:F,type:"button",onClick:I,onContextMenu:D,onMouseDown:x,onTouchStart:E,onTouchEnd:A,onTouchCancel:A,"aria-disabled":!t||c,className:`${t?"text-emerald-400":"text-[#8A8A8A]"} w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-gradient-to-r from-[#2E2E2E]/90 to-[#1C1C1C]/90 flex items-center justify-center transition-all duration-300 ${t?"hover:scale-105":"opacity-70 cursor-pointer hover:opacity-90"} ${c?"animate-pulse":""}`,title:t?"Screenshot (right-click/long-press to change mode)":"Connect your PC to enable screenshots",children:p==="single"?e.jsxs("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"12",rx:"2"}),e.jsx("path",{d:"M8 20h8"}),e.jsx("path",{d:"M7 7h3M7 10h3M14 7h3"}),e.jsx("path",{d:"M4 3v4M4 3h4"})]}):e.jsxs("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("rect",{x:"4",y:"5",width:"14",height:"9",rx:"2"}),e.jsx("rect",{x:"6",y:"10",width:"14",height:"9",rx:"2"}),e.jsx("path",{d:"M10 22h6"})]})}),y&&t&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-3 top-full text-xs text-[#CFCFCF] bg-[#101010]/95 border border-[#424242]/60 rounded-lg px-3 py-2 shadow-lg whitespace-nowrap z-50",children:e.jsx("button",{type:"button",onClick:()=>{v(!1),localStorage.setItem("otakon_screenshot_hint_seen","1")},className:"w-full h-full",children:"Press & hold (1.75s) or right-click to change mode"})}),g&&t&&e.jsxs("div",{className:"absolute bottom-full right-0 mb-3 bg-[#101010]/98 border border-[#424242]/60 rounded-xl shadow-2xl min-w-[200px] overflow-hidden z-[9999] backdrop-blur-md",children:[e.jsxs("button",{onClick:()=>w("single"),className:`w-full text-left px-4 py-3 hover:bg-[#2E2E2E]/60 transition-colors ${p==="single"?"text-emerald-400":"text-[#CFCFCF]"}`,children:["ðŸ“¸ Single Shot ",p==="single"?"âœ“":""]}),e.jsx("button",{onClick:H,className:`w-full text-left px-4 py-3 transition-all duration-200 ${i?`hover:bg-[#2E2E2E]/60 ${p==="multi"?"text-emerald-400":"text-[#CFCFCF]"}`:"text-[#666666] cursor-not-allowed opacity-60"}`,disabled:!i,children:i?e.jsxs(e.Fragment,{children:["ðŸ“¸ Multi Shot (5) ",p==="multi"?"âœ“":""]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"ðŸ”’ Multi Shot (5)"}),e.jsx("span",{className:"text-xs bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] text-white px-2 py-1 rounded-full",children:"PRO"})]})}),s&&e.jsx("div",{className:"px-4 py-2 text-xs text-[#999999] border-t border-[#424242]/40",children:"Upgrade to Pro for batch screenshots"})]})]})},fe=({className:t})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),pe=({className:t})=>e.jsxs("svg",{className:t,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-label":"User Avatar",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"avatar-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#FF4D4D"}),e.jsx("stop",{offset:"100%",stopColor:"#FFAB40"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"12",fill:"url(#avatar-gradient)"})]}),Q=({className:t})=>e.jsxs("svg",{className:t,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-label":"AI Avatar",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"ai-avatar-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#5B99E3"}),e.jsx("stop",{offset:"100%",stopColor:"#4CAF50"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"12",fill:"url(#ai-avatar-gradient)"}),e.jsx("path",{d:"M8 12h8M12 8v8",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})]}),ge=({variant:t="dots",showText:c=!0,className:n=""})=>t==="dots"?e.jsxs("div",{className:`flex items-center gap-2 py-2 px-3 ${n}`,children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-[#FF4D4D] rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-[#FFAB40] rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-[#5CBB7B] rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),c&&e.jsx("span",{className:"text-sm text-[#A3A3A3] font-medium",children:"AI is thinking..."})]}):t==="skeleton"?e.jsxs("div",{className:`flex flex-col gap-3 py-3 px-4 ${n}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] rounded-full animate-pulse"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 bg-gradient-to-r from-[#FF4D4D]/20 to-[#FFAB40]/20 rounded animate-pulse",style:{width:"60%"}}),e.jsx("div",{className:"h-3 bg-gradient-to-r from-[#FFAB40]/20 to-[#5CBB7B]/20 rounded animate-pulse",style:{width:"80%"}})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gradient-to-r from-[#5CBB7B]/20 to-[#FF4D4D]/20 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gradient-to-r from-[#FF4D4D]/20 to-[#FFAB40]/20 rounded animate-pulse",style:{width:"70%"}}),e.jsx("div",{className:"h-4 bg-gradient-to-r from-[#FFAB40]/20 to-[#5CBB7B]/20 rounded animate-pulse",style:{width:"90%"}})]}),c&&e.jsx("span",{className:"text-sm text-[#A3A3A3] font-medium",children:"AI is thinking..."})]}):t==="wave"?e.jsxs("div",{className:`flex items-center gap-3 py-3 px-4 ${n}`,children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-1 h-4 bg-[#FF4D4D] rounded-full animate-pulse",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-1 h-4 bg-[#FFAB40] rounded-full animate-pulse",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-1 h-4 bg-[#5CBB7B] rounded-full animate-pulse",style:{animationDelay:"300ms"}}),e.jsx("div",{className:"w-1 h-4 bg-[#FF4D4D] rounded-full animate-pulse",style:{animationDelay:"450ms"}})]}),c&&e.jsx("span",{className:"text-sm text-[#A3A3A3] font-medium",children:"AI is thinking..."})]}):t==="circular"?e.jsxs("div",{className:`flex items-center gap-3 py-3 px-4 ${n}`,children:[e.jsxs("div",{className:"relative w-8 h-8",children:[e.jsx("div",{className:"absolute inset-0 w-8 h-8 border-2 border-[#424242]/30 rounded-full"}),e.jsx("div",{className:"absolute inset-0 w-8 h-8 border-2 border-transparent border-t-[#E53A3A] border-r-[#D98C1F] border-b-transparent rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] rounded-full animate-pulse"})})]}),c&&e.jsx("span",{className:"text-sm text-[#A3A3A3] font-medium",children:"AI is thinking..."})]}):null,be=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:t,"aria-hidden":"true",children:e.jsx("path",{d:"M12 4L4 12h5v8h6v-8h5L12 4z"})}),je=({prompts:t,onPromptClick:c,isLoading:n,conversationId:m=""})=>{const[u,p]=d.useState(!1),[r,g]=d.useState(!0),[j,N]=d.useState(new Set),l=(m==="game-hub"||m==="everything-else")&&t.length===T.length&&t.every((i,s)=>i===T[s]),y=l?T:t;d.useEffect(()=>{const i=window.matchMedia("(max-width: 640px)"),s=()=>{p(i.matches),g(!0)};return s(),i.addEventListener("change",s),()=>i.removeEventListener("change",s)},[]),d.useEffect(()=>{if(l){const i=new Set(T.filter(s=>z.isPromptUsed(s)));N(i)}},[l,y]);const v=i=>{l&&(z.markPromptAsUsed(i),N(s=>new Set([...s,i]))),c(i)};return n||y.length===0||l&&z.areAllPromptsUsed(T)?null:e.jsxs("div",{className:"pt-3 animate-fade-in",children:[u&&l&&e.jsxs("button",{type:"button","aria-expanded":r,onClick:()=>g(i=>!i),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg border border-[#424242]/40 bg-[#1C1C1C]/60 text-[#E5E5E5] text-sm font-medium mb-2",children:[e.jsx("span",{children:"Gaming News Suggestions"}),e.jsx("svg",{className:`w-4 h-4 transition-transform ${r?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.25 8.29a.75.75 0 01-.02-1.08z",clipRule:"evenodd"})})]}),(!u||r)&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:y.map((i,s)=>{const w=l&&j.has(i);return e.jsx("button",{onClick:()=>!w&&v(i),disabled:w,className:`text-left p-3 sm:p-4 border rounded-lg sm:rounded-xl transition-all duration-200 backdrop-blur-sm ${w?"bg-[#2A2A2A]/60 border-[#555555]/30 text-[#888888] cursor-not-allowed opacity-70":"bg-[#1C1C1C]/60 border-[#424242]/40 text-[#CFCFCF] hover:bg-[#E53A3A]/20 hover:border-[#E53A3A]/60 hover:scale-[1.02] active:scale-95"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:`font-medium text-xs sm:text-sm leading-relaxed flex-1 ${w?"text-[#888888]":"text-[#CFCFCF]"}`,children:i}),w&&e.jsx("span",{className:"text-[#5CBB7B] text-sm flex-shrink-0","aria-label":"Used",children:"âœ“"})]})},s)})})]})},we=({isActive:t,onClick:c,disabled:n=!1})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sm:hidden inline-flex items-center bg-[#2E2E2E]/80 rounded-lg p-0.5 backdrop-blur-sm border border-[#424242]/30",children:[e.jsx("button",{onClick:t?void 0:c,disabled:n,className:`
            px-3 py-1.5 text-[10px] font-semibold rounded-md transition-all duration-200 whitespace-nowrap
            ${t?"text-[#A3A3A3] hover:text-[#F5F5F5]":"bg-gradient-to-r from-[#FF4D4D] to-[#FF6B6B] text-white shadow-md"}
            ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
          `,children:"Planning"}),e.jsx("button",{onClick:t?c:void 0,disabled:n,className:`
            px-3 py-1.5 text-[10px] font-semibold rounded-md transition-all duration-200 whitespace-nowrap
            ${t?"bg-gradient-to-r from-[#FF4D4D] to-[#FF6B6B] text-white shadow-md":"text-[#A3A3A3] hover:text-[#F5F5F5]"}
            ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
          `,children:"Playing"})]}),e.jsxs("div",{className:"hidden sm:inline-flex items-center gap-3",children:[e.jsx("span",{className:`text-sm font-medium transition-colors duration-200 whitespace-nowrap ${t?"text-[#A3A3A3]":"text-[#FF4D4D]"}`,children:"Planning"}),e.jsx("button",{onClick:c,disabled:n,className:`
            relative inline-flex h-6 w-11 flex-shrink-0 items-center rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#FF4D4D] focus:ring-offset-2 focus:ring-offset-[#1C1C1C]
            ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
            ${t?"bg-[#FF4D4D]":"bg-[#424242]"}
          `,role:"switch","aria-checked":t,"aria-label":t?"Switch to Planning mode":"Switch to Playing mode",children:e.jsx("span",{className:`
              inline-block h-4 w-4 transform rounded-full bg-white transition-transform duration-200
              ${t?"translate-x-6":"translate-x-1"}
            `})}),e.jsx("span",{className:`text-sm font-medium transition-colors duration-200 whitespace-nowrap ${t?"text-[#FF4D4D]":"text-[#A3A3A3]"}`,children:"Playing"})]})]}),ve=({subtabs:t=[],activeTabId:c,onTabClick:n,isLoading:m=!1})=>{var i;const[u,p]=d.useState(c||((i=t[0])==null?void 0:i.id)||""),[r,g]=d.useState(!1),[j,N]=d.useState(!1),F=c||u,l=t.find(s=>s.id===F);console.error("ðŸŽ¨ [SubTabs] Rendering:",{subtabCount:t.length,statuses:t.map(s=>({title:s.title,status:s.status,hasContent:!!s.content})),isExpanded:r,hasUserInteracted:j,activeTabTitle:l==null?void 0:l.title,activeTabStatus:l==null?void 0:l.status,activeTabHasContent:!!(l!=null&&l.content)}),d.useEffect(()=>{if(j)return;const s=t.every(x=>x.status==="loading"),w=t.some(x=>x.status==="loaded"),f=t.every(x=>x.status==="loaded"),D=t.some(x=>x.status==="loaded"&&x.content&&x.content.trim().length>0&&x.content.trim()!=="Loading...");console.error("ðŸ“‚ [SubTabs] useEffect triggered:",{allLoading:s,anyLoaded:w,allLoaded:f,hasLoadedContent:D,isExpanded:r,hasUserInteracted:j,subtabStatuses:t.map(x=>({title:x.title,status:x.status})),subtabContentLengths:t.map(x=>{var E;return{title:x.title,length:((E=x.content)==null?void 0:E.length)||0}})}),s&&r&&(console.error("ðŸ“‚ [SubTabs] Collapsing subtabs - all loading"),g(!1)),w&&!r&&(console.error("ðŸ“‚ [SubTabs] âœ… AUTO-EXPANDING - detected loaded subtabs"),g(!0)),f&&!r&&t.length>0&&(console.error("ðŸ“‚ [SubTabs] âœ… AUTO-EXPANDING - all subtabs loaded"),g(!0))},[t,r,j]);const y=s=>{p(s),n==null||n(s)},v=()=>{g(!r),N(!0)};return!t||t.length===0?null:e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{onClick:v,className:"w-full flex items-center justify-between mb-2 py-2 px-3 rounded-lg bg-[#1C1C1C]/50 hover:bg-[#1C1C1C] border border-[#424242]/30 hover:border-[#424242]/60 transition-all duration-200",children:[e.jsx("div",{className:"text-xs font-semibold text-[#A3A3A3] uppercase tracking-wider",children:"Lore & Insights"}),e.jsx("svg",{className:`w-4 h-4 text-[#A3A3A3] transition-transform duration-200 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx("div",{className:`transition-all duration-300 ease-in-out overflow-hidden ${r?"max-h-[500px] opacity-100":"max-h-0 opacity-0"}`,children:e.jsxs("div",{className:"bg-[#1C1C1C]/60 border border-[#424242]/40 rounded-xl backdrop-blur-sm",children:[e.jsx("div",{className:"flex items-center gap-2 p-2 sm:p-3 border-b border-[#424242]/40",children:e.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2 flex-1",children:t.map(s=>e.jsx("button",{onClick:()=>y(s.id),className:`
                    px-3 py-2 text-xs font-medium rounded-lg transition-all duration-200 whitespace-nowrap
                    ${F===s.id?"bg-[#FF4D4D] text-white shadow-lg":"bg-[#2E2E2E]/60 text-[#A3A3A3] hover:bg-[#424242]/60 hover:text-[#F5F5F5]"}
                    ${s.isNew?"ring-2 ring-[#FF4D4D]/50":""}
                  `,disabled:m,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.isNew&&e.jsx("div",{className:"w-2 h-2 bg-[#FF4D4D] rounded-full animate-pulse"}),e.jsx("span",{children:s.title}),s.status==="loading"&&e.jsx("div",{className:"w-3 h-3 border border-current border-t-transparent rounded-full animate-spin"}),s.status==="error"&&e.jsx("div",{className:"w-3 h-3 text-red-400",children:"âš "})]})},s.id))})}),l&&e.jsx("div",{className:"p-4 max-h-64 overflow-y-auto transition-all duration-300",children:l.status==="loading"||!l.content&&m?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-3 text-[#A3A3A3]",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-[#FF4D4D] border-t-transparent rounded-full animate-spin"}),e.jsxs("span",{children:["Loading ",l.title,"..."]})]})}):l.status==="error"?e.jsxs("div",{className:"text-center py-8 text-[#A3A3A3]",children:[e.jsx("div",{className:"text-4xl mb-2",children:"âš ï¸"}),e.jsxs("p",{children:["Failed to load ",l.title," content"]}),e.jsx("p",{className:"text-sm mt-1",children:"Please try again later"})]}):l.content?e.jsx("div",{className:"prose prose-invert prose-sm max-w-none",children:e.jsx(J,{remarkPlugins:[Z],components:{h1:({children:s})=>e.jsx("h1",{className:"text-lg font-bold text-[#F5F5F5] mb-3",children:s}),h2:({children:s})=>e.jsx("h2",{className:"text-base font-semibold text-[#F5F5F5] mb-2",children:s}),h3:({children:s})=>e.jsx("h3",{className:"text-sm font-semibold text-[#F5F5F5] mb-2",children:s}),p:({children:s})=>e.jsx("p",{className:"text-[#CFCFCF] leading-relaxed mb-2",children:s}),ul:({children:s})=>e.jsx("ul",{className:"list-disc list-inside text-[#CFCFCF] mb-2 space-y-1",children:s}),ol:({children:s})=>e.jsx("ol",{className:"list-decimal list-inside text-[#CFCFCF] mb-2 space-y-1",children:s}),li:({children:s})=>e.jsx("li",{className:"text-[#CFCFCF]",children:s}),strong:({children:s})=>e.jsx("strong",{className:"font-semibold text-[#F5F5F5]",children:s}),em:({children:s})=>e.jsx("em",{className:"italic text-[#E0E0E0]",children:s}),code:({children:s})=>e.jsx("code",{className:"bg-[#2E2E2E] text-[#FF4D4D] px-1 py-0.5 rounded text-xs font-mono",children:s}),pre:({children:s})=>e.jsx("pre",{className:"bg-[#1C1C1C] border border-[#424442] rounded-lg p-3 overflow-x-auto",children:s}),blockquote:({children:s})=>e.jsx("blockquote",{className:"border-l-4 border-[#FF4D4D] pl-4 italic text-[#B0B0B0] my-2",children:s})},children:l.content})}):e.jsx("div",{className:"text-center py-8 text-[#A3A3A3]",children:e.jsxs("p",{children:["No content available for ",l.title]})})})]})})]})},Ne=({message:t,suggestedPrompts:c,onSuggestedPromptClick:n,isLoading:m,conversationId:u,onDownloadImage:p})=>e.jsx("div",{className:`flex ${t.role==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] ${t.role==="user"?"chat-message-user":"chat-message-ai"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:t.role==="user"?e.jsx(pe,{className:"w-6 h-6 sm:w-8 sm:h-8 flex-shrink-0 text-[#D98C1F]"}):e.jsx(Q,{className:"w-6 h-6 sm:w-8 sm:h-8 flex-shrink-0"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[t.imageUrl&&e.jsxs("div",{className:"chat-image-container mb-3",children:[e.jsx("img",{src:t.imageUrl,alt:"Uploaded",className:"w-full max-w-sm rounded-lg"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3 pt-3 border-t border-[#424242]/30",children:e.jsxs("button",{onClick:()=>p(t.imageUrl||"",0),className:"flex items-center justify-center gap-2 px-2 sm:px-3 py-1.5 sm:py-2 border border-[#FF4D4D] text-[#FF4D4D] text-xs sm:text-sm font-medium rounded-lg hover:bg-[#FF4D4D] hover:text-white transition-all duration-300 hover:scale-105",title:"Download this screenshot",children:[e.jsx(fe,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Download"})]})})]}),e.jsx("div",{className:"text-[#F5F5F5] leading-relaxed",children:e.jsx(J,{remarkPlugins:[Z],components:{h1:({children:r})=>e.jsx("h1",{className:"text-lg font-bold text-[#F5F5F5] mb-3 mt-2",children:r}),h2:({children:r})=>e.jsx("h2",{className:"text-base font-semibold text-[#F5F5F5] mb-2 mt-2",children:r}),h3:({children:r})=>e.jsx("h3",{className:"text-sm font-semibold text-[#F5F5F5] mb-2 mt-2",children:r}),p:({children:r})=>e.jsx("p",{className:"text-[#CFCFCF] leading-relaxed mb-3",children:r}),ul:({children:r})=>e.jsx("ul",{className:"list-disc list-outside ml-5 text-[#CFCFCF] mb-3 space-y-1.5",children:r}),ol:({children:r})=>e.jsx("ol",{className:"list-decimal list-outside ml-5 text-[#CFCFCF] mb-3 space-y-1.5",children:r}),li:({children:r})=>e.jsx("li",{className:"text-[#CFCFCF] leading-relaxed",children:r}),strong:({children:r})=>e.jsx("strong",{className:"font-semibold text-[#F5F5F5]",children:r}),em:({children:r})=>e.jsx("em",{className:"italic text-[#E0E0E0]",children:r}),code:({children:r})=>e.jsx("code",{className:"bg-[#2E2E2E] text-[#FF4D4D] px-1.5 py-0.5 rounded text-xs font-mono",children:r}),pre:({children:r})=>e.jsx("pre",{className:"bg-[#1C1C1C] border border-[#424242] rounded-lg p-3 overflow-x-auto mb-3",children:r}),blockquote:({children:r})=>e.jsx("blockquote",{className:"border-l-4 border-[#FF4D4D] pl-4 italic text-[#B0B0B0] my-3",children:r}),br:()=>e.jsx("br",{className:"my-1"})},children:t.content})}),t.role==="assistant"&&c.length>0&&n&&!m&&e.jsx("div",{className:"mt-4",children:e.jsx(je,{prompts:c,onPromptClick:n,isLoading:m,conversationId:u})}),e.jsx("p",{className:"text-xs text-[#A3A3A3] mt-3",children:new Date(t.timestamp).toLocaleTimeString()})]})]})})}),q=d.memo(Ne,(t,c)=>t.message.id===c.message.id&&t.message.content===c.message.content&&t.message.timestamp===c.message.timestamp&&t.isLoading===c.isLoading&&t.suggestedPrompts.length===c.suggestedPrompts.length);q.displayName="MemoizedChatMessage";const ke=({conversation:t,onSendMessage:c,isLoading:n,isPCConnected:m=!1,onRequestConnect:u,userTier:p="free",onStop:r,isManualUploadMode:g=!1,onToggleManualUploadMode:j,suggestedPrompts:N=[],onSuggestedPromptClick:F,activeSession:l,onToggleActiveSession:y,initialMessage:v="",onMessageChange:i,queuedImage:s=null,onImageQueued:w})=>{const[f,D]=d.useState(v),[x,E]=d.useState(null),[A,I]=d.useState(null),[H,h]=d.useState(!1),[C,M]=d.useState(!1),[$,ee]=d.useState([]),[W,P]=d.useState(0),[G,U]=d.useState(!0),O=d.useRef(null),L=d.useRef(null),_=d.useRef(null),te=d.useRef(null),se=()=>{var a;(a=O.current)==null||a.scrollIntoView({behavior:"smooth"})},R=()=>{const a=_.current;if(a){a.style.height="auto";const k=a.scrollHeight,B=Math.min(Math.max(k,44),120);a.style.height=`${B}px`}},ae=a=>{const o=a.target.value;if(D(o),R(),i==null||i(o),t&&o.startsWith("@")){const b=me.getAvailableTabNames(t);b.length>0?(ee(b),M(!0),P(0)):M(!1)}else M(!1)},V=a=>{var o;D(`@${a} `),M(!1),(o=_.current)==null||o.focus()},re=a=>{if(C&&$.length>0){if(a.key==="ArrowDown"){a.preventDefault(),P(o=>o<$.length-1?o+1:0);return}else if(a.key==="ArrowUp"){a.preventDefault(),P(o=>o>0?o-1:$.length-1);return}else if(a.key==="Tab"||a.key==="Enter"&&C){a.preventDefault(),V($[W]);return}else if(a.key==="Escape"){a.preventDefault(),M(!1);return}}a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),X(a))};d.useEffect(()=>{se()},[t==null?void 0:t.messages]),d.useEffect(()=>{R()},[f]),d.useEffect(()=>{v!==void 0&&v!==f&&D(v)},[v]),d.useEffect(()=>{s&&g&&(console.log("ðŸ“¸ [ChatInterface] Queued image received from WebSocket:",{queuedImageLength:s.length,queuedImagePreview:s.substring(0,50),currentImagePreview:A==null?void 0:A.substring(0,50),isManualUploadMode:g}),I(s),w==null||w())},[s,g]);const X=a=>{if(a.preventDefault(),console.log("ðŸ“¤ [ChatInterface] Submit attempt:",{message:f.trim(),hasMessage:!!f.trim(),hasImageFile:!!x,hasImagePreview:!!A,shouldSubmit:!(!f.trim()&&!x)}),!f.trim()&&!x){console.log("ðŸ“¤ [ChatInterface] Submission blocked: no message and no image");return}t!=null&&t.isGameHub&&U(!1);const o=A||void 0;console.log("ðŸ“¤ [ChatInterface] Submitting:",{message:f,hasImage:!!o,imageUrl:(o==null?void 0:o.substring(0,50))+"..."}),c(f,o),D(""),E(null),I(null),L.current&&(L.current.value="")},le=a=>{var b;const o=(b=a.target.files)==null?void 0:b[0];if(console.log("ðŸ“¸ [ChatInterface] Image upload:",{file:o,fileName:o==null?void 0:o.name,fileSize:o==null?void 0:o.size}),o){E(o);const k=new FileReader;k.onload=B=>{var K;const S=(K=B.target)==null?void 0:K.result;console.log("ðŸ“¸ [ChatInterface] Image preview created:",{hasResult:!!S,resultLength:S==null?void 0:S.length,resultStart:(S==null?void 0:S.substring(0,50))+"..."}),I(S)},k.readAsDataURL(o)}},ne=()=>{E(null),I(null),L.current&&(L.current.value="")},ie=()=>{j==null||j()},oe=(a,o)=>{try{const b=document.createElement("a");b.href=a;const k=new Date().toISOString().slice(0,19).replace(/:/g,"-"),B=`otakon-screenshot-${o+1}-${k}.png`;b.download=B,document.body.appendChild(b),b.click(),document.body.removeChild(b)}catch(b){console.error("Failed to download image:",b),window.open(a,"_blank")}};return t?t?e.jsxs("div",{className:"h-full bg-gradient-to-r from-surface/30 to-background/30 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:`flex-1 p-6 space-y-6 min-h-0 ${t.messages.length>0?"overflow-y-auto custom-scrollbar":"overflow-y-hidden"}`,children:[t.messages.length===0?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-text-muted text-lg",children:["Start a conversation with ",e.jsx("span",{className:"bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] bg-clip-text text-transparent font-semibold",children:"Otagon"})]}),e.jsx("p",{className:"text-text-muted text-sm mt-2",children:"Ask me anything about gaming, strategies, or tips."})]})}):t.messages.map(a=>e.jsx(q,{message:a,suggestedPrompts:a.role==="assistant"?N:[],onSuggestedPromptClick:F,isLoading:n,conversationId:t==null?void 0:t.id,onDownloadImage:oe},a.id)),n&&e.jsx("div",{className:"flex justify-start",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Q,{className:"w-6 h-6 sm:w-8 sm:h-8 flex-shrink-0"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 py-2 sm:py-3",children:[e.jsx(ge,{variant:"dots",showText:!1}),r&&e.jsx("button",{onClick:r,className:"text-xs font-semibold px-2 sm:px-3 py-1 sm:py-1.5 rounded-full transition-all duration-200 bg-[#424242]/60 text-[#CFCFCF] hover:bg-[#424242] hover:text-[#F5F5F5] hover:scale-105","aria-label":"Stop generating response",children:"Stop"})]})})]})}),e.jsx("div",{ref:O})]}),t&&!t.isGameHub&&!t.isUnreleased&&t.subtabs&&t.subtabs.length>0&&e.jsx("div",{className:"flex-shrink-0 px-3 pb-2",children:e.jsx(ve,{subtabs:t.subtabs,isLoading:n},`subtabs-${t.id}-${t.subtabs.filter(a=>a.status==="loaded").length}`)}),(t==null?void 0:t.isGameHub)&&e.jsxs("div",{className:"flex-shrink-0 px-3 pb-3",children:[e.jsxs("button",{onClick:()=>U(!G),className:"w-full flex items-center justify-between mb-2 py-2 px-3 rounded-lg bg-[#1C1C1C]/50 hover:bg-[#1C1C1C] border border-[#424242]/30 hover:border-[#424242]/60 transition-all duration-200",children:[e.jsx("div",{className:"text-xs font-semibold text-[#A3A3A3] uppercase tracking-wider",children:"Latest Gaming News"}),e.jsx("svg",{className:`w-4 h-4 text-[#A3A3A3] transition-transform duration-200 ${G?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx("div",{className:`grid grid-cols-2 gap-2 transition-all duration-300 ease-in-out overflow-hidden ${G?"max-h-96 opacity-100":"max-h-0 opacity-0"}`,children:[{text:"What's the latest gaming news?",shape:"âœ•"},{text:"Which games are releasing soon?",shape:"â– "},{text:"What are the latest game reviews?",shape:"â–²"},{text:"Show me the hottest new game trailers.",shape:"â—¯"}].map(a=>e.jsxs("button",{onClick:()=>{U(!1),F==null||F(a.text)},disabled:n,className:"group relative px-3 py-3 rounded-xl bg-gradient-to-br from-[#1C1C1C] to-[#0F0F0F] hover:from-[#252525] hover:to-[#1A1A1A] border border-[#424242]/30 hover:border-[#E53A3A]/50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-left overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#E53A3A]/10 to-[#FF6B35]/10 opacity-0 group-hover:opacity-100 transition-opacity duration-200"}),e.jsxs("div",{className:"relative flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsx("span",{className:"text-lg flex-shrink-0 text-[#E53A3A] font-bold leading-none",children:a.shape}),e.jsx("span",{className:"text-xs sm:text-sm text-[#E5E5E5] font-medium group-hover:text-white transition-colors leading-tight",children:a.text})]})]},a.text))})]}),e.jsx("div",{className:"flex-shrink-0 bg-background/95 backdrop-blur-sm",children:e.jsx("div",{className:"mx-3 my-3 rounded-2xl p-px transition-all duration-300",style:{background:H?"linear-gradient(135deg, #FF4D4D, #FFAB40)":"transparent"},children:e.jsxs("form",{onSubmit:X,className:"relative p-3 rounded-2xl bg-gradient-to-r from-[#1A1A1A] to-[#0F0F0F] animate-pulse-glow",style:{background:"linear-gradient(135deg, #1A1A1A 0%, #0F0F0F 100%)",boxShadow:"0 0 20px rgba(255, 77, 77, 0.3), 0 0 40px rgba(255, 171, 64, 0.2), 0 0 60px rgba(0, 0, 0, 0.1)"},children:[C&&$.length>0&&e.jsxs("div",{ref:te,className:"absolute bottom-full mb-2 left-3 right-3 bg-[#1C1C1C] border border-[#424242] rounded-lg shadow-lg z-50 max-h-48 overflow-y-auto",children:[e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs text-[#A3A3A3] mb-2 px-2",children:"Select a subtab to update:"}),$.map((a,o)=>{var k;const b=(k=t==null?void 0:t.subtabs)==null?void 0:k.find(B=>B.id===a);return e.jsx("button",{type:"button",onClick:()=>V(a),className:`w-full text-left px-3 py-2 rounded transition-colors ${o===W?"bg-[#E53A3A]/20 border border-[#E53A3A]/60":"hover:bg-[#2A2A2A] border border-transparent"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-[#E53A3A] font-mono text-sm",children:["@",a]}),b&&e.jsxs("span",{className:"text-[#888888] text-xs",children:["- ",b.title]})]})},a)})]}),e.jsx("div",{className:"px-3 py-2 border-t border-[#424242]/30 bg-[#1A1A1A]/50",children:e.jsx("div",{className:"text-xs text-[#888888]",children:"Use â†‘â†“ to navigate, Tab/Enter to select, Esc to cancel"})})]}),e.jsxs("div",{className:"relative mb-2",children:[A&&e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:A,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border border-[#424242]/40"}),e.jsx("button",{type:"button",onClick:ne,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs hover:bg-red-600 transition-colors flex-shrink-0",children:"Ã—"})]}),e.jsxs("div",{className:"text-xs text-[#A3A3A3]",children:[e.jsx("p",{className:"font-semibold",children:"Image Ready"}),e.jsx("p",{children:"Add a message or send"})]})]}),e.jsx("textarea",{ref:_,value:f,onChange:ae,onKeyDown:re,onFocus:()=>h(!0),onBlur:()=>h(!1),placeholder:"Type your message...",className:"w-full px-4 sm:px-6 text-base text-[#F5F5F5] placeholder-[#A3A3A3] resize-none overflow-y-auto focus:outline-none disabled:opacity-60 bg-transparent border-0 rounded-xl",style:{minHeight:"44px",maxHeight:"120px",lineHeight:"44px",height:"44px",paddingTop:"10px",paddingBottom:"10px"},disabled:n,rows:1})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsxs("div",{className:"flex-1 flex items-center space-x-2 sm:space-x-3",children:[e.jsx("input",{type:"file",ref:L,onChange:le,accept:"image/*",className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>{var a;return(a=L.current)==null?void 0:a.click()},className:"w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-gradient-to-r from-[#2E2E2E]/90 to-[#1C1C1C]/90 flex items-center justify-center transition-all duration-300 hover:scale-105 text-text-muted hover:text-text-primary",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),m&&e.jsxs(e.Fragment,{children:[e.jsx(he,{isManualMode:g,onToggle:ie,isConnected:m}),e.jsx(ue,{isConnected:m,isProcessing:n,isManualUploadMode:g,onRequestConnect:u,usage:{tier:p}})]})]}),t&&ce.isGameTab(t)&&l&&(t.isUnreleased?e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-surface/50 rounded-lg border border-surface-light/20",children:[e.jsx("span",{className:"text-sm font-medium text-text-muted",children:"Discuss Mode"}),e.jsx("div",{className:"text-xs text-text-muted/60",children:"(No Playing mode until release)"})]}):y&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(we,{isActive:l.isActive&&l.currentGameId===t.id,onClick:y})})),e.jsx("button",{type:"submit",disabled:!f.trim()&&!x,"aria-label":"Send message",className:`flex items-center justify-center w-12 h-12 sm:w-14 sm:h-14 rounded-xl transition-all duration-300 disabled:cursor-not-allowed ${!f.trim()&&!x||n?"bg-[#2E2E2E]/15 text-[#A3A3A3]/25 scale-100":"bg-gradient-to-r from-[#FFAB40] to-[#FF8C00] text-[#181818] scale-100 hover:scale-105 hover:shadow-lg hover:shadow-[#FFAB40]/25 active:scale-95 font-semibold"}`,children:n?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):e.jsx(be,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]})]})})})]}):e.jsx("div",{className:"h-full bg-background flex flex-col overflow-hidden",children:e.jsx("div",{className:"flex-1 p-6 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-text-muted text-lg",children:"Loading conversation..."})})})}):e.jsx("div",{className:"h-full bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#FF4D4D] mx-auto mb-4"}),e.jsx("p",{className:"text-text-muted",children:"Loading chat..."}),e.jsx("p",{className:"text-text-muted text-sm mt-2",children:"This may take a moment after completing onboarding"})]})})},De=({progress:t,className:c=""})=>{const n=Math.min(Math.max(t,0),100);return e.jsx("div",{className:`relative ${c}`,children:e.jsxs("div",{className:"relative h-2 bg-surface-light/20 rounded-full overflow-hidden",children:[e.jsx("div",{className:"absolute left-0 top-0 h-full bg-gradient-to-r from-primary to-primary-dark transition-all duration-500 ease-out",style:{width:`${n}%`}}),e.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full shadow-lg border-2 border-primary transition-all duration-500 ease-out",style:{left:`${n}%`,transform:"translateX(-50%) translateY(-50%)"},children:e.jsx("div",{className:"absolute inset-0 bg-primary/30 rounded-full animate-ping"})})]})})};export{ke as C,De as G};
//# sourceMappingURL=features-Dp3YUoOI.js.map
