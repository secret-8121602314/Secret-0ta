import{r as y,j as e}from"./react-vendor-BZRXxuJQ.js";import{L as S}from"./gaming-explorer-CFXvhOCT.js";const $=({isOpen:m,position:p,onClose:a,onDelete:c,onPin:o,onUnpin:x,onClearConversation:g,canDelete:k=!0,canPin:N=!0,isPinned:u=!1,isEverythingElse:j=!1})=>{const h=y.useRef(null);return y.useEffect(()=>{const b=v=>{h.current&&!h.current.contains(v.target)&&a()},L=v=>{v.key==="Escape"&&a()};return m&&(document.addEventListener("mousedown",b),document.addEventListener("keydown",L)),()=>{document.removeEventListener("mousedown",b),document.removeEventListener("keydown",L)}},[m,a]),m?e.jsxs("div",{ref:h,className:"fixed z-[100] bg-surface border border-surface-light/20 rounded-lg shadow-xl py-2 min-w-[160px]",style:{left:p.x,top:p.y,transform:p.y<200?"translate(-50%, 10px)":"translate(-50%, -100%)"},children:[N&&!j&&e.jsxs("button",{onClick:()=>{u?x==null||x():o==null||o(),a()},className:"w-full px-4 py-2 text-left text-text-primary hover:bg-surface-light/50 transition-colors duration-200 flex items-center space-x-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),e.jsx("span",{children:u?"Unpin":"Pin to top"})]}),e.jsxs("button",{onClick:()=>{g==null||g(),a()},className:"w-full px-4 py-2 text-left text-orange-400 hover:bg-orange-500/10 transition-colors duration-200 flex items-center space-x-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),e.jsx("span",{children:"Clear conversation"})]}),k&&!j&&e.jsxs("button",{onClick:()=>{c==null||c(),a()},className:"w-full px-4 py-2 text-left text-red-400 hover:bg-red-500/10 transition-colors duration-200 flex items-center space-x-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),e.jsx("span",{children:"Delete"})]})]}):null},_=({isOpen:m,isDesktopOpen:p=!0,onClose:a,onDesktopClose:c,conversations:o,activeConversation:x,onConversationSelect:g,onDeleteConversation:k,onPinConversation:N,onUnpinConversation:u,onClearConversation:j,onAddGame:h,onOpenExplorer:b,userTier:L,isOnTrial:v=!1})=>{var P,B,E,G;const[r,A]=y.useState({isOpen:!1,position:{x:0,y:0},conversationId:null}),M=y.useRef(null),F=y.useRef(null),z=1500,C=Object.values(o).sort((t,s)=>{const n=t.isGameHub||t.id==="game-hub"||t.title==="Game Hub",l=s.isGameHub||s.id==="game-hub"||s.title==="Game Hub";return n&&!l?-1:!n&&l?1:t.isPinned&&!s.isPinned?-1:!t.isPinned&&s.isPinned?1:t.isPinned&&s.isPinned?(t.pinnedAt||0)-(s.pinnedAt||0):t.createdAt-s.createdAt}),T=(t,s)=>{t.preventDefault(),t.stopPropagation();const l=t.currentTarget.getBoundingClientRect(),d=Math.min(l.right+8,window.innerWidth-180),f=Math.min(l.top,window.innerHeight-200);A({isOpen:!0,position:{x:d,y:f},conversationId:s})},H=(t,s)=>{F.current=t.currentTarget,M.current=setTimeout(()=>{if(F.current){const n=F.current.getBoundingClientRect(),l=Math.min(n.right+8,window.innerWidth-180),d=Math.min(n.top,window.innerHeight-200);A({isOpen:!0,position:{x:l,y:d},conversationId:s})}},z)},I=()=>{M.current&&(clearTimeout(M.current),M.current=null),F.current=null},w=()=>{A({isOpen:!1,position:{x:0,y:0},conversationId:null})},W=()=>{r.conversationId&&(k(r.conversationId),w())},D=()=>{r.conversationId&&N&&(N(r.conversationId),w())},R=()=>{r.conversationId&&u&&(u(r.conversationId),w())},U=()=>{r.conversationId&&j&&(j(r.conversationId),w())};return e.jsxs(e.Fragment,{children:[m&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md z-[55] lg:hidden",onClick:a}),e.jsx("div",{className:`fixed inset-y-0 left-0 z-[60] w-72 sm:w-80 bg-gradient-to-b from-surface to-background border-r border-surface-light/20 transform transition-transform duration-300 ease-in-out ${m?"translate-x-0":"-translate-x-full"} ${p?"lg:translate-x-0":"lg:-translate-x-full"}`,style:{zIndex:60},children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"px-3 py-3 sm:px-4 sm:py-4 lg:px-6 lg:py-6 border-b border-surface-light/20 flex-shrink-0 relative",style:{zIndex:10},children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[b?e.jsxs("button",{onClick:b,className:"group flex-1 flex items-center gap-3 px-4 py-2.5 sm:px-5 sm:py-3 bg-gradient-to-r from-[#1A1A1A] to-[#141414] hover:from-[#E53A3A]/10 hover:to-[#D98C1F]/10 rounded-xl transition-all duration-300 border border-[#424242]/40 hover:border-[#E53A3A]/60 hover:shadow-[0_0_20px_rgba(229,58,58,0.15)]",children:[e.jsx(S,{size:"sm",userTier:L,isOnTrial:v,className:"flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-base sm:text-lg font-bold bg-gradient-to-r from-[#F5F5F5] to-[#CFCFCF] group-hover:from-[#FF6B6B] group-hover:to-[#FFAB40] bg-clip-text text-transparent transition-all duration-300",children:"HQ"}),e.jsx("span",{className:"text-[10px] sm:text-xs text-neutral-500 group-hover:text-neutral-400 transition-colors",children:"Command Center"})]})]}):e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-text-primary flex-1",children:"Conversations"}),e.jsx("button",{onClick:()=>{window.innerWidth<1024?a():c==null||c()},className:"btn-icon p-2.5 sm:p-3 text-text-muted hover:text-text-primary active:scale-95 min-h-[44px] min-w-[44px] flex items-center justify-center flex-shrink-0",title:"Close sidebar",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),h&&e.jsx("div",{className:"px-3 sm:px-4 lg:px-6 pt-4 pb-0",children:e.jsxs("button",{onClick:h,className:"w-full px-4 py-3 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] md:hover:from-[#D42A2A] md:hover:to-[#C87A1A] text-white font-medium rounded-lg transition-all shadow-lg md:hover:shadow-xl active:scale-95 flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Add Game"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-3 sm:px-4 lg:px-6 pt-4 pb-3 sm:pb-4 lg:pb-6",style:{minHeight:0,maxHeight:"100%"},children:e.jsxs("div",{className:"space-y-4",children:[C.map(t=>{const s=t.isGameHub||t.id==="game-hub"||t.title==="Game Hub",n=t.isUnreleased||!1,l=!s&&!n&&t.gameTitle;(l||n)&&!t.coverUrl&&console.log("ðŸ–¼ï¸ [Sidebar] Missing coverUrl for:",t.title,"gameTitle:",t.gameTitle,"isUnreleased:",n);let d="",f="text-text-primary";return s?(d="border-l-2 border-gradient-to-b from-[#FF4D4D] to-[#FFAB40]",f="bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] bg-clip-text text-transparent"):n?(d="border-l-2 border-yellow-500",f="text-yellow-400"):l&&(d="border-l-2 border-orange-500",f="text-orange-400"),e.jsx("div",{className:`conversation-tab cursor-pointer transition-all duration-300 relative ${(x==null?void 0:x.id)===t.id?"conversation-tab-active":""} ${d}`,onClick:()=>g(t.id),onContextMenu:i=>T(i,t.id),onMouseDown:i=>H(i,t.id),onMouseUp:I,onMouseLeave:I,onTouchStart:i=>H(i,t.id),onTouchEnd:I,style:{zIndex:1},children:e.jsxs("div",{className:"flex p-3",children:[(l||n)&&t.coverUrl&&e.jsx("div",{className:"flex-shrink-0 mr-3",children:e.jsx("img",{src:t.coverUrl,alt:t.title,className:"w-14 h-[80px] object-cover rounded shadow-md",loading:"lazy",onError:i=>{i.target.style.display="none"}})}),e.jsxs("div",{className:`flex-1 min-w-0 flex flex-col ${(l||n)&&t.coverUrl?"justify-center":""}`,children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium truncate flex-1 min-w-0 ${f}`,children:t.title}),t.isPinned&&e.jsx("svg",{className:"w-3 h-3 text-primary-dark flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})})]}),n&&e.jsx("span",{className:"self-start px-1.5 py-0.5 bg-yellow-500/20 border border-yellow-500/40 rounded text-[10px] text-yellow-400 font-medium",children:"UPCOMING"})]}),l&&t.gameProgress!==void 0&&t.gameProgress>0&&e.jsxs("div",{className:"mt-1.5 flex items-center gap-1.5",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-surface-light/30 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#D98C1F] to-[#FFB366] rounded-full transition-all duration-300",style:{width:`${Math.min(100,t.gameProgress)}%`}})}),e.jsxs("span",{className:"text-[10px] text-[#D98C1F] font-medium min-w-[28px] text-right",children:[t.gameProgress,"%"]})]}),e.jsxs("p",{className:"text-xs text-text-muted mt-1.5",children:[t.messages.filter(i=>i.role==="assistant").length," messages"]}),e.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:new Date(t.updatedAt).toLocaleDateString()})]}),!s&&e.jsx("button",{onClick:i=>{i.stopPropagation(),k(t.id)},className:"flex-shrink-0 opacity-0 group-hover:opacity-100 p-2 text-text-muted hover:text-red-400 transition-all duration-200 rounded-lg hover:bg-red-500/10 active:scale-95 ml-2",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},t.id)}),C.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary/20 to-secondary/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),e.jsx("p",{className:"text-text-muted text-lg",children:"No conversations yet"}),e.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Create your first conversation to get started"})]})]})})]})}),e.jsx($,{isOpen:r.isOpen,position:r.position,onClose:w,onDelete:W,onPin:D,onUnpin:R,onClearConversation:U,canDelete:r.conversationId?!((P=o[r.conversationId])!=null&&P.isGameHub):!0,canPin:r.conversationId?!((B=o[r.conversationId])!=null&&B.isGameHub):!0,isPinned:r.conversationId?(E=o[r.conversationId])==null?void 0:E.isPinned:!1,isEverythingElse:r.conversationId?((G=o[r.conversationId])==null?void 0:G.isGameHub)===!0:!1})]})};export{_ as S};
