{"version":3,"file":"features-Dfvi-1An.js","sources":["../../src/utils/publicPath.ts","../../src/components/ui/ManualUploadToggle.tsx","../../src/components/ui/ScreenshotButton.tsx","../../src/components/ui/DownloadIcon.tsx","../../src/components/ui/UserAvatar.tsx","../../src/components/ui/AIAvatar.tsx","../../src/components/ui/TypingIndicator.tsx","../../src/components/ui/SendIcon.tsx","../../src/components/ErrorBoundary.tsx","../../src/components/ui/TTSControls.tsx","../../src/components/features/SuggestedPrompts.tsx","../../src/components/ui/ActiveSessionToggle.tsx","../../src/components/features/SubTabs.tsx","../../src/components/features/ChatInterface.tsx","../../src/components/features/GameProgressBar.tsx"],"sourcesContent":["/**\r\n * Get the correct public asset path considering Vite's base URL\r\n * Use this for assets in the public folder\r\n */\r\nexport function getPublicPath(path: string): string {\r\n  // In development, Vite serves public assets from root\r\n  // In production, they're served from the base path\r\n  const isDev = (import.meta as any).env.DEV;\r\n  \r\n  // Remove leading slash if present\r\n  const cleanPath = path.startsWith('/') ? path.slice(1) : path;\r\n  \r\n  // In development, just return the path with leading slash\r\n  if (isDev) {\r\n    return `/${cleanPath}`;\r\n  }\r\n  \r\n  // In production, combine with base URL from Vite config\r\n  const base = (import.meta as any).env.BASE_URL || '/';\r\n  const normalizedBase = base.endsWith('/') ? base : `${base}/`;\r\n  \r\n  return `${normalizedBase}${cleanPath}`;\r\n}\r\n","import React from 'react';\r\n\r\ninterface ManualUploadToggleProps {\r\n  isManualMode: boolean;\r\n  onToggle: () => void;\r\n  isConnected?: boolean;\r\n}\r\n\r\nconst ManualUploadToggle: React.FC<ManualUploadToggleProps> = ({ isManualMode, onToggle, isConnected = false }) => {\r\n  const title = isManualMode\r\n    ? 'Manual review is ON (paused). Click to resume auto-sending screenshots.'\r\n    : 'Auto-sending is ON. Click to pause and review screenshots manually.';\r\n\r\n  // Only show when connected to PC\r\n  if (!isConnected) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      onClick={onToggle}\r\n      className={`w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-gradient-to-r from-[#2E2E2E]/90 to-[#1C1C1C]/90 flex items-center justify-center transition-all duration-300 hover:scale-105 ${\r\n        isManualMode ? 'text-yellow-400' : 'text-emerald-400'\r\n      }`}\r\n      aria-pressed={isManualMode}\r\n      aria-label={isManualMode ? 'Resume auto-sending screenshots' : 'Pause and review screenshots'}\r\n      title={title}\r\n    >\r\n      {isManualMode ? (\r\n        // Pause icon - Manual mode ON (paused/reviewing)\r\n        <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path d=\"M6 4h4v16H6V4zm8 0h4v16h-4V4z\"/>\r\n        </svg>\r\n      ) : (\r\n        // Play icon - Auto mode ON (playing/sending)\r\n        <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path d=\"M8 5v14l11-7z\"/>\r\n        </svg>\r\n      )}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default React.memo(ManualUploadToggle);","import React, { useEffect, useRef, useState } from 'react';\r\nimport { UserTier } from '../../types';\r\nimport { send } from '../../services/websocketService';\r\n\r\ninterface ScreenshotButtonProps {\r\n  isConnected: boolean;\r\n  isProcessing: boolean;\r\n  isManualUploadMode: boolean;\r\n  onRequestConnect?: () => void;\r\n  usage?: { tier: UserTier };\r\n}\r\n\r\ntype Mode = 'single' | 'multi';\r\n\r\nconst ScreenshotButton: React.FC<ScreenshotButtonProps> = ({ \r\n  isConnected, \r\n  isProcessing, \r\n  isManualUploadMode, \r\n  onRequestConnect,\r\n  usage \r\n}) => {\r\n  const [mode, setMode] = useState<Mode>('single');\r\n  const [menuOpen, setMenuOpen] = useState(false);\r\n  const rootRef = useRef<HTMLDivElement>(null);\r\n  const btnRef = useRef<HTMLButtonElement>(null);\r\n  const longPressRef = useRef<number | null>(null);\r\n  const [showHint, setShowHint] = useState(false);\r\n\r\n  // Check if user can access multishot\r\n  const canUseMultishot = usage?.tier === 'pro' || usage?.tier === 'vanguard_pro';\r\n  const isFreeUser = usage?.tier === 'free';\r\n\r\n  // Persist mode - ensure free users can't have multishot saved\r\n  useEffect(() => {\r\n    const saved = localStorage.getItem('otakon_screenshot_mode');\r\n    if (saved === 'single' || (saved === 'multi' && canUseMultishot)) {\r\n      setMode(saved);\r\n    } else if (saved === 'multi' && !canUseMultishot) {\r\n      // Reset to single if free user had multishot saved\r\n      setMode('single');\r\n      localStorage.setItem('otakon_screenshot_mode', 'single');\r\n    }\r\n    // Don't show hint by default - only show on first interaction\r\n    setShowHint(false);\r\n  }, [canUseMultishot]);\r\n\r\n  const setModeAndPersist = (m: Mode) => {\r\n    // Prevent free users from setting multishot mode\r\n    if (m === 'multi' && !canUseMultishot) {\r\n      return;\r\n    }\r\n    setMode(m);\r\n    localStorage.setItem('otakon_screenshot_mode', m);\r\n    setMenuOpen(false);\r\n  };\r\n\r\n  // Close on outside click\r\n  useEffect(() => {\r\n    const handler = (e: MouseEvent) => {\r\n      if (!rootRef.current) {\r\n        return;\r\n      }\r\n      if (!rootRef.current.contains(e.target as Node)) {\r\n        setMenuOpen(false);\r\n      }\r\n    };\r\n    if (menuOpen) {\r\n      document.addEventListener('mousedown', handler, { passive: true } as any);\r\n    }\r\n    return () => document.removeEventListener('mousedown', handler as any);\r\n  }, [menuOpen]);\r\n\r\n  const openMenu = (e?: { preventDefault?: () => void; stopPropagation?: () => void }) => {\r\n    e?.preventDefault?.();\r\n    e?.stopPropagation?.();\r\n    setMenuOpen(true);\r\n  };\r\n\r\n\r\n  const handleContextMenu = (e: React.MouseEvent) => {\r\n    // Explicitly handle right-click\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    if (!isConnected) {\r\n      onRequestConnect?.();\r\n      return;\r\n    }\r\n    openMenu();\r\n  };\r\n\r\n  const handleMouseDown = (e: React.MouseEvent) => {\r\n    // Right-button fallback\r\n    if (e.button === 2) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      if (!isConnected) {\r\n        onRequestConnect?.();\r\n        return;\r\n      }\r\n      openMenu();\r\n    }\r\n  };\r\n\r\n  const handleTouchStart = () => {\r\n    // Long-press 1.75s\r\n    if (longPressRef.current) {\r\n      window.clearTimeout(longPressRef.current);\r\n    }\r\n    longPressRef.current = window.setTimeout(() => {\r\n      if (!isConnected) {\r\n        onRequestConnect?.();\r\n        return;\r\n      }\r\n      openMenu();\r\n    }, 1750);\r\n  };\r\n\r\n  const clearLongPress = () => {\r\n    if (longPressRef.current) {\r\n      window.clearTimeout(longPressRef.current);\r\n      longPressRef.current = null;\r\n    }\r\n  };\r\n\r\n  const handleClick = async () => {\r\n    if (!isConnected) { onRequestConnect?.(); return; }\r\n    if (isProcessing) {\r\n      return;\r\n    }\r\n    \r\n    // Prevent multishot for free users\r\n    if (mode === 'multi' && !canUseMultishot) {\r\n      return;\r\n    }\r\n    \r\n    const processImmediate = isManualUploadMode ? false : mode === 'single';\r\n    const msg: any = {\r\n      type: 'screenshot_request',\r\n      mode,\r\n      processImmediate,\r\n    };\r\n    if (mode === 'multi') {\r\n      msg.count = 5;\r\n    }\r\n    \r\n    // Send screenshot request via websocket\r\n    if (typeof send === 'function') {\r\n      send(msg);\r\n      console.log('üì∏ Screenshot request sent:', msg);\r\n    } else {\r\n      console.warn('WebSocket send function not available');\r\n    }\r\n  };\r\n\r\n  const handleMultishotClick = () => {\r\n    if (!canUseMultishot) {\r\n      // Show upgrade prompt for free users\r\n      setMenuOpen(false);\r\n      // You can add an upgrade modal trigger here if needed\r\n      return;\r\n    }\r\n    setModeAndPersist('multi');\r\n  };\r\n\r\n  return (\r\n    <div ref={rootRef} className=\"relative\">\r\n      <button\r\n        ref={btnRef}\r\n        type=\"button\"\r\n        onClick={handleClick}\r\n        onContextMenu={handleContextMenu}\r\n        onMouseDown={handleMouseDown}\r\n        onTouchStart={handleTouchStart}\r\n        onTouchEnd={clearLongPress}\r\n        onTouchCancel={clearLongPress}\r\n        aria-disabled={!isConnected || isProcessing}\r\n        className={`${isConnected ? 'text-emerald-400' : 'text-[#8A8A8A]'} w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-gradient-to-r from-[#2E2E2E]/90 to-[#1C1C1C]/90 flex items-center justify-center transition-all duration-300 ${isConnected ? 'hover:scale-105' : 'opacity-70 cursor-pointer hover:opacity-90'} ${isProcessing ? 'animate-pulse' : ''}`}\r\n        title={isConnected ? 'Screenshot (right-click/long-press to change mode)' : 'Connect your PC to enable screenshots'}\r\n      >\r\n        {mode === 'single' ? (\r\n          // Monitor with capture corner (single)\r\n          <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\r\n            <rect x=\"3\" y=\"4\" width=\"18\" height=\"12\" rx=\"2\" />\r\n            <path d=\"M8 20h8\" />\r\n            <path d=\"M7 7h3M7 10h3M14 7h3\" />\r\n            <path d=\"M4 3v4M4 3h4\" />\r\n          </svg>\r\n        ) : (\r\n          // Stacked monitors (multi)\r\n          <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\r\n            <rect x=\"4\" y=\"5\" width=\"14\" height=\"9\" rx=\"2\" />\r\n            <rect x=\"6\" y=\"10\" width=\"14\" height=\"9\" rx=\"2\" />\r\n            <path d=\"M10 22h6\" />\r\n          </svg>\r\n        )}\r\n      </button>\r\n\r\n      {showHint && isConnected && (\r\n        <div className=\"absolute left-1/2 -translate-x-1/2 mt-3 top-full text-xs text-[#CFCFCF] bg-[#101010]/95 border border-[#424242]/60 rounded-lg px-3 py-2 shadow-lg whitespace-nowrap z-50\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => { setShowHint(false); localStorage.setItem('otakon_screenshot_hint_seen', '1'); }}\r\n            className=\"w-full h-full\"\r\n          >\r\n            Press & hold (1.75s) or right-click to change mode\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {menuOpen && isConnected && (\r\n        <div className=\"absolute bottom-full right-0 mb-3 bg-[#101010]/98 border border-[#424242]/60 rounded-xl shadow-2xl min-w-[200px] overflow-hidden z-[9999] backdrop-blur-md\">\r\n          <button \r\n            onClick={() => setModeAndPersist('single')} \r\n            className={`w-full text-left px-4 py-3 hover:bg-[#2E2E2E]/60 transition-colors ${mode === 'single' ? 'text-emerald-400' : 'text-[#CFCFCF]'}`}\r\n          >\r\n            üì∏ Single Shot {mode === 'single' ? '‚úì' : ''}\r\n          </button>\r\n          \r\n          <button \r\n            onClick={handleMultishotClick} \r\n            className={`w-full text-left px-4 py-3 transition-all duration-200 ${\r\n              canUseMultishot \r\n                ? `hover:bg-[#2E2E2E]/60 ${mode === 'multi' ? 'text-emerald-400' : 'text-[#CFCFCF]'}` \r\n                : 'text-[#666666] cursor-not-allowed opacity-60'\r\n            }`}\r\n            disabled={!canUseMultishot}\r\n          >\r\n            {canUseMultishot ? (\r\n              <>üì∏ Multi Shot (5) {mode === 'multi' ? '‚úì' : ''}</>\r\n            ) : (\r\n              <div className=\"flex items-center justify-between\">\r\n                <span>üîí Multi Shot (5)</span>\r\n                <span className=\"text-xs bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] text-white px-2 py-1 rounded-full\">\r\n                  PRO\r\n                </span>\r\n              </div>\r\n            )}\r\n          </button>\r\n          \r\n          {isFreeUser && (\r\n            <div className=\"px-4 py-2 text-xs text-[#999999] border-t border-[#424242]/40\">\r\n              Upgrade to Pro for batch screenshots\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ScreenshotButton;\r\n\r\n","import React from 'react';\r\n\r\ninterface DownloadIconProps {\r\n  className?: string;\r\n}\r\n\r\nconst DownloadIcon: React.FC<DownloadIconProps> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    aria-hidden=\"true\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nexport default DownloadIcon;\r\n","import React from 'react';\r\n\r\ninterface UserAvatarProps {\r\n  className?: string;\r\n}\r\n\r\nconst UserAvatar: React.FC<UserAvatarProps> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    viewBox=\"0 0 24 24\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    aria-label=\"User Avatar\"\r\n  >\r\n    <defs>\r\n      <linearGradient id=\"avatar-gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n        <stop offset=\"0%\" stopColor=\"#FF4D4D\" />\r\n        <stop offset=\"100%\" stopColor=\"#FFAB40\" />\r\n      </linearGradient>\r\n    </defs>\r\n    <circle cx=\"12\" cy=\"12\" r=\"12\" fill=\"url(#avatar-gradient)\" />\r\n  </svg>\r\n);\r\n\r\nexport default UserAvatar;\r\n","import React from 'react';\r\nimport { getPublicPath } from '../../utils/publicPath';\r\n\r\ninterface AIAvatarProps {\r\n  className?: string;\r\n}\r\n\r\nconst AIAvatar: React.FC<AIAvatarProps> = ({ className }) => (\r\n  <img\r\n    src={getPublicPath('/images/AvatarAI.png')}\r\n    alt=\"AI Avatar\"\r\n    className={`${className} rounded-full object-cover`}\r\n    aria-label=\"AI Avatar\"\r\n  />\r\n);\r\n\r\nexport default AIAvatar;\r\n","import React from 'react';\r\n\r\ninterface TypingIndicatorProps {\r\n  variant?: 'dots' | 'skeleton' | 'wave' | 'circular';\r\n  showText?: boolean;\r\n  className?: string;\r\n}\r\n\r\nconst TypingIndicator: React.FC<TypingIndicatorProps> = ({ \r\n  variant = 'dots', \r\n  showText = true, \r\n  className = '' \r\n}) => {\r\n  // Dots animation (default)\r\n  if (variant === 'dots') {\r\n    return (\r\n      <div className={`flex items-center gap-2 py-2 px-3 ${className}`}>\r\n        <div className=\"flex items-center space-x-1\">\r\n          <div className=\"w-2 h-2 bg-[#FF4D4D] rounded-full animate-bounce\" style={{ animationDelay: '0ms' }}></div>\r\n          <div className=\"w-2 h-2 bg-[#FFAB40] rounded-full animate-bounce\" style={{ animationDelay: '150ms' }}></div>\r\n          <div className=\"w-2 h-2 bg-[#5CBB7B] rounded-full animate-bounce\" style={{ animationDelay: '300ms' }}></div>\r\n        </div>\r\n        {showText && <span className=\"text-sm text-[#A3A3A3] font-medium\">AI is thinking...</span>}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Skeleton animation\r\n  if (variant === 'skeleton') {\r\n    return (\r\n      <div className={`flex flex-col gap-3 py-3 px-4 ${className}`}>\r\n        <div className=\"flex items-center gap-2\">\r\n          <div className=\"w-8 h-8 bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] rounded-full animate-pulse\"></div>\r\n          <div className=\"flex-1 space-y-2\">\r\n            <div className=\"h-3 bg-gradient-to-r from-[#FF4D4D]/20 to-[#FFAB40]/20 rounded animate-pulse\" style={{ width: '60%' }}></div>\r\n            <div className=\"h-3 bg-gradient-to-r from-[#FFAB40]/20 to-[#5CBB7B]/20 rounded animate-pulse\" style={{ width: '80%' }}></div>\r\n          </div>\r\n        </div>\r\n        <div className=\"space-y-2\">\r\n          <div className=\"h-4 bg-gradient-to-r from-[#5CBB7B]/20 to-[#FF4D4D]/20 rounded animate-pulse\"></div>\r\n          <div className=\"h-4 bg-gradient-to-r from-[#FF4D4D]/20 to-[#FFAB40]/20 rounded animate-pulse\" style={{ width: '70%' }}></div>\r\n          <div className=\"h-4 bg-gradient-to-r from-[#FFAB40]/20 to-[#5CBB7B]/20 rounded animate-pulse\" style={{ width: '90%' }}></div>\r\n        </div>\r\n        {showText && <span className=\"text-sm text-[#A3A3A3] font-medium\">AI is thinking...</span>}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Wave animation\r\n  if (variant === 'wave') {\r\n    return (\r\n      <div className={`flex items-center gap-3 py-3 px-4 ${className}`}>\r\n        <div className=\"flex items-center space-x-1\">\r\n          <div className=\"w-1 h-4 bg-[#FF4D4D] rounded-full animate-pulse\" style={{ animationDelay: '0ms' }}></div>\r\n          <div className=\"w-1 h-4 bg-[#FFAB40] rounded-full animate-pulse\" style={{ animationDelay: '150ms' }}></div>\r\n          <div className=\"w-1 h-4 bg-[#5CBB7B] rounded-full animate-pulse\" style={{ animationDelay: '300ms' }}></div>\r\n          <div className=\"w-1 h-4 bg-[#FF4D4D] rounded-full animate-pulse\" style={{ animationDelay: '450ms' }}></div>\r\n        </div>\r\n        {showText && <span className=\"text-sm text-[#A3A3A3] font-medium\">AI is thinking...</span>}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Circular progress\r\n  if (variant === 'circular') {\r\n    return (\r\n      <div className={`flex items-center gap-3 py-3 px-4 ${className}`}>\r\n        <div className=\"relative w-8 h-8\">\r\n          {/* Outer ring */}\r\n          <div className=\"absolute inset-0 w-8 h-8 border-2 border-[#424242]/30 rounded-full\"></div>\r\n          {/* Animated ring */}\r\n          <div className=\"absolute inset-0 w-8 h-8 border-2 border-transparent border-t-[#E53A3A] border-r-[#D98C1F] border-b-transparent rounded-full animate-spin\"></div>\r\n          {/* Center dot */}\r\n          <div className=\"absolute inset-0 flex items-center justify-center\">\r\n            <div className=\"w-2 h-2 bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] rounded-full animate-pulse\"></div>\r\n          </div>\r\n        </div>\r\n        {showText && <span className=\"text-sm text-[#A3A3A3] font-medium\">AI is thinking...</span>}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport default TypingIndicator;\r\n","import React from 'react';\r\n\r\ninterface SendIconProps {\r\n  className?: string;\r\n}\r\n\r\nconst SendIcon: React.FC<SendIconProps> = ({ className }) => (\r\n  <svg\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"currentColor\"\r\n    className={className}\r\n    aria-hidden=\"true\"\r\n  >\r\n    <path d=\"M12 4L4 12h5v8h6v-8h5L12 4z\" />\r\n  </svg>\r\n);\r\n\r\nexport default SendIcon;\r\n","import { Component, ErrorInfo, ReactNode } from 'react';\r\n\r\ninterface Props {\r\n  children: ReactNode;\r\n  fallback?: ReactNode;\r\n}\r\n\r\ninterface State {\r\n  hasError: boolean;\r\n  error: Error | null;\r\n  errorInfo: ErrorInfo | null;\r\n}\r\n\r\nclass ErrorBoundary extends Component<Props, State> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      hasError: false,\r\n      error: null,\r\n      errorInfo: null,\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error): State {\r\n    // Update state so the next render will show the fallback UI\r\n    return {\r\n      hasError: true,\r\n      error,\r\n      errorInfo: null,\r\n    };\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\r\n    // Log error details\r\n    console.error('üö® [ErrorBoundary] Caught error:', error);\r\n    console.error('üö® [ErrorBoundary] Error info:', errorInfo);\r\n    \r\n    // Update state with error info\r\n    this.setState({\r\n      error,\r\n      errorInfo,\r\n    });\r\n    \r\n    // You can also log to an error reporting service here\r\n    // Example: errorReportingService.logError(error, errorInfo);\r\n  }\r\n\r\n  handleReset = () => {\r\n    this.setState({\r\n      hasError: false,\r\n      error: null,\r\n      errorInfo: null,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      // Custom fallback UI\r\n      if (this.props.fallback) {\r\n        return this.props.fallback;\r\n      }\r\n\r\n      // Default fallback UI\r\n      return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-[#111111] to-[#0A0A0A] flex items-center justify-center p-4\">\r\n          <div className=\"max-w-md w-full bg-[#1C1C1C] border border-[#424242] rounded-xl p-6 text-center\">\r\n            <div className=\"text-6xl mb-4\">‚ö†Ô∏è</div>\r\n            <h1 className=\"text-2xl font-bold text-[#F5F5F5] mb-2\">Something Went Wrong</h1>\r\n            <p className=\"text-[#CFCFCF] mb-4\">\r\n              We encountered an unexpected error. Don't worry, your data is safe.\r\n            </p>\r\n            \r\n            {this.state.error && (\r\n              <div className=\"bg-[#2E2E2E] rounded-lg p-4 mb-4 text-left\">\r\n                <p className=\"text-xs font-mono text-[#FF4D4D] mb-2\">\r\n                  {this.state.error.toString()}\r\n                </p>\r\n                {this.state.errorInfo && (\r\n                  <details className=\"text-xs text-[#A3A3A3]\">\r\n                    <summary className=\"cursor-pointer hover:text-[#CFCFCF] transition-colors\">\r\n                      Error Details\r\n                    </summary>\r\n                    <pre className=\"mt-2 overflow-auto max-h-40\">\r\n                      {this.state.errorInfo.componentStack}\r\n                    </pre>\r\n                  </details>\r\n                )}\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"flex gap-3\">\r\n              <button\r\n                onClick={this.handleReset}\r\n                className=\"flex-1 px-4 py-2 bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] text-white rounded-lg font-semibold hover:scale-105 transition-transform\"\r\n              >\r\n                Try Again\r\n              </button>\r\n              <button\r\n                onClick={() => window.location.reload()}\r\n                className=\"flex-1 px-4 py-2 bg-[#2E2E2E] text-[#CFCFCF] rounded-lg font-semibold hover:bg-[#424242] transition-colors\"\r\n              >\r\n                Reload Page\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport default ErrorBoundary;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { ttsService } from '../../services/ttsService';\r\n\r\nconst TTSControls: React.FC = () => {\r\n  const [isSpeaking, setIsSpeaking] = useState(false);\r\n  const [isPaused, setIsPaused] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const handleTTSStarted = () => setIsSpeaking(true);\r\n    const handleTTSStopped = () => {\r\n      setIsSpeaking(false);\r\n      setIsPaused(false);\r\n    };\r\n    const handleTTSPaused = () => setIsPaused(true);\r\n    const handleTTSResumed = () => setIsPaused(false);\r\n\r\n    window.addEventListener('otakon:ttsStarted', handleTTSStarted);\r\n    window.addEventListener('otakon:ttsStopped', handleTTSStopped);\r\n    window.addEventListener('otakon:ttsPaused', handleTTSPaused);\r\n    window.addEventListener('otakon:ttsResumed', handleTTSResumed);\r\n\r\n    return () => {\r\n      window.removeEventListener('otakon:ttsStarted', handleTTSStarted);\r\n      window.removeEventListener('otakon:ttsStopped', handleTTSStopped);\r\n      window.removeEventListener('otakon:ttsPaused', handleTTSPaused);\r\n      window.removeEventListener('otakon:ttsResumed', handleTTSResumed);\r\n    };\r\n  }, []);\r\n\r\n  const handlePauseResume = () => {\r\n    if (isPaused) {\r\n      ttsService.resume();\r\n    } else {\r\n      ttsService.pause();\r\n    }\r\n  };\r\n\r\n  const handleRestart = async () => {\r\n    await ttsService.restart();\r\n  };\r\n\r\n  if (!isSpeaking) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-2 mt-3 pt-3 border-t border-[#424242]/30\">\r\n      <button\r\n        onClick={handlePauseResume}\r\n        className=\"flex items-center justify-center gap-1.5 px-3 py-1.5 bg-[#2E2E2E] hover:bg-[#3E3E3E] border border-[#424242] text-[#FFAB40] text-xs font-medium rounded-lg transition-all duration-200\"\r\n        title={isPaused ? 'Resume' : 'Pause'}\r\n      >\r\n        {isPaused ? (\r\n          <>\r\n            <svg className=\"w-3.5 h-3.5\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path d=\"M8 5v14l11-7z\" />\r\n            </svg>\r\n            <span>Resume</span>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <svg className=\"w-3.5 h-3.5\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path d=\"M6 4h4v16H6V4zm8 0h4v16h-4V4z\" />\r\n            </svg>\r\n            <span>Pause</span>\r\n          </>\r\n        )}\r\n      </button>\r\n\r\n      <button\r\n        onClick={handleRestart}\r\n        className=\"flex items-center justify-center gap-1.5 px-3 py-1.5 bg-[#2E2E2E] hover:bg-[#3E3E3E] border border-[#424242] text-[#FFAB40] text-xs font-medium rounded-lg transition-all duration-200\"\r\n        title=\"Restart from beginning\"\r\n      >\r\n        <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"2\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\r\n        </svg>\r\n        <span>Restart</span>\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TTSControls;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { suggestedPromptsService } from '../../services/suggestedPromptsService';\r\nimport { newsPrompts } from '../../types';\r\n\r\ninterface SuggestedPromptsProps {\r\n  prompts: string[];\r\n  onPromptClick: (prompt: string) => void;\r\n  isLoading: boolean;\r\n  conversationId?: string; // To detect \"Game Hub\" tab\r\n}\r\n\r\nconst SuggestedPrompts: React.FC<SuggestedPromptsProps> = ({ \r\n  prompts, \r\n  onPromptClick, \r\n  isLoading,\r\n  conversationId = ''\r\n}) => {\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  const [accordionOpen, setAccordionOpen] = useState(true);\r\n  const [usedPrompts, setUsedPrompts] = useState<Set<string>>(new Set());\r\n\r\n  const isGameHub = conversationId === 'game-hub' || conversationId === 'everything-else';\r\n  \r\n  // For Game Hub tab:\r\n  // - If prompts match newsPrompts (initial state), show newsPrompts with usage tracking\r\n  // - If prompts are different (AI-generated), show those instead (contextual suggestions after AI response)\r\n  const isShowingNewsPrompts = isGameHub && \r\n    (prompts.length === newsPrompts.length && prompts.every((p, i) => p === newsPrompts[i]));\r\n  \r\n  const displayPrompts = isShowingNewsPrompts ? newsPrompts : prompts;\r\n\r\n  // Check screen size for mobile accordion\r\n  useEffect(() => {\r\n    const mq = window.matchMedia('(max-width: 640px)');\r\n    const apply = () => {\r\n      setIsMobile(mq.matches);\r\n      // Always open on mobile for better UX - users can see suggestions immediately\r\n      setAccordionOpen(true);\r\n    };\r\n    apply();\r\n    mq.addEventListener('change', apply);\r\n    return () => mq.removeEventListener('change', apply);\r\n  }, []);\r\n\r\n  // Load used prompts status (only for news prompts)\r\n  useEffect(() => {\r\n    if (isShowingNewsPrompts) {\r\n      const used = new Set(newsPrompts.filter(p => suggestedPromptsService.isPromptUsed(p)));\r\n      setUsedPrompts(used);\r\n    }\r\n  }, [isShowingNewsPrompts, displayPrompts]);\r\n\r\n  // Handle prompt click\r\n  const handlePromptClick = (prompt: string) => {\r\n    if (isShowingNewsPrompts) {\r\n      // Mark as used for news prompts\r\n      suggestedPromptsService.markPromptAsUsed(prompt);\r\n      setUsedPrompts(prev => new Set([...prev, prompt]));\r\n    }\r\n    onPromptClick(prompt);\r\n  };\r\n\r\n  // Don't show if loading or no prompts\r\n  if (isLoading || displayPrompts.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  // Hide if all news prompts are used (only for news prompts view)\r\n  if (isShowingNewsPrompts && suggestedPromptsService.areAllPromptsUsed(newsPrompts)) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"pt-3 animate-fade-in\">\r\n      {/* Mobile accordion header - only for news prompts */}\r\n      {isMobile && isShowingNewsPrompts && (\r\n        <button\r\n          type=\"button\"\r\n          aria-expanded={accordionOpen}\r\n          onClick={() => setAccordionOpen(v => !v)}\r\n          className=\"w-full flex items-center justify-between px-3 py-2 rounded-lg border border-[#424242]/40 bg-[#1C1C1C]/60 text-[#E5E5E5] text-sm font-medium mb-2\"\r\n        >\r\n          <span>Gaming News Suggestions</span>\r\n          <svg \r\n            className={`w-4 h-4 transition-transform ${accordionOpen ? 'rotate-180' : ''}`} \r\n            viewBox=\"0 0 20 20\" \r\n            fill=\"currentColor\"\r\n          >\r\n            <path \r\n              fillRule=\"evenodd\" \r\n              d=\"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.25 8.29a.75.75 0 01-.02-1.08z\" \r\n              clipRule=\"evenodd\"\r\n            />\r\n          </svg>\r\n        </button>\r\n      )}\r\n\r\n      {/* Prompts grid - show if not mobile or accordion is open */}\r\n      {(!isMobile || accordionOpen) && (\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3\">\r\n          {displayPrompts.map((prompt, index) => {\r\n            const isUsed = isShowingNewsPrompts && usedPrompts.has(prompt);\r\n            \r\n            return (\r\n              <button\r\n                key={index}\r\n                onClick={() => !isUsed && handlePromptClick(prompt)}\r\n                disabled={isUsed}\r\n                className={`text-left p-3 sm:p-4 border rounded-lg sm:rounded-xl transition-all duration-200 backdrop-blur-sm ${\r\n                  isUsed \r\n                    ? 'bg-[#2A2A2A]/60 border-[#555555]/30 text-[#888888] cursor-not-allowed opacity-70' \r\n                    : 'bg-[#1C1C1C]/60 border-[#424242]/40 text-[#CFCFCF] hover:bg-[#E53A3A]/20 hover:border-[#E53A3A]/60 hover:scale-[1.02] active:scale-95'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-start justify-between gap-2\">\r\n                  <p className={`font-medium text-xs sm:text-sm leading-relaxed flex-1 ${\r\n                    isUsed ? 'text-[#888888]' : 'text-[#CFCFCF]'\r\n                  }`}>\r\n                    {prompt}\r\n                  </p>\r\n                  {isUsed && (\r\n                    <span className=\"text-[#5CBB7B] text-sm flex-shrink-0\" aria-label=\"Used\">\r\n                      ‚úì\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SuggestedPrompts;\r\n","import React from 'react';\r\n\r\ninterface ActiveSessionToggleProps {\r\n  isActive: boolean;\r\n  onClick: () => void;\r\n  disabled?: boolean;\r\n}\r\n\r\nexport const ActiveSessionToggle: React.FC<ActiveSessionToggleProps> = ({ \r\n  isActive, \r\n  onClick, \r\n  disabled = false \r\n}) => {\r\n  return (\r\n    <>\r\n      {/* Mobile: Segmented Control Style */}\r\n      <div className=\"sm:hidden inline-flex items-center bg-[#2E2E2E]/80 rounded-lg p-0.5 backdrop-blur-sm border border-[#424242]/30\">\r\n        <button\r\n          onClick={!isActive ? onClick : undefined}\r\n          disabled={disabled}\r\n          className={`\r\n            px-3 py-1.5 text-[10px] font-semibold rounded-md transition-all duration-200 whitespace-nowrap\r\n            ${!isActive \r\n              ? 'bg-gradient-to-r from-[#FF4D4D] to-[#FF6B6B] text-white shadow-md' \r\n              : 'text-[#A3A3A3] hover:text-[#F5F5F5]'\r\n            }\r\n            ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\r\n          `}\r\n        >\r\n          Planning\r\n        </button>\r\n        <button\r\n          onClick={isActive ? onClick : undefined}\r\n          disabled={disabled}\r\n          className={`\r\n            px-3 py-1.5 text-[10px] font-semibold rounded-md transition-all duration-200 whitespace-nowrap\r\n            ${isActive \r\n              ? 'bg-gradient-to-r from-[#FF4D4D] to-[#FF6B6B] text-white shadow-md' \r\n              : 'text-[#A3A3A3] hover:text-[#F5F5F5]'\r\n            }\r\n            ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\r\n          `}\r\n        >\r\n          Playing\r\n        </button>\r\n      </div>\r\n\r\n      {/* Desktop: Classic Toggle Style */}\r\n      <div className=\"hidden sm:inline-flex items-center gap-3\">\r\n        <span className={`text-sm font-medium transition-colors duration-200 whitespace-nowrap ${isActive ? 'text-[#A3A3A3]' : 'text-[#FF4D4D]'}`}>\r\n          Planning\r\n        </span>\r\n        \r\n        <button\r\n          onClick={onClick}\r\n          disabled={disabled}\r\n          className={`\r\n            relative inline-flex h-6 w-11 flex-shrink-0 items-center rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#FF4D4D] focus:ring-offset-2 focus:ring-offset-[#1C1C1C]\r\n            ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\r\n            ${isActive ? 'bg-[#FF4D4D]' : 'bg-[#424242]'}\r\n          `}\r\n          role=\"switch\"\r\n          aria-checked={isActive}\r\n          aria-label={isActive ? 'Switch to Planning mode' : 'Switch to Playing mode'}\r\n        >\r\n          <span\r\n            className={`\r\n              inline-block h-4 w-4 transform rounded-full bg-white transition-transform duration-200\r\n              ${isActive ? 'translate-x-6' : 'translate-x-1'}\r\n            `}\r\n          />\r\n        </button>\r\n        \r\n        <span className={`text-sm font-medium transition-colors duration-200 whitespace-nowrap ${isActive ? 'text-[#FF4D4D]' : 'text-[#A3A3A3]'}`}>\r\n          Playing\r\n        </span>\r\n      </div>\r\n    </>\r\n  );\r\n};","import React, { useState, useEffect } from 'react';\r\nimport { SubTab } from '../../types';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport remarkGfm from 'remark-gfm';\r\n\r\ninterface SubTabsProps {\r\n  subtabs: SubTab[];\r\n  activeTabId?: string;\r\n  onTabClick?: (tabId: string) => void;\r\n  isLoading?: boolean;\r\n}\r\n\r\nconst SubTabs: React.FC<SubTabsProps> = ({ \r\n  subtabs = [], \r\n  activeTabId, \r\n  onTabClick, \r\n  isLoading = false \r\n}) => {\r\n  const [localActiveTab, setLocalActiveTab] = useState<string>(activeTabId || subtabs[0]?.id || '');\r\n  const [isExpanded, setIsExpanded] = useState<boolean>(false);\r\n  const [hasUserInteracted, setHasUserInteracted] = useState<boolean>(false);\r\n\r\n  const currentActiveTab = activeTabId || localActiveTab;\r\n  const activeTab = subtabs.find(tab => tab.id === currentActiveTab);\r\n\r\n  // üîç DEBUG: Log subtabs state on every render\r\n  console.log('üé® [SubTabs] Rendering:', {\r\n    subtabCount: subtabs.length,\r\n    statuses: subtabs.map(s => ({ title: s.title, status: s.status, hasContent: !!s.content })),\r\n    isExpanded,\r\n    hasUserInteracted,\r\n    activeTabTitle: activeTab?.title,\r\n    activeTabStatus: activeTab?.status,\r\n    activeTabHasContent: !!activeTab?.content\r\n  });\r\n\r\n  // Auto-expand when subtabs finish loading (ONLY if user hasn't manually controlled it)\r\n  useEffect(() => {\r\n    // Only auto-expand if user hasn't manually interacted with the accordion\r\n    if (hasUserInteracted) {\r\n      return;\r\n    }\r\n\r\n    // ‚úÖ FIX: More robust status checks\r\n    const allLoading = subtabs.every(tab => tab.status === 'loading');\r\n    const anyLoaded = subtabs.some(tab => tab.status === 'loaded');\r\n    const allLoaded = subtabs.every(tab => tab.status === 'loaded');\r\n    \r\n    // Check if we have subtabs that are loaded with actual content\r\n    const hasLoadedContent = subtabs.some(tab => \r\n      tab.status === 'loaded' && \r\n      tab.content && \r\n      tab.content.trim().length > 0 && \r\n      tab.content.trim() !== 'Loading...'\r\n    );\r\n    \r\n    console.log('üìÇ [SubTabs] useEffect triggered:', {\r\n      allLoading,\r\n      anyLoaded,\r\n      allLoaded,\r\n      hasLoadedContent,\r\n      isExpanded,\r\n      hasUserInteracted,\r\n      subtabStatuses: subtabs.map(s => ({ title: s.title, status: s.status })),\r\n      subtabContentLengths: subtabs.map(s => ({ title: s.title, length: s.content?.length || 0 }))\r\n    });\r\n    \r\n    // ‚úÖ FIX: Collapse if all loading\r\n    if (allLoading && isExpanded) {\r\n      console.log('üìÇ [SubTabs] Collapsing subtabs - all loading');\r\n      setIsExpanded(false);\r\n    }\r\n    \r\n    // ‚úÖ FIX: Expand when ANY content loads (more responsive)\r\n    // Changed from hasLoadedContent to anyLoaded for immediate feedback\r\n    if (anyLoaded && !isExpanded) {\r\n      console.log('üìÇ [SubTabs] ‚úÖ AUTO-EXPANDING - detected loaded subtabs');\r\n      setIsExpanded(true);\r\n    }\r\n    \r\n    // ‚úÖ NEW: Additional check for all loaded (belt and suspenders)\r\n    if (allLoaded && !isExpanded && subtabs.length > 0) {\r\n      console.log('üìÇ [SubTabs] ‚úÖ AUTO-EXPANDING - all subtabs loaded');\r\n      setIsExpanded(true);\r\n    }\r\n  }, [subtabs, isExpanded, hasUserInteracted]);\r\n\r\n  const handleTabClick = (tabId: string) => {\r\n    setLocalActiveTab(tabId);\r\n    onTabClick?.(tabId);\r\n  };\r\n\r\n  const toggleExpanded = () => {\r\n    setIsExpanded(!isExpanded);\r\n    setHasUserInteracted(true); // Mark that user has manually controlled the accordion\r\n  };\r\n\r\n  // Return null if no subtabs (after hooks)\r\n  if (!subtabs || subtabs.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"mb-4\">\r\n      {/* Collapsible Header - Matching Latest Gaming News style */}\r\n      <button\r\n        onClick={toggleExpanded}\r\n        className=\"w-full flex items-center justify-between mb-2 py-2 px-3 rounded-lg bg-[#1C1C1C]/50 hover:bg-[#1C1C1C] border border-[#424242]/30 hover:border-[#424242]/60 transition-all duration-200\"\r\n      >\r\n        <div className=\"text-xs font-semibold text-[#A3A3A3] uppercase tracking-wider\">\r\n          Lore & Insights\r\n        </div>\r\n        <svg\r\n          className={`w-4 h-4 text-[#A3A3A3] transition-transform duration-200 ${\r\n            isExpanded ? 'rotate-180' : ''\r\n          }`}\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n        </svg>\r\n      </button>\r\n\r\n      {/* Collapsible Content */}\r\n      <div\r\n        className={`transition-all duration-300 ease-in-out overflow-hidden ${\r\n          isExpanded \r\n            ? 'max-h-[500px] opacity-100' \r\n            : 'max-h-0 opacity-0'\r\n        }`}\r\n      >\r\n        <div className=\"bg-[#1C1C1C]/60 border border-[#424242]/40 rounded-xl backdrop-blur-sm\">\r\n          {/* Tab Headers */}\r\n          <div className=\"flex items-center gap-2 p-2 sm:p-3 border-b border-[#424242]/40\">\r\n            <div className=\"flex flex-wrap gap-1 sm:gap-2 flex-1\">\r\n              {subtabs.map((tab) => (\r\n                <button\r\n                  key={tab.id}\r\n                  onClick={() => handleTabClick(tab.id)}\r\n                  className={`\r\n                    px-3 py-2 text-xs font-medium rounded-lg transition-all duration-200 whitespace-nowrap\r\n                    ${currentActiveTab === tab.id\r\n                      ? 'bg-[#FF4D4D] text-white shadow-lg'\r\n                      : 'bg-[#2E2E2E]/60 text-[#A3A3A3] hover:bg-[#424242]/60 hover:text-[#F5F5F5]'\r\n                    }\r\n                    ${tab.isNew ? 'ring-2 ring-[#FF4D4D]/50' : ''}\r\n                  `}\r\n                  disabled={isLoading}\r\n                >\r\n                  <div className=\"flex items-center gap-2\">\r\n                    {tab.isNew && (\r\n                      <div className=\"w-2 h-2 bg-[#FF4D4D] rounded-full animate-pulse\" />\r\n                    )}\r\n                    <span>{tab.title}</span>\r\n                    {tab.status === 'loading' && (\r\n                      <div className=\"w-3 h-3 border border-current border-t-transparent rounded-full animate-spin\" />\r\n                    )}\r\n                    {tab.status === 'error' && (\r\n                      <div className=\"w-3 h-3 text-red-400\">‚ö†</div>\r\n                    )}\r\n                  </div>\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Tab Content */}\r\n          {activeTab && (\r\n            <div className=\"p-4 max-h-64 overflow-y-auto transition-all duration-300\">\r\n              {activeTab.status === 'loading' || (!activeTab.content && isLoading) ? (\r\n                <div className=\"flex items-center justify-center py-8\">\r\n                  <div className=\"flex items-center gap-3 text-[#A3A3A3]\">\r\n                    <div className=\"w-5 h-5 border-2 border-[#FF4D4D] border-t-transparent rounded-full animate-spin\" />\r\n                    <span>Loading {activeTab.title}...</span>\r\n                  </div>\r\n                </div>\r\n              ) : activeTab.status === 'error' ? (\r\n                <div className=\"text-center py-8 text-[#A3A3A3]\">\r\n                  <div className=\"text-4xl mb-2\">‚ö†Ô∏è</div>\r\n                  <p>Failed to load {activeTab.title} content</p>\r\n                  <p className=\"text-sm mt-1\">Please try again later</p>\r\n                </div>\r\n              ) : activeTab.content ? (\r\n                <div className=\"prose prose-invert prose-sm max-w-none\">\r\n                  <ReactMarkdown\r\n                    remarkPlugins={[remarkGfm]}\r\n                    components={{\r\n                      h1: ({ children }) => (\r\n                        <h1 className=\"text-lg font-bold text-[#F5F5F5] mb-3\">{children}</h1>\r\n                      ),\r\n                      h2: ({ children }) => (\r\n                        <h2 className=\"text-base font-semibold text-[#F5F5F5] mb-2\">{children}</h2>\r\n                      ),\r\n                      h3: ({ children }) => (\r\n                        <h3 className=\"text-sm font-semibold text-[#F5F5F5] mb-2\">{children}</h3>\r\n                      ),\r\n                      p: ({ children }) => (\r\n                        <p className=\"text-[#CFCFCF] leading-relaxed mb-2\">{children}</p>\r\n                      ),\r\n                      ul: ({ children }) => (\r\n                        <ul className=\"list-disc list-inside text-[#CFCFCF] mb-2 space-y-1\">{children}</ul>\r\n                      ),\r\n                      ol: ({ children }) => (\r\n                        <ol className=\"list-decimal list-inside text-[#CFCFCF] mb-2 space-y-1\">{children}</ol>\r\n                      ),\r\n                      li: ({ children }) => (\r\n                        <li className=\"text-[#CFCFCF]\">{children}</li>\r\n                      ),\r\n                      strong: ({ children }) => (\r\n                        <strong className=\"font-semibold text-[#F5F5F5]\">{children}</strong>\r\n                      ),\r\n                      em: ({ children }) => (\r\n                        <em className=\"italic text-[#E0E0E0]\">{children}</em>\r\n                      ),\r\n                      code: ({ children }) => (\r\n                        <code className=\"bg-[#2E2E2E] text-[#FF4D4D] px-1 py-0.5 rounded text-xs font-mono\">\r\n                          {children}\r\n                        </code>\r\n                      ),\r\n                      pre: ({ children }) => (\r\n                        <pre className=\"bg-[#1C1C1C] border border-[#424442] rounded-lg p-3 overflow-x-auto\">\r\n                          {children}\r\n                        </pre>\r\n                      ),\r\n                      blockquote: ({ children }) => (\r\n                        <blockquote className=\"border-l-4 border-[#FF4D4D] pl-4 italic text-[#B0B0B0] my-2\">\r\n                          {children}\r\n                        </blockquote>\r\n                      ),\r\n                    }}\r\n                  >\r\n                    {activeTab.content}\r\n                  </ReactMarkdown>\r\n                </div>\r\n              ) : (\r\n                <div className=\"text-center py-8 text-[#A3A3A3]\">\r\n                  <p>No content available for {activeTab.title}</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SubTabs;\r\n","import React, { useState, useRef, useEffect, memo } from 'react';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport remarkGfm from 'remark-gfm';\r\nimport { Conversation, ActiveSessionState, ChatMessage } from '../../types';\r\nimport ManualUploadToggle from '../ui/ManualUploadToggle';\r\nimport ScreenshotButton from '../ui/ScreenshotButton';\r\nimport DownloadIcon from '../ui/DownloadIcon';\r\nimport UserAvatar from '../ui/UserAvatar';\r\nimport AIAvatar from '../ui/AIAvatar';\r\nimport TypingIndicator from '../ui/TypingIndicator';\r\nimport SendIcon from '../ui/SendIcon';\r\nimport ErrorBoundary from '../ErrorBoundary';\r\nimport TTSControls from '../ui/TTSControls';\r\nimport SuggestedPrompts from './SuggestedPrompts';\r\nimport { ActiveSessionToggle } from '../ui/ActiveSessionToggle';\r\nimport SubTabs from './SubTabs';\r\nimport { gameTabService } from '../../services/gameTabService';\r\nimport { tabManagementService } from '../../services/tabManagementService';\r\n\r\n// ============================================================================\r\n// ERROR FALLBACK COMPONENTS\r\n// ============================================================================\r\n\r\n// ‚úÖ NEW: Fallback UI for SubTabs errors\r\nconst SubTabsErrorFallback: React.FC = () => (\r\n  <div className=\"mb-4 px-3 py-4 rounded-lg bg-[#1C1C1C]/60 border border-[#FF4D4D]/30\">\r\n    <div className=\"flex items-center gap-2 mb-2\">\r\n      <span className=\"text-[#FF4D4D]\">‚ö†Ô∏è</span>\r\n      <span className=\"text-sm font-semibold text-[#FF4D4D]\">\r\n        Failed to Load Insights\r\n      </span>\r\n    </div>\r\n    <p className=\"text-xs text-[#A3A3A3]\">\r\n      There was an error loading game insights. You can still chat normally.\r\n    </p>\r\n  </div>\r\n);\r\n\r\n// ============================================================================\r\n// MEMOIZED CHAT MESSAGE COMPONENT (Performance Optimization)\r\n// ============================================================================\r\n// Prevents unnecessary re-renders when other parts of the UI update\r\n// (e.g., when subtabs update, old messages won't re-render)\r\ninterface ChatMessageComponentProps {\r\n  message: ChatMessage;\r\n  suggestedPrompts: string[];\r\n  onSuggestedPromptClick?: (prompt: string) => void;\r\n  isLoading: boolean;\r\n  conversationId?: string;\r\n  onDownloadImage: (url: string, index: number) => void;\r\n}\r\n\r\nconst ChatMessageComponent: React.FC<ChatMessageComponentProps> = ({\r\n  message,\r\n  suggestedPrompts,\r\n  onSuggestedPromptClick,\r\n  isLoading,\r\n  conversationId,\r\n  onDownloadImage\r\n}) => {\r\n  return (\r\n    <div className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}>\r\n      <div\r\n        className={`max-w-[80%] ${\r\n          message.role === 'user'\r\n            ? 'chat-message-user'\r\n            : 'chat-message-ai'\r\n        }`}\r\n      >\r\n        <div className=\"flex items-start gap-3\">\r\n          {/* Avatar */}\r\n          <div className=\"flex-shrink-0\">\r\n            {message.role === 'user' ? (\r\n              <UserAvatar className=\"w-6 h-6 sm:w-8 sm:h-8 flex-shrink-0 text-[#D98C1F]\" />\r\n            ) : (\r\n              <AIAvatar className=\"w-6 h-6 sm:w-8 sm:h-8 flex-shrink-0\" />\r\n            )}\r\n          </div>\r\n          \r\n          {/* Message content */}\r\n          <div className=\"flex-1 min-w-0\">\r\n            {message.imageUrl && (\r\n              <div className=\"chat-image-container mb-3\">\r\n                <img\r\n                  src={message.imageUrl}\r\n                  alt=\"Uploaded\"\r\n                  className=\"w-full max-w-sm rounded-lg\"\r\n                />\r\n                {/* Download button for single image */}\r\n                <div className=\"flex flex-wrap gap-2 mt-3 pt-3 border-t border-[#424242]/30\">\r\n                  <button\r\n                    onClick={() => onDownloadImage(message.imageUrl || '', 0)}\r\n                    className=\"flex items-center justify-center gap-2 px-2 sm:px-3 py-1.5 sm:py-2 border border-[#FF4D4D] text-[#FF4D4D] text-xs sm:text-sm font-medium rounded-lg hover:bg-[#FF4D4D] hover:text-white transition-all duration-300 hover:scale-105\"\r\n                    title=\"Download this screenshot\"\r\n                  >\r\n                    <DownloadIcon className=\"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0\" />\r\n                    <span className=\"hidden sm:inline\">Download</span>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"text-[#F5F5F5] leading-relaxed\">\r\n              <ReactMarkdown\r\n                remarkPlugins={[remarkGfm]}\r\n                components={{\r\n                  h1: ({ children }) => (\r\n                    <h1 className=\"text-lg font-bold text-[#F5F5F5] mb-3 mt-2\">{children}</h1>\r\n                  ),\r\n                  h2: ({ children }) => (\r\n                    <h2 className=\"text-base font-semibold text-[#F5F5F5] mb-2 mt-2\">{children}</h2>\r\n                  ),\r\n                  h3: ({ children }) => (\r\n                    <h3 className=\"text-sm font-semibold text-[#F5F5F5] mb-2 mt-2\">{children}</h3>\r\n                  ),\r\n                  p: ({ children }) => (\r\n                    <p className=\"text-[#CFCFCF] leading-relaxed mb-3\">{children}</p>\r\n                  ),\r\n                  ul: ({ children }) => (\r\n                    <ul className=\"list-disc list-outside ml-5 text-[#CFCFCF] mb-3 space-y-1.5\">{children}</ul>\r\n                  ),\r\n                  ol: ({ children }) => (\r\n                    <ol className=\"list-decimal list-outside ml-5 text-[#CFCFCF] mb-3 space-y-1.5\">{children}</ol>\r\n                  ),\r\n                  li: ({ children }) => (\r\n                    <li className=\"text-[#CFCFCF] leading-relaxed\">{children}</li>\r\n                  ),\r\n                  strong: ({ children }) => (\r\n                    <strong className=\"font-semibold text-[#F5F5F5]\">{children}</strong>\r\n                  ),\r\n                  em: ({ children }) => (\r\n                    <em className=\"italic text-[#E0E0E0]\">{children}</em>\r\n                  ),\r\n                  code: ({ children }) => (\r\n                    <code className=\"bg-[#2E2E2E] text-[#FF4D4D] px-1.5 py-0.5 rounded text-xs font-mono\">\r\n                      {children}\r\n                    </code>\r\n                  ),\r\n                  pre: ({ children }) => (\r\n                    <pre className=\"bg-[#1C1C1C] border border-[#424242] rounded-lg p-3 overflow-x-auto mb-3\">\r\n                      {children}\r\n                    </pre>\r\n                  ),\r\n                  blockquote: ({ children }) => (\r\n                    <blockquote className=\"border-l-4 border-[#FF4D4D] pl-4 italic text-[#B0B0B0] my-3\">\r\n                      {children}\r\n                    </blockquote>\r\n                  ),\r\n                  br: () => <br className=\"my-1\" />\r\n                }}\r\n              >\r\n                {message.content.replace(/\\\\\\*/g, '*')}\r\n              </ReactMarkdown>\r\n            </div>\r\n            \r\n            {/* TTS Controls for AI messages */}\r\n            {message.role === 'assistant' && <TTSControls />}\r\n            \r\n            {/* Show suggested prompts after AI response */}\r\n            {message.role === 'assistant' && suggestedPrompts.length > 0 && onSuggestedPromptClick && !isLoading && (\r\n              <div className=\"mt-4\">\r\n                <SuggestedPrompts\r\n                  prompts={suggestedPrompts}\r\n                  onPromptClick={onSuggestedPromptClick}\r\n                  isLoading={isLoading}\r\n                  conversationId={conversationId}\r\n                />\r\n              </div>\r\n            )}\r\n            \r\n            <p className=\"text-xs text-[#A3A3A3] mt-3\">\r\n              {new Date(message.timestamp).toLocaleTimeString()}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Memoize the component to prevent unnecessary re-renders\r\n// Only re-renders if message props actually change\r\nconst MemoizedChatMessage = memo(ChatMessageComponent, (prevProps, nextProps) => {\r\n  // Custom comparison: only re-render if message content, suggested prompts, or loading state changes\r\n  return (\r\n    prevProps.message.id === nextProps.message.id &&\r\n    prevProps.message.content === nextProps.message.content &&\r\n    prevProps.message.timestamp === nextProps.message.timestamp &&\r\n    prevProps.isLoading === nextProps.isLoading &&\r\n    prevProps.suggestedPrompts.length === nextProps.suggestedPrompts.length\r\n  );\r\n});\r\n\r\nMemoizedChatMessage.displayName = 'MemoizedChatMessage';\r\n\r\n// ============================================================================\r\n// MAIN CHAT INTERFACE COMPONENT\r\n// ============================================================================\r\n\r\ninterface ChatInterfaceProps {\r\n  conversation: Conversation | null;\r\n  onSendMessage: (message: string, imageUrl?: string) => void;\r\n  isLoading: boolean;\r\n  isPCConnected?: boolean;\r\n  onRequestConnect?: () => void;\r\n  userTier?: string;\r\n  onStop?: () => void;\r\n  isManualUploadMode?: boolean;\r\n  onToggleManualUploadMode?: () => void;\r\n  suggestedPrompts?: string[];\r\n  onSuggestedPromptClick?: (prompt: string) => void;\r\n  activeSession?: ActiveSessionState;\r\n  onToggleActiveSession?: () => void;\r\n  initialMessage?: string;\r\n  onMessageChange?: (message: string) => void;\r\n  queuedImage?: string | null; // ‚úÖ NEW: For WebSocket screenshot in manual mode\r\n  onImageQueued?: () => void; // ‚úÖ NEW: Callback when image is accepted\r\n}\r\n\r\nconst ChatInterface: React.FC<ChatInterfaceProps> = ({\r\n  conversation,\r\n  onSendMessage,\r\n  isLoading,\r\n  isPCConnected = false,\r\n  onRequestConnect,\r\n  userTier = 'free',\r\n  onStop,\r\n  isManualUploadMode = false,\r\n  onToggleManualUploadMode,\r\n  suggestedPrompts = [],\r\n  onSuggestedPromptClick,\r\n  activeSession,\r\n  onToggleActiveSession,\r\n  initialMessage = '',\r\n  onMessageChange,\r\n  queuedImage = null, // ‚úÖ NEW: Receive queued image from WebSocket\r\n  onImageQueued, // ‚úÖ NEW: Callback when image is set\r\n}) => {\r\n  const [message, setMessage] = useState(initialMessage);\r\n  const [imageFile, setImageFile] = useState<File | null>(null);\r\n  const [imagePreview, setImagePreview] = useState<string | null>(null);\r\n  const [isFocused, setIsFocused] = useState(false);\r\n  const [showAutocomplete, setShowAutocomplete] = useState(false);\r\n  const [autocompleteSuggestions, setAutocompleteSuggestions] = useState<string[]>([]);\r\n  const [selectedSuggestionIndex, setSelectedSuggestionIndex] = useState(0);\r\n  // Mobile: collapsed by default, Desktop: expanded by default\r\n  const [isQuickActionsExpanded, setIsQuickActionsExpanded] = useState(() => {\r\n    return window.innerWidth > 640; // Collapsed on mobile (<=640px), expanded on desktop\r\n  });\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\r\n  const autocompleteRef = useRef<HTMLDivElement>(null);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  // Auto-resize textarea functionality\r\n  const adjustTextareaHeight = () => {\r\n    const textarea = textareaRef.current;\r\n    if (textarea) {\r\n      const MAX_HEIGHT = 120; // Max 5 lines\r\n      const MIN_HEIGHT = 44; // Single line height\r\n      \r\n      textarea.style.height = 'auto';\r\n      const scrollHeight = textarea.scrollHeight;\r\n      const newHeight = Math.min(Math.max(scrollHeight, MIN_HEIGHT), MAX_HEIGHT);\r\n      textarea.style.height = `${newHeight}px`;\r\n    }\r\n  };\r\n\r\n  // Handle textarea value change\r\n  const handleValueChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    const newValue = e.target.value;\r\n    setMessage(newValue);\r\n    adjustTextareaHeight();\r\n    // Notify parent of message change\r\n    onMessageChange?.(newValue);\r\n\r\n    // Check for @ command to show autocomplete\r\n    if (conversation && newValue.startsWith('@')) {\r\n      const availableTabs = tabManagementService.getAvailableTabNames(conversation);\r\n      if (availableTabs.length > 0) {\r\n        setAutocompleteSuggestions(availableTabs);\r\n        setShowAutocomplete(true);\r\n        setSelectedSuggestionIndex(0);\r\n      } else {\r\n        setShowAutocomplete(false);\r\n      }\r\n    } else {\r\n      setShowAutocomplete(false);\r\n    }\r\n  };\r\n\r\n  // Handle suggestion selection\r\n  const handleSelectSuggestion = (tabId: string) => {\r\n    setMessage(`@${tabId} `);\r\n    setShowAutocomplete(false);\r\n    textareaRef.current?.focus();\r\n  };\r\n\r\n  // Handle key down events\r\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\r\n    // Handle autocomplete navigation\r\n    if (showAutocomplete && autocompleteSuggestions.length > 0) {\r\n      if (e.key === 'ArrowDown') {\r\n        e.preventDefault();\r\n        setSelectedSuggestionIndex(prev => \r\n          prev < autocompleteSuggestions.length - 1 ? prev + 1 : 0\r\n        );\r\n        return;\r\n      } else if (e.key === 'ArrowUp') {\r\n        e.preventDefault();\r\n        setSelectedSuggestionIndex(prev => \r\n          prev > 0 ? prev - 1 : autocompleteSuggestions.length - 1\r\n        );\r\n        return;\r\n      } else if (e.key === 'Tab' || (e.key === 'Enter' && showAutocomplete)) {\r\n        e.preventDefault();\r\n        handleSelectSuggestion(autocompleteSuggestions[selectedSuggestionIndex]);\r\n        return;\r\n      } else if (e.key === 'Escape') {\r\n        e.preventDefault();\r\n        setShowAutocomplete(false);\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Handle normal Enter key\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSubmit(e as any);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [conversation?.messages]);\r\n\r\n  // Adjust textarea height when message changes\r\n  useEffect(() => {\r\n    adjustTextareaHeight();\r\n  }, [message]);\r\n\r\n  // Update message when initialMessage prop changes (e.g., after tab switch)\r\n  useEffect(() => {\r\n    if (initialMessage !== undefined && initialMessage !== message) {\r\n      setMessage(initialMessage);\r\n    }\r\n  }, [initialMessage, message]);\r\n\r\n  // ‚úÖ NEW: Handle queued image from WebSocket (manual mode)\r\n  useEffect(() => {\r\n    if (queuedImage && isManualUploadMode) {\r\n      console.log('üì∏ [ChatInterface] Queued image received from WebSocket:', {\r\n        queuedImageLength: queuedImage.length,\r\n        queuedImagePreview: queuedImage.substring(0, 50),\r\n        currentImagePreview: imagePreview?.substring(0, 50),\r\n        isManualUploadMode\r\n      });\r\n      setImagePreview(queuedImage);\r\n      // Notify parent that image was accepted\r\n      onImageQueued?.();\r\n    }\r\n    // ‚úÖ FIX: Removed imagePreview from dependencies to prevent infinite loop\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [queuedImage, isManualUploadMode, onImageQueued]);\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    console.log('üì§ [ChatInterface] Submit attempt:', { \r\n      message: message.trim(), \r\n      hasMessage: !!message.trim(), \r\n      hasImageFile: !!imageFile, \r\n      hasImagePreview: !!imagePreview,\r\n      shouldSubmit: !(!message.trim() && !imageFile)\r\n    });\r\n    \r\n    // Allow submission if there's either a message OR an image\r\n    if (!message.trim() && !imageFile) {\r\n      console.log('üì§ [ChatInterface] Submission blocked: no message and no image');\r\n      return;\r\n    }\r\n\r\n    // Collapse quick actions when sending a message\r\n    if (conversation?.isGameHub) {\r\n      setIsQuickActionsExpanded(false);\r\n    }\r\n\r\n    const imageUrl = imagePreview || undefined;\r\n    console.log('üì§ [ChatInterface] Submitting:', { message, hasImage: !!imageUrl, imageUrl: imageUrl?.substring(0, 50) + '...' });\r\n    onSendMessage(message, imageUrl);\r\n    setMessage('');\r\n    setImageFile(null);\r\n    setImagePreview(null);\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    console.log('üì∏ [ChatInterface] Image upload:', { file, fileName: file?.name, fileSize: file?.size });\r\n    if (file) {\r\n      setImageFile(file);\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        const result = e.target?.result as string;\r\n        console.log('üì∏ [ChatInterface] Image preview created:', { \r\n          hasResult: !!result, \r\n          resultLength: result?.length,\r\n          resultStart: result?.substring(0, 50) + '...'\r\n        });\r\n        setImagePreview(result);\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const removeImage = () => {\r\n    setImageFile(null);\r\n    setImagePreview(null);\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  const toggleManualUploadMode = () => {\r\n    onToggleManualUploadMode?.();\r\n  };\r\n\r\n  // Function to download image in high quality\r\n  const downloadImage = (imageSrc: string, index: number) => {\r\n    try {\r\n      // Create a temporary link element\r\n      const link = document.createElement('a');\r\n      link.href = imageSrc;\r\n      \r\n      // Generate filename with timestamp\r\n      const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');\r\n      const filename = `otakon-screenshot-${index + 1}-${timestamp}.png`;\r\n      link.download = filename;\r\n      \r\n      // Append to body, click, and remove\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n    } catch (error) {\r\n      console.error('Failed to download image:', error);\r\n      // Fallback: open image in new tab\r\n      window.open(imageSrc, '_blank');\r\n    }\r\n  };\r\n\r\n\r\n  // Show loading state if no conversation yet\r\n  if (!conversation) {\r\n    return (\r\n      <div className=\"h-full bg-background flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#FF4D4D] mx-auto mb-4\"></div>\r\n          <p className=\"text-text-muted\">Loading chat...</p>\r\n          <p className=\"text-text-muted text-sm mt-2\">This may take a moment after completing onboarding</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Safety check for conversation\r\n  if (!conversation) {\r\n    return (\r\n      <div className=\"h-full bg-background flex flex-col overflow-hidden\">\r\n        <div className=\"flex-1 p-6 flex items-center justify-center\">\r\n          <div className=\"text-center\">\r\n            <p className=\"text-text-muted text-lg\">Loading conversation...</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"h-full bg-gradient-to-r from-surface/30 to-background/30 flex flex-col overflow-hidden\">\r\n      {/* Messages Area - Only this should scroll */}\r\n      <div className={`flex-1 p-6 space-y-6 min-h-0 ${conversation.messages.length > 0 ? 'overflow-y-auto custom-scrollbar' : 'overflow-y-hidden'}`}>\r\n        {conversation.messages.length === 0 ? (\r\n          <div className=\"flex items-center justify-center h-full\">\r\n            <div className=\"text-center\">\r\n              <p className=\"text-text-muted text-lg\">\r\n                Start a conversation with <span className=\"bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] bg-clip-text text-transparent font-semibold\">Otagon</span>\r\n              </p>\r\n              <p className=\"text-text-muted text-sm mt-2\">Ask me anything about gaming, strategies, or tips.</p>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          conversation.messages.map((msg) => (\r\n            <MemoizedChatMessage\r\n              key={msg.id}\r\n              message={msg}\r\n              suggestedPrompts={msg.role === 'assistant' ? suggestedPrompts : []}\r\n              onSuggestedPromptClick={onSuggestedPromptClick}\r\n              isLoading={isLoading}\r\n              conversationId={conversation?.id}\r\n              onDownloadImage={downloadImage}\r\n            />\r\n          ))\r\n        )}\r\n        \r\n        {isLoading && (\r\n          <div className=\"flex justify-start\">\r\n            <div className=\"flex items-start gap-3\">\r\n              {/* AI Avatar */}\r\n              <div className=\"flex-shrink-0\">\r\n                <AIAvatar className=\"w-6 h-6 sm:w-8 sm:h-8 flex-shrink-0\" />\r\n              </div>\r\n              \r\n              {/* Loading content */}\r\n              <div className=\"flex-1 min-w-0\">\r\n                <div className=\"flex items-center gap-3 sm:gap-4 py-2 sm:py-3\">\r\n                  <TypingIndicator variant=\"dots\" showText={false} />\r\n                  {onStop && (\r\n                    <button\r\n                      onClick={onStop}\r\n                      className=\"text-xs font-semibold px-2 sm:px-3 py-1 sm:py-1.5 rounded-full transition-all duration-200 bg-[#424242]/60 text-[#CFCFCF] hover:bg-[#424242] hover:text-[#F5F5F5] hover:scale-105\"\r\n                      aria-label=\"Stop generating response\"\r\n                    >\r\n                      Stop\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      {/* Image Preview - Show inside the chat input area */}\r\n      {/* Removed - will show preview inside the input form instead */}\r\n\r\n\r\n      {/* Sub-tabs Section - Show for released game conversations only (not Game Hub, not unreleased) */}\r\n      {conversation && !conversation.isGameHub && !conversation.isUnreleased && conversation.subtabs && conversation.subtabs.length > 0 && (\r\n        <div className=\"flex-shrink-0 px-3 pb-2\">\r\n          <ErrorBoundary fallback={<SubTabsErrorFallback />}>\r\n            <SubTabs\r\n              key={`subtabs-${conversation.id}`}\r\n              subtabs={conversation.subtabs}\r\n              isLoading={isLoading}\r\n            />\r\n          </ErrorBoundary>\r\n        </div>\r\n      )}\r\n\r\n      {/* Game Hub Quick Prompts - Only show in Game Hub tab */}\r\n      {conversation?.isGameHub && (\r\n        <div className=\"flex-shrink-0 px-3 pb-3\">\r\n          {/* Collapsible Header */}\r\n          <button\r\n            onClick={() => setIsQuickActionsExpanded(!isQuickActionsExpanded)}\r\n            className=\"w-full flex items-center justify-between mb-2 py-2 px-3 rounded-lg bg-[#1C1C1C]/50 hover:bg-[#1C1C1C] border border-[#424242]/30 hover:border-[#424242]/60 transition-all duration-200\"\r\n          >\r\n            <div className=\"text-xs font-semibold text-[#A3A3A3] uppercase tracking-wider\">\r\n              Latest Gaming News\r\n            </div>\r\n            <svg\r\n              className={`w-4 h-4 text-[#A3A3A3] transition-transform duration-200 ${\r\n                isQuickActionsExpanded ? 'rotate-180' : ''\r\n              }`}\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n            </svg>\r\n          </button>\r\n\r\n          {/* Collapsible Content */}\r\n          <div\r\n            className={`grid grid-cols-2 gap-2 transition-all duration-300 ease-in-out overflow-hidden ${\r\n              isQuickActionsExpanded \r\n                ? 'max-h-96 opacity-100' \r\n                : 'max-h-0 opacity-0'\r\n            }`}\r\n          >\r\n            {[\r\n              { text: \"What's the latest gaming news?\", shape: \"‚úï\" },\r\n              { text: \"Which games are releasing soon?\", shape: \"‚ñ†\" },\r\n              { text: \"What are the latest game reviews?\", shape: \"‚ñ≤\" },\r\n              { text: \"Show me the hottest new game trailers.\", shape: \"‚óØ\" }\r\n            ].map((prompt) => (\r\n              <button\r\n                key={prompt.text}\r\n                onClick={() => {\r\n                  setIsQuickActionsExpanded(false);\r\n                  onSuggestedPromptClick?.(prompt.text);\r\n                }}\r\n                disabled={isLoading}\r\n                className=\"group relative px-3 py-3 rounded-xl bg-gradient-to-br from-[#1C1C1C] to-[#0F0F0F] hover:from-[#252525] hover:to-[#1A1A1A] border border-[#424242]/30 hover:border-[#E53A3A]/50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-left overflow-hidden\"\r\n              >\r\n                <div className=\"absolute inset-0 bg-gradient-to-r from-[#E53A3A]/10 to-[#FF6B35]/10 opacity-0 group-hover:opacity-100 transition-opacity duration-200\"></div>\r\n                <div className=\"relative flex flex-col sm:flex-row items-start sm:items-center gap-2\">\r\n                  <span className=\"text-lg flex-shrink-0 text-[#E53A3A] font-bold leading-none\">{prompt.shape}</span>\r\n                  <span className=\"text-xs sm:text-sm text-[#E5E5E5] font-medium group-hover:text-white transition-colors leading-tight\">\r\n                    {prompt.text}\r\n                  </span>\r\n                </div>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Floating Chat Input Section with Gradient Border */}\r\n      <div className=\"flex-shrink-0 bg-background/95 backdrop-blur-sm\">\r\n        <div className=\"mx-3 my-3 rounded-2xl p-px transition-all duration-300\" style={{\r\n          background: isFocused \r\n            ? 'linear-gradient(135deg, #FF4D4D, #FFAB40)'\r\n            : 'transparent'\r\n        }}>\r\n          <form onSubmit={handleSubmit} className=\"relative p-3 rounded-2xl bg-gradient-to-r from-[#1A1A1A] to-[#0F0F0F] animate-pulse-glow\" style={{\r\n            background: 'linear-gradient(135deg, #1A1A1A 0%, #0F0F0F 100%)',\r\n            boxShadow: '0 0 20px rgba(255, 77, 77, 0.3), 0 0 40px rgba(255, 171, 64, 0.2), 0 0 60px rgba(0, 0, 0, 0.1)'\r\n          }}>\r\n          \r\n          {/* Autocomplete Dropdown */}\r\n          {showAutocomplete && autocompleteSuggestions.length > 0 && (\r\n            <div \r\n              ref={autocompleteRef}\r\n              className=\"absolute bottom-full mb-2 left-3 right-3 bg-[#1C1C1C] border border-[#424242] rounded-lg shadow-lg z-50 max-h-48 overflow-y-auto\"\r\n            >\r\n              <div className=\"p-2\">\r\n                <div className=\"text-xs text-[#A3A3A3] mb-2 px-2\">\r\n                  Select a subtab to update:\r\n                </div>\r\n                {autocompleteSuggestions.map((tabId, index) => {\r\n                  const tab = conversation?.subtabs?.find(t => t.id === tabId);\r\n                  return (\r\n                    <button\r\n                      key={tabId}\r\n                      type=\"button\"\r\n                      onClick={() => handleSelectSuggestion(tabId)}\r\n                      className={`w-full text-left px-3 py-2 rounded transition-colors ${\r\n                        index === selectedSuggestionIndex\r\n                          ? 'bg-[#E53A3A]/20 border border-[#E53A3A]/60'\r\n                          : 'hover:bg-[#2A2A2A] border border-transparent'\r\n                      }`}\r\n                    >\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-[#E53A3A] font-mono text-sm\">@{tabId}</span>\r\n                        {tab && (\r\n                          <span className=\"text-[#888888] text-xs\">- {tab.title}</span>\r\n                        )}\r\n                      </div>\r\n                    </button>\r\n                  );\r\n                })}\r\n              </div>\r\n              <div className=\"px-3 py-2 border-t border-[#424242]/30 bg-[#1A1A1A]/50\">\r\n                <div className=\"text-xs text-[#888888]\">\r\n                  Use ‚Üë‚Üì to navigate, Tab/Enter to select, Esc to cancel\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Textarea Container - Grows upward */}\r\n          <div className=\"relative mb-2\">\r\n            {/* Image Preview - Inside the form so it doesn't push input off screen */}\r\n            {imagePreview && (\r\n              <div className=\"mb-2 flex items-center gap-2\">\r\n                <div className=\"relative\">\r\n                  <img\r\n                    src={imagePreview}\r\n                    alt=\"Preview\"\r\n                    className=\"w-24 h-24 object-cover rounded-lg border border-[#424242]/40\"\r\n                  />\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={removeImage}\r\n                    className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs hover:bg-red-600 transition-colors flex-shrink-0\"\r\n                  >\r\n                    √ó\r\n                  </button>\r\n                </div>\r\n                <div className=\"text-xs text-[#A3A3A3]\">\r\n                  <p className=\"font-semibold\">Image Ready</p>\r\n                  <p>Add a message or send</p>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            <textarea\r\n              ref={textareaRef}\r\n              value={message}\r\n              onChange={handleValueChange}\r\n              onKeyDown={handleKeyDown}\r\n              onFocus={() => setIsFocused(true)}\r\n              onBlur={() => setIsFocused(false)}\r\n              placeholder=\"Type your message...\"\r\n              className=\"w-full px-4 sm:px-6 text-base text-[#F5F5F5] placeholder-[#A3A3A3] resize-none overflow-y-auto focus:outline-none disabled:opacity-60 bg-transparent border-0 rounded-xl\"\r\n              style={{\r\n                minHeight: '44px',\r\n                maxHeight: '120px',\r\n                lineHeight: '44px',\r\n                height: '44px',\r\n                paddingTop: '10px',\r\n                paddingBottom: '10px'\r\n              }}\r\n              disabled={isLoading}\r\n              rows={1}\r\n            />\r\n            </div>\r\n          \r\n          {/* Fixed Button Row - Always at bottom */}\r\n          <div className=\"flex items-center space-x-2 sm:space-x-3\">\r\n            <div className=\"flex-1 flex items-center space-x-2 sm:space-x-3\">\r\n              <input\r\n                type=\"file\"\r\n                ref={fileInputRef}\r\n                onChange={handleImageUpload}\r\n                accept=\"image/*\"\r\n                className=\"hidden\"\r\n              />\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => fileInputRef.current?.click()}\r\n                className=\"w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-gradient-to-r from-[#2E2E2E]/90 to-[#1C1C1C]/90 flex items-center justify-center transition-all duration-300 hover:scale-105 text-text-muted hover:text-text-primary\"\r\n              >\r\n                <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\r\n                </svg>\r\n              </button>\r\n\r\n              {/* Only show ScreenshotButton and ManualUploadToggle when connected to PC */}\r\n              {isPCConnected && (\r\n                <>\r\n                  <ManualUploadToggle\r\n                    isManualMode={isManualUploadMode}\r\n                    onToggle={toggleManualUploadMode}\r\n                    isConnected={isPCConnected}\r\n                  />\r\n                  <ScreenshotButton\r\n                    isConnected={isPCConnected}\r\n                    isProcessing={isLoading}\r\n                    isManualUploadMode={isManualUploadMode}\r\n                    onRequestConnect={onRequestConnect}\r\n                    usage={{ tier: userTier as any }}\r\n                  />\r\n                </>\r\n              )}\r\n\r\n            </div>\r\n            \r\n            {/* Active Session Toggle - Show only for released game tabs */}\r\n            {/* For unreleased games, show \"Discuss\" mode label with disabled toggle */}\r\n            {conversation && gameTabService.isGameTab(conversation) && activeSession && (\r\n              conversation.isUnreleased ? (\r\n                <div className=\"flex items-center gap-2 px-4 py-2 bg-surface/50 rounded-lg border border-surface-light/20\">\r\n                  <span className=\"text-sm font-medium text-text-muted\">Discuss Mode</span>\r\n                  <div className=\"text-xs text-text-muted/60\">(No Playing mode until release)</div>\r\n                </div>\r\n              ) : onToggleActiveSession && (\r\n                <div className=\"flex-shrink-0\">\r\n                  <ActiveSessionToggle\r\n                    isActive={activeSession.isActive && activeSession.currentGameId === conversation.id}\r\n                    onClick={onToggleActiveSession}\r\n                  />\r\n                </div>\r\n              )\r\n            )}\r\n            \r\n            <button\r\n              type=\"submit\"\r\n              disabled={!message.trim() && !imageFile}\r\n              aria-label=\"Send message\"\r\n              className={`flex items-center justify-center w-12 h-12 sm:w-14 sm:h-14 rounded-xl transition-all duration-300 disabled:cursor-not-allowed ${\r\n                (!message.trim() && !imageFile) || isLoading\r\n                  ? 'bg-[#2E2E2E]/15 text-[#A3A3A3]/25 scale-100'\r\n                  : 'bg-gradient-to-r from-[#FFAB40] to-[#FF8C00] text-[#181818] scale-100 hover:scale-105 hover:shadow-lg hover:shadow-[#FFAB40]/25 active:scale-95 font-semibold'\r\n              }`}\r\n            >\r\n              {isLoading ? (\r\n                <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-current\"></div>\r\n              ) : (\r\n                <SendIcon className=\"w-5 h-5 sm:w-6 sm:h-6\" />\r\n              )}\r\n            </button>\r\n          </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatInterface;\r\n","import React from 'react';\r\n\r\ninterface GameProgressBarProps {\r\n  progress: number; // 0-100\r\n  gameTitle?: string;\r\n  className?: string;\r\n}\r\n\r\nconst GameProgressBar: React.FC<GameProgressBarProps> = ({ \r\n  progress,\r\n  className = '' \r\n}) => {\r\n  const clampedProgress = Math.min(Math.max(progress, 0), 100);\r\n  \r\n  return (\r\n    <div className={`relative ${className}`}>\r\n      {/* Progress Track */}\r\n      <div className=\"relative h-2 bg-surface-light/20 rounded-full overflow-hidden\">\r\n        {/* Progress Fill */}\r\n        <div\r\n          className=\"absolute left-0 top-0 h-full bg-gradient-to-r from-primary to-primary-dark transition-all duration-500 ease-out\"\r\n          style={{ width: `${clampedProgress}%` }}\r\n        />\r\n        \r\n        {/* Progress Dot */}\r\n        <div\r\n          className=\"absolute top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full shadow-lg border-2 border-primary transition-all duration-500 ease-out\"\r\n          style={{ \r\n            left: `${clampedProgress}%`,\r\n            transform: `translateX(-50%) translateY(-50%)`\r\n          }}\r\n        >\r\n          {/* Pulse animation for recent updates */}\r\n          <div className=\"absolute inset-0 bg-primary/30 rounded-full animate-ping\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameProgressBar;\r\n"],"names":["getPublicPath","path","cleanPath","base","ManualUploadToggle","isManualMode","onToggle","isConnected","title","jsx","ManualUploadToggle$1","React","ScreenshotButton","isProcessing","isManualUploadMode","onRequestConnect","usage","mode","setMode","useState","menuOpen","setMenuOpen","rootRef","useRef","btnRef","longPressRef","showHint","setShowHint","canUseMultishot","isFreeUser","useEffect","saved","setModeAndPersist","m","handler","e","openMenu","handleContextMenu","handleMouseDown","handleTouchStart","clearLongPress","handleClick","msg","send","handleMultishotClick","jsxs","Fragment","DownloadIcon","className","UserAvatar","AIAvatar","TypingIndicator","variant","showText","SendIcon","ErrorBoundary","Component","props","__publicField","error","errorInfo","TTSControls","isSpeaking","setIsSpeaking","isPaused","setIsPaused","handleTTSStarted","handleTTSStopped","handleTTSPaused","handleTTSResumed","handlePauseResume","ttsService","handleRestart","SuggestedPrompts","prompts","onPromptClick","isLoading","conversationId","isMobile","setIsMobile","accordionOpen","setAccordionOpen","usedPrompts","setUsedPrompts","isShowingNewsPrompts","newsPrompts","p","i","displayPrompts","mq","apply","used","suggestedPromptsService","handlePromptClick","prompt","prev","v","index","isUsed","ActiveSessionToggle","isActive","onClick","disabled","SubTabs","subtabs","activeTabId","onTabClick","localActiveTab","setLocalActiveTab","_a","isExpanded","setIsExpanded","hasUserInteracted","setHasUserInteracted","currentActiveTab","activeTab","tab","allLoading","anyLoaded","allLoaded","hasLoadedContent","s","handleTabClick","tabId","toggleExpanded","ReactMarkdown","remarkGfm","children","SubTabsErrorFallback","ChatMessageComponent","message","suggestedPrompts","onSuggestedPromptClick","onDownloadImage","MemoizedChatMessage","memo","prevProps","nextProps","ChatInterface","conversation","onSendMessage","isPCConnected","userTier","onStop","onToggleManualUploadMode","activeSession","onToggleActiveSession","initialMessage","onMessageChange","queuedImage","onImageQueued","setMessage","imageFile","setImageFile","imagePreview","setImagePreview","isFocused","setIsFocused","showAutocomplete","setShowAutocomplete","autocompleteSuggestions","setAutocompleteSuggestions","selectedSuggestionIndex","setSelectedSuggestionIndex","isQuickActionsExpanded","setIsQuickActionsExpanded","messagesEndRef","fileInputRef","textareaRef","autocompleteRef","scrollToBottom","adjustTextareaHeight","textarea","scrollHeight","newHeight","handleValueChange","newValue","availableTabs","tabManagementService","handleSelectSuggestion","handleKeyDown","handleSubmit","imageUrl","handleImageUpload","file","reader","result","removeImage","toggleManualUploadMode","downloadImage","imageSrc","link","timestamp","filename","t","gameTabService","GameProgressBar","progress","clampedProgress"],"mappings":"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"}