import{r as w,j as e}from"./react-vendor-JBKW6UM3.js";import{L as R}from"./gaming-explorer-CZ7zqxOU.js";const U=({isOpen:x,position:m,onClose:i,onDelete:d,onPin:g,onUnpin:u,onClearConversation:h,canDelete:y=!0,canPin:k=!0,isPinned:f=!1,isEverythingElse:j=!1})=>{const b=w.useRef(null);return w.useEffect(()=>{const N=c=>{b.current&&!b.current.contains(c.target)&&i()},s=c=>{c.key==="Escape"&&i()};return x&&(document.addEventListener("mousedown",N),document.addEventListener("keydown",s)),()=>{document.removeEventListener("mousedown",N),document.removeEventListener("keydown",s)}},[x,i]),x?e.jsxs("div",{ref:b,className:"fixed z-[100] bg-surface border border-surface-light/20 rounded-lg shadow-xl py-2 min-w-[160px]",style:{left:m.x,top:m.y,transform:m.y<200?"translate(-50%, 10px)":"translate(-50%, -100%)"},children:[k&&!j&&e.jsxs("button",{onClick:()=>{f?u==null||u():g==null||g(),i()},className:"w-full px-4 py-2 text-left text-text-primary hover:bg-surface-light/50 transition-colors duration-200 flex items-center space-x-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),e.jsx("span",{children:f?"Unpin":"Pin to top"})]}),e.jsxs("button",{onClick:()=>{h==null||h(),i()},className:"w-full px-4 py-2 text-left text-orange-400 hover:bg-orange-500/10 transition-colors duration-200 flex items-center space-x-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),e.jsx("span",{children:"Clear conversation"})]}),y&&!j&&e.jsxs("button",{onClick:()=>{d==null||d(),i()},className:"w-full px-4 py-2 text-left text-red-400 hover:bg-red-500/10 transition-colors duration-200 flex items-center space-x-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),e.jsx("span",{children:"Delete"})]})]}):null},$=({isOpen:x,onClose:m,conversations:i,activeConversation:d,onConversationSelect:g,onDeleteConversation:u,onPinConversation:h,onUnpinConversation:y,onClearConversation:k,onAddGame:f,onOpenExplorer:j,userTier:b,isOnTrial:N=!1})=>{var I,H,P,B;const[s,c]=w.useState({isOpen:!1,position:{x:0,y:0},conversationId:null}),L=w.useRef(null),M=w.useRef(null),E=1500,A=Object.values(i).sort((t,r)=>{const n=t.isGameHub||t.id==="game-hub"||t.title==="Game Hub",l=r.isGameHub||r.id==="game-hub"||r.title==="Game Hub";return n&&!l?-1:!n&&l?1:t.isPinned&&!r.isPinned?-1:!t.isPinned&&r.isPinned?1:t.isPinned&&r.isPinned?(t.pinnedAt||0)-(r.pinnedAt||0):t.createdAt-r.createdAt}),G=(t,r)=>{t.preventDefault(),t.stopPropagation();const l=t.currentTarget.getBoundingClientRect(),o=Math.min(l.right+8,window.innerWidth-180),p=Math.min(l.top,window.innerHeight-200);c({isOpen:!0,position:{x:o,y:p},conversationId:r})},C=(t,r)=>{M.current=t.currentTarget,L.current=setTimeout(()=>{if(M.current){const n=M.current.getBoundingClientRect(),l=Math.min(n.right+8,window.innerWidth-180),o=Math.min(n.top,window.innerHeight-200);c({isOpen:!0,position:{x:l,y:o},conversationId:r})}},E)},F=()=>{L.current&&(clearTimeout(L.current),L.current=null),M.current=null},v=()=>{c({isOpen:!1,position:{x:0,y:0},conversationId:null})},D=()=>{s.conversationId&&(u(s.conversationId),v())},z=()=>{s.conversationId&&h&&(h(s.conversationId),v())},T=()=>{s.conversationId&&y&&(y(s.conversationId),v())},W=()=>{s.conversationId&&k&&(k(s.conversationId),v())};return e.jsxs(e.Fragment,{children:[x&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md z-[55] lg:hidden",onClick:m}),e.jsx("div",{className:`fixed inset-y-0 left-0 z-[60] w-72 sm:w-80 bg-gradient-to-b from-surface to-background border-r border-surface-light/20 transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0 ${x?"translate-x-0":"-translate-x-full"}`,style:{zIndex:60},children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"px-3 py-3 sm:px-4 sm:py-4 lg:px-6 lg:py-6 border-b border-surface-light/20 flex-shrink-0 relative",style:{zIndex:10},children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[j?e.jsxs("button",{onClick:j,className:"group flex-1 flex items-center gap-3 px-4 py-2.5 sm:px-5 sm:py-3 bg-gradient-to-r from-[#1A1A1A] to-[#141414] hover:from-[#E53A3A]/10 hover:to-[#D98C1F]/10 rounded-xl transition-all duration-300 border border-[#424242]/40 hover:border-[#E53A3A]/60 hover:shadow-[0_0_20px_rgba(229,58,58,0.15)]",children:[e.jsx(R,{size:"sm",userTier:b,isOnTrial:N,className:"flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-base sm:text-lg font-bold bg-gradient-to-r from-[#F5F5F5] to-[#CFCFCF] group-hover:from-[#FF6B6B] group-hover:to-[#FFAB40] bg-clip-text text-transparent transition-all duration-300",children:"HQ"}),e.jsx("span",{className:"text-[10px] sm:text-xs text-neutral-500 group-hover:text-neutral-400 transition-colors",children:"Command Center"})]})]}):e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-text-primary flex-1",children:"Conversations"}),e.jsx("button",{onClick:m,className:"lg:hidden btn-icon p-2.5 sm:p-3 text-text-muted hover:text-text-primary active:scale-95 min-h-[44px] min-w-[44px] flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),f&&e.jsx("div",{className:"px-3 sm:px-4 lg:px-6 pt-4 pb-0",children:e.jsxs("button",{onClick:f,className:"w-full px-4 py-3 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] md:hover:from-[#D42A2A] md:hover:to-[#C87A1A] text-white font-medium rounded-lg transition-all shadow-lg md:hover:shadow-xl active:scale-95 flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Add Game"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-3 sm:px-4 lg:px-6 pt-4 pb-3 sm:pb-4 lg:pb-6",style:{minHeight:0,maxHeight:"100%"},children:e.jsxs("div",{className:"space-y-4",children:[A.map(t=>{const r=t.isGameHub||t.id==="game-hub"||t.title==="Game Hub",n=t.isUnreleased||!1,l=!r&&!n&&t.gameTitle;(l||n)&&!t.coverUrl&&console.log("ðŸ–¼ï¸ [Sidebar] Missing coverUrl for:",t.title,"gameTitle:",t.gameTitle,"isUnreleased:",n);let o="",p="text-text-primary";return r?(o="border-l-2 border-gradient-to-b from-[#FF4D4D] to-[#FFAB40]",p="bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] bg-clip-text text-transparent"):n?(o="border-l-2 border-yellow-500",p="text-yellow-400"):l&&(o="border-l-2 border-orange-500",p="text-orange-400"),e.jsx("div",{className:`conversation-tab cursor-pointer transition-all duration-300 relative ${(d==null?void 0:d.id)===t.id?"conversation-tab-active":""} ${o}`,onClick:()=>g(t.id),onContextMenu:a=>G(a,t.id),onMouseDown:a=>C(a,t.id),onMouseUp:F,onMouseLeave:F,onTouchStart:a=>C(a,t.id),onTouchEnd:F,style:{zIndex:1},children:e.jsxs("div",{className:"flex p-3",children:[(l||n)&&t.coverUrl&&e.jsx("div",{className:"flex-shrink-0 mr-3",children:e.jsx("img",{src:t.coverUrl,alt:t.title,className:"w-14 h-[80px] object-cover rounded shadow-md",loading:"lazy",onError:a=>{a.target.style.display="none"}})}),e.jsxs("div",{className:`flex-1 min-w-0 flex flex-col ${(l||n)&&t.coverUrl?"justify-center":""}`,children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium truncate flex-1 min-w-0 ${p}`,children:t.title}),t.isPinned&&e.jsx("svg",{className:"w-3 h-3 text-primary-dark flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})})]}),n&&e.jsx("span",{className:"self-start px-1.5 py-0.5 bg-yellow-500/20 border border-yellow-500/40 rounded text-[10px] text-yellow-400 font-medium",children:"UPCOMING"})]}),l&&t.gameProgress!==void 0&&t.gameProgress>0&&e.jsxs("div",{className:"mt-1.5 flex items-center gap-1.5",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-surface-light/30 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#D98C1F] to-[#FFB366] rounded-full transition-all duration-300",style:{width:`${Math.min(100,t.gameProgress)}%`}})}),e.jsxs("span",{className:"text-[10px] text-[#D98C1F] font-medium min-w-[28px] text-right",children:[t.gameProgress,"%"]})]}),e.jsxs("p",{className:"text-xs text-text-muted mt-1.5",children:[t.messages.filter(a=>a.role==="assistant").length," messages"]}),e.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:new Date(t.updatedAt).toLocaleDateString()})]}),!r&&e.jsx("button",{onClick:a=>{a.stopPropagation(),u(t.id)},className:"flex-shrink-0 opacity-0 group-hover:opacity-100 p-2 text-text-muted hover:text-red-400 transition-all duration-200 rounded-lg hover:bg-red-500/10 active:scale-95 ml-2",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},t.id)}),A.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary/20 to-secondary/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),e.jsx("p",{className:"text-text-muted text-lg",children:"No conversations yet"}),e.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Create your first conversation to get started"})]})]})})]})}),e.jsx(U,{isOpen:s.isOpen,position:s.position,onClose:v,onDelete:D,onPin:z,onUnpin:T,onClearConversation:W,canDelete:s.conversationId?!((I=i[s.conversationId])!=null&&I.isGameHub):!0,canPin:s.conversationId?!((H=i[s.conversationId])!=null&&H.isGameHub):!0,isPinned:s.conversationId?(P=i[s.conversationId])==null?void 0:P.isPinned:!1,isEverythingElse:s.conversationId?((B=i[s.conversationId])==null?void 0:B.isGameHub)===!0:!1})]})};export{$ as S};
