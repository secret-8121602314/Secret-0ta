var ke=Object.defineProperty;var Ce=(t,l,r)=>l in t?ke(t,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[l]=r;var ae=(t,l,r)=>Ce(t,typeof l!="symbol"?l+"":l,r);import{R as Ae,j as e,r as i,M as ce}from"./react-vendor-D37MhRM4.js";import{i as le,j as K,k as X,l as Ee,m as De}from"./services-CG-I9TKt.js";import{n as W}from"./chat-services-B4SKm1z2.js";import{r as me}from"./markdown-vendor-BDhdEczt.js";function ne(t){const l=t.startsWith("/")?t.slice(1):t,r="/";return`${r.endsWith("/")?r:`${r}/`}${l}`}const Se=({isManualMode:t,onToggle:l,isConnected:r=!1})=>{const o=t?"Manual review is ON (paused). Click to resume auto-sending screenshots.":"Auto-sending is ON. Click to pause and review screenshots manually.";return r?e.jsx("button",{type:"button",onClick:l,className:`w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-gradient-to-r from-[#2E2E2E]/90 to-[#1C1C1C]/90 flex items-center justify-center transition-all duration-300 hover:scale-105 ${t?"text-yellow-400":"text-emerald-400"}`,"aria-pressed":t,"aria-label":t?"Resume auto-sending screenshots":"Pause and review screenshots",title:o,children:t?e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}):e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})}):null},Be=Ae.memo(Se),Le=({isConnected:t,isProcessing:l,isManualUploadMode:r,onRequestConnect:o,usage:c})=>{const[g,h]=i.useState("single"),[u,f]=i.useState(!1),v=i.useRef(null),F=i.useRef(null),a=i.useRef(null),[d,y]=i.useState(!1),m=(c==null?void 0:c.tier)==="pro"||(c==null?void 0:c.tier)==="vanguard_pro",b=(c==null?void 0:c.tier)==="free";i.useEffect(()=>{const p=localStorage.getItem("otakon_screenshot_mode");p==="single"||p==="multi"&&m?h(p):p==="multi"&&!m&&(h("single"),localStorage.setItem("otakon_screenshot_mode","single")),y(!1)},[m]);const s=p=>{p==="multi"&&!m||(h(p),localStorage.setItem("otakon_screenshot_mode",p),f(!1))};i.useEffect(()=>{const p=k=>{v.current&&(v.current.contains(k.target)||f(!1))};return u&&document.addEventListener("mousedown",p,{passive:!0}),()=>document.removeEventListener("mousedown",p)},[u]);const A=p=>{f(!0)},E=p=>{if(p.preventDefault(),p.stopPropagation(),!t){o==null||o();return}A()},H=p=>{if(p.button===2){if(p.preventDefault(),p.stopPropagation(),!t){o==null||o();return}A()}},j=()=>{a.current&&window.clearTimeout(a.current),a.current=window.setTimeout(()=>{if(!t){o==null||o();return}A()},1750)},w=()=>{a.current&&(window.clearTimeout(a.current),a.current=null)},I=async()=>{if(!t){o==null||o();return}if(l||g==="multi"&&!m)return;const k={type:"screenshot_request",mode:g,processImmediate:r?!1:g==="single"};g==="multi"&&(k.count=5),typeof le=="function"&&le(k)},M=()=>{if(!m){f(!1);return}s("multi")};return e.jsxs("div",{ref:v,className:"relative",children:[e.jsx("button",{ref:F,type:"button",onClick:I,onContextMenu:E,onMouseDown:H,onTouchStart:j,onTouchEnd:w,onTouchCancel:w,"aria-disabled":!t||l,className:`${t?"text-emerald-400":"text-[#8A8A8A]"} w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-gradient-to-r from-[#2E2E2E]/90 to-[#1C1C1C]/90 flex items-center justify-center transition-all duration-300 ${t?"hover:scale-105":"opacity-70 cursor-pointer hover:opacity-90"} ${l?"animate-pulse":""}`,title:t?"Screenshot (right-click/long-press to change mode)":"Connect your PC to enable screenshots",children:g==="single"?e.jsxs("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"12",rx:"2"}),e.jsx("path",{d:"M8 20h8"}),e.jsx("path",{d:"M7 7h3M7 10h3M14 7h3"}),e.jsx("path",{d:"M4 3v4M4 3h4"})]}):e.jsxs("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("rect",{x:"4",y:"5",width:"14",height:"9",rx:"2"}),e.jsx("rect",{x:"6",y:"10",width:"14",height:"9",rx:"2"}),e.jsx("path",{d:"M10 22h6"})]})}),d&&t&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-3 top-full text-xs text-[#CFCFCF] bg-[#101010]/95 border border-[#424242]/60 rounded-lg px-3 py-2 shadow-lg whitespace-nowrap z-50",children:e.jsx("button",{type:"button",onClick:()=>{y(!1),localStorage.setItem("otakon_screenshot_hint_seen","1")},className:"w-full h-full",children:"Press & hold (1.75s) or right-click to change mode"})}),u&&t&&e.jsxs("div",{className:"absolute bottom-full right-0 mb-3 bg-[#101010]/98 border border-[#424242]/60 rounded-xl shadow-2xl min-w-[200px] overflow-hidden z-[9999] backdrop-blur-md",children:[e.jsxs("button",{onClick:()=>s("single"),className:`w-full text-left px-4 py-3 hover:bg-[#2E2E2E]/60 transition-colors ${g==="single"?"text-emerald-400":"text-[#CFCFCF]"}`,children:["ğŸ“¸ Single Shot ",g==="single"?"âœ“":""]}),e.jsx("button",{onClick:M,className:`w-full text-left px-4 py-3 transition-all duration-200 ${m?`hover:bg-[#2E2E2E]/60 ${g==="multi"?"text-emerald-400":"text-[#CFCFCF]"}`:"text-[#666666] cursor-not-allowed opacity-60"}`,disabled:!m,children:m?e.jsxs(e.Fragment,{children:["ğŸ“¸ Multi Shot (5) ",g==="multi"?"âœ“":""]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"ğŸ”’ Multi Shot (5)"}),e.jsx("span",{className:"text-xs bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] text-white px-2 py-1 rounded-full",children:"PRO"})]})}),b&&e.jsx("div",{className:"px-4 py-2 text-xs text-[#999999] border-t border-[#424242]/40",children:"Upgrade to Pro for batch screenshots"})]})]})},oe=({className:t})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),xe=({className:t})=>{const[l,r]=i.useState(ne("/images/AvatarAI.png")),o=()=>{r(ne("/images/mascot/11.png"))};return e.jsx("img",{src:l,alt:"AI Avatar",className:`${t} rounded-full object-cover`,"aria-label":"AI Avatar",onError:o})},Me=({variant:t="dots",showText:l=!0,className:r=""})=>t==="dots"?e.jsxs("div",{className:`flex items-center gap-2 py-2 px-3 ${r}`,children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-[#FFAB40] rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-[#FFAB40] rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-[#FFAB40] rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l&&e.jsx("span",{className:"text-sm text-[#FFAB40] font-medium",children:"AI is thinking..."})]}):t==="skeleton"?e.jsxs("div",{className:`flex flex-col gap-3 py-3 px-4 ${r}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] rounded-full animate-pulse"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 bg-gradient-to-r from-[#FF4D4D]/20 to-[#FFAB40]/20 rounded animate-pulse",style:{width:"60%"}}),e.jsx("div",{className:"h-3 bg-gradient-to-r from-[#FFAB40]/20 to-[#5CBB7B]/20 rounded animate-pulse",style:{width:"80%"}})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gradient-to-r from-[#5CBB7B]/20 to-[#FF4D4D]/20 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gradient-to-r from-[#FF4D4D]/20 to-[#FFAB40]/20 rounded animate-pulse",style:{width:"70%"}}),e.jsx("div",{className:"h-4 bg-gradient-to-r from-[#FFAB40]/20 to-[#5CBB7B]/20 rounded animate-pulse",style:{width:"90%"}})]}),l&&e.jsx("span",{className:"text-sm text-[#A3A3A3] font-medium",children:"AI is thinking..."})]}):t==="wave"?e.jsxs("div",{className:`flex items-center gap-3 py-3 px-4 ${r}`,children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-1 h-4 bg-[#FF4D4D] rounded-full animate-pulse",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-1 h-4 bg-[#FFAB40] rounded-full animate-pulse",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-1 h-4 bg-[#5CBB7B] rounded-full animate-pulse",style:{animationDelay:"300ms"}}),e.jsx("div",{className:"w-1 h-4 bg-[#FF4D4D] rounded-full animate-pulse",style:{animationDelay:"450ms"}})]}),l&&e.jsx("span",{className:"text-sm text-[#A3A3A3] font-medium",children:"AI is thinking..."})]}):t==="circular"?e.jsxs("div",{className:`flex items-center gap-3 py-3 px-4 ${r}`,children:[e.jsxs("div",{className:"relative w-8 h-8",children:[e.jsx("div",{className:"absolute inset-0 w-8 h-8 border-2 border-[#424242]/30 rounded-full"}),e.jsx("div",{className:"absolute inset-0 w-8 h-8 border-2 border-transparent border-t-[#E53A3A] border-r-[#D98C1F] border-b-transparent rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] rounded-full animate-pulse"})})]}),l&&e.jsx("span",{className:"text-sm text-[#A3A3A3] font-medium",children:"AI is thinking..."})]}):null,Ie=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:t,"aria-hidden":"true",children:e.jsx("path",{d:"M12 4L4 12h5v8h6v-8h5L12 4z"})});class Te extends i.Component{constructor(r){super(r);ae(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,o){console.error("ğŸš¨ [ErrorBoundary] Caught error:",r),console.error("ğŸš¨ [ErrorBoundary] Error info:",o),this.setState({error:r,errorInfo:o})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#111111] to-[#0A0A0A] flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-[#1C1C1C] border border-[#424242] rounded-xl p-6 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"âš ï¸"}),e.jsx("h1",{className:"text-2xl font-bold text-[#F5F5F5] mb-2",children:"Something Went Wrong"}),e.jsx("p",{className:"text-[#CFCFCF] mb-4",children:"We encountered an unexpected error. Don't worry, your data is safe."}),this.state.error&&e.jsxs("div",{className:"bg-[#2E2E2E] rounded-lg p-4 mb-4 text-left",children:[e.jsx("p",{className:"text-xs font-mono text-[#FF4D4D] mb-2",children:this.state.error.toString()}),this.state.errorInfo&&e.jsxs("details",{className:"text-xs text-[#A3A3A3]",children:[e.jsx("summary",{className:"cursor-pointer hover:text-[#CFCFCF] transition-colors",children:"Error Details"}),e.jsx("pre",{className:"mt-2 overflow-auto max-h-40",children:this.state.errorInfo.componentStack})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:this.handleReset,className:"flex-1 px-4 py-2 bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] text-white rounded-lg font-semibold hover:scale-105 transition-transform",children:"Try Again"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"flex-1 px-4 py-2 bg-[#2E2E2E] text-[#CFCFCF] rounded-lg font-semibold hover:bg-[#424242] transition-colors",children:"Reload Page"})]})]})}):this.props.children}}const $e=()=>{const[t,l]=i.useState(!1),[r,o]=i.useState(!1);i.useEffect(()=>{const h=()=>l(!0),u=()=>{l(!1),o(!1)},f=()=>o(!0),v=()=>o(!1);return window.addEventListener("otakon:ttsStarted",h),window.addEventListener("otakon:ttsStopped",u),window.addEventListener("otakon:ttsPaused",f),window.addEventListener("otakon:ttsResumed",v),()=>{window.removeEventListener("otakon:ttsStarted",h),window.removeEventListener("otakon:ttsStopped",u),window.removeEventListener("otakon:ttsPaused",f),window.removeEventListener("otakon:ttsResumed",v)}},[]);const c=()=>{r?K.resume():K.pause()},g=async()=>{await K.restart()};return t?e.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t border-[#424242]/30",children:[e.jsx("button",{onClick:c,className:"flex items-center justify-center gap-1.5 px-3 py-1.5 bg-[#2E2E2E] hover:bg-[#3E3E3E] border border-[#424242] text-[#FFAB40] text-xs font-medium rounded-lg transition-all duration-200",title:r?"Resume":"Pause",children:r?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})}),e.jsx("span",{children:"Resume"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}),e.jsx("span",{children:"Pause"})]})}),e.jsxs("button",{onClick:g,className:"flex items-center justify-center gap-1.5 px-3 py-1.5 bg-[#2E2E2E] hover:bg-[#3E3E3E] border border-[#424242] text-[#FFAB40] text-xs font-medium rounded-lg transition-all duration-200",title:"Restart from beginning",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:"Restart"})]})]}):null},He=({prompts:t,onPromptClick:l,isLoading:r,conversationId:o=""})=>{const[c,g]=i.useState(!1),[h,u]=i.useState(!0),[f,v]=i.useState(new Set),a=(o==="game-hub"||o==="everything-else")&&t.length===W.length&&t.every((m,b)=>m===W[b]),d=a?W:t;i.useEffect(()=>{const m=window.matchMedia("(max-width: 640px)"),b=()=>{g(m.matches),u(!0)};return b(),m.addEventListener("change",b),()=>m.removeEventListener("change",b)},[]),i.useEffect(()=>{if(a){const m=new Set(W.filter(b=>X.isPromptUsed(b)));v(m)}},[a,d]);const y=m=>{a&&(X.markPromptAsUsed(m),v(b=>new Set([...b,m]))),l(m)};return r||d.length===0||a&&X.areAllPromptsUsed(W)?null:e.jsxs("div",{className:"pt-3 animate-fade-in",children:[c&&a&&e.jsxs("button",{type:"button","aria-expanded":h,onClick:()=>u(m=>!m),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg border border-[#424242]/40 bg-[#1C1C1C]/60 text-[#E5E5E5] text-sm font-medium mb-2",children:[e.jsx("span",{children:"Gaming News Suggestions"}),e.jsx("svg",{className:`w-4 h-4 transition-transform ${h?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.25 8.29a.75.75 0 01-.02-1.08z",clipRule:"evenodd"})})]}),(!c||h)&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:d.map((m,b)=>{const s=a&&f.has(m);return e.jsx("button",{onClick:()=>!s&&y(m),disabled:s,className:`text-left p-3 sm:p-4 border rounded-lg sm:rounded-xl transition-all duration-200 backdrop-blur-sm ${s?"bg-[#2A2A2A]/60 border-[#555555]/30 text-[#888888] cursor-not-allowed opacity-70":"bg-[#1C1C1C]/60 border-[#424242]/40 text-[#CFCFCF] hover:bg-[#E53A3A]/20 hover:border-[#E53A3A]/60 hover:scale-[1.02] active:scale-95"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:`font-medium text-xs sm:text-sm leading-relaxed flex-1 ${s?"text-[#888888]":"text-[#CFCFCF]"}`,children:m}),s&&e.jsx("span",{className:"text-[#5CBB7B] text-sm flex-shrink-0","aria-label":"Used",children:"âœ“"})]})},b)})})]})},ze=({isActive:t,onClick:l,disabled:r=!1})=>{const o=t;return e.jsxs("div",{className:"inline-flex items-center bg-[#1A1A1A] rounded-full p-0.5 sm:p-1 border border-[#333] shadow-lg",children:[e.jsx("button",{onClick:o?l:void 0,disabled:r||!o,className:`
          relative px-2 py-1 sm:px-4 sm:py-2 text-[10px] sm:text-xs font-semibold rounded-full transition-all duration-300 ease-out whitespace-nowrap min-w-[48px] sm:min-w-[72px]
          ${o?"text-[#888] hover:text-[#aaa] bg-transparent":"bg-gradient-to-r from-[#3B82F6] to-[#2563EB] text-white shadow-[0_2px_8px_rgba(59,130,246,0.4)]"}
          ${r?"opacity-50 cursor-not-allowed":"cursor-pointer active:scale-95"}
        `,children:e.jsxs("span",{className:"flex items-center justify-center gap-1 sm:gap-1.5",children:[e.jsx("svg",{className:"w-2.5 h-2.5 sm:w-3 sm:h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("span",{className:"hidden sm:inline",children:"Plan"})]})}),e.jsx("button",{onClick:o?void 0:l,disabled:r||o,className:`
          relative px-2 py-1 sm:px-4 sm:py-2 text-[10px] sm:text-xs font-semibold rounded-full transition-all duration-300 ease-out whitespace-nowrap min-w-[48px] sm:min-w-[72px]
          ${o?"bg-gradient-to-r from-[#FF4D4D] to-[#EF4444] text-white shadow-[0_2px_8px_rgba(239,68,68,0.4)]":"text-[#888] hover:text-[#aaa] bg-transparent"}
          ${r?"opacity-50 cursor-not-allowed":"cursor-pointer active:scale-95"}
        `,children:e.jsxs("span",{className:"flex items-center justify-center gap-1 sm:gap-1.5",children:[e.jsxs("svg",{className:"w-2.5 h-2.5 sm:w-3 sm:h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),e.jsx("span",{className:"hidden sm:inline",children:"Play"})]})})]})},ie={story:{accent:"#A855F7",accentHover:"#C084FC",bgTint:"rgba(168, 85, 247, 0.05)",borderTint:"rgba(168, 85, 247, 0.2)",icon:"ğŸ“–"},strategies:{accent:"#3B82F6",accentHover:"#60A5FA",bgTint:"rgba(59, 130, 246, 0.05)",borderTint:"rgba(59, 130, 246, 0.2)",icon:"ğŸ¯"},tips:{accent:"#22C55E",accentHover:"#4ADE80",bgTint:"rgba(34, 197, 94, 0.05)",borderTint:"rgba(34, 197, 94, 0.2)",icon:"ğŸ’¡"},walkthrough:{accent:"#F97316",accentHover:"#FB923C",bgTint:"rgba(249, 115, 22, 0.05)",borderTint:"rgba(249, 115, 22, 0.2)",icon:"ğŸ—ºï¸"},items:{accent:"#EAB308",accentHover:"#FACC15",bgTint:"rgba(234, 179, 8, 0.05)",borderTint:"rgba(234, 179, 8, 0.2)",icon:"ğŸ’"},characters:{accent:"#EF4444",accentHover:"#F87171",bgTint:"rgba(239, 68, 68, 0.05)",borderTint:"rgba(239, 68, 68, 0.2)",icon:"ğŸ‘¤"},chat:{accent:"#6B7280",accentHover:"#9CA3AF",bgTint:"rgba(107, 114, 128, 0.05)",borderTint:"rgba(107, 114, 128, 0.2)",icon:"ğŸ’¬"}},B=t=>{const l=(t==null?void 0:t.toLowerCase())||"chat";return ie[l]||ie.chat},Pe=({subtabs:t=[],activeTabId:l,onTabClick:r,isLoading:o=!1,onFeedback:c})=>{var b;const[g,h]=i.useState(l||((b=t[0])==null?void 0:b.id)||""),[u,f]=i.useState(!1),[v,F]=i.useState(!1),a=l||g,d=t.find(s=>s.id===a);console.log("ğŸ¨ [SubTabs] Rendering:",{subtabCount:t.length,statuses:t.map(s=>({title:s.title,status:s.status,hasContent:!!s.content})),isExpanded:u,hasUserInteracted:v,activeTabTitle:d==null?void 0:d.title,activeTabStatus:d==null?void 0:d.status,activeTabHasContent:!!(d!=null&&d.content)}),i.useEffect(()=>{if(v)return;const s=t.every(j=>j.status==="loading"),A=t.some(j=>j.status==="loaded"),E=t.every(j=>j.status==="loaded"),H=t.some(j=>j.status==="loaded"&&j.content&&j.content.trim().length>0&&j.content.trim()!=="Loading...");console.log("ğŸ“‚ [SubTabs] useEffect triggered:",{allLoading:s,anyLoaded:A,allLoaded:E,hasLoadedContent:H,isExpanded:u,hasUserInteracted:v,subtabStatuses:t.map(j=>({title:j.title,status:j.status})),subtabContentLengths:t.map(j=>{var w;return{title:j.title,length:((w=j.content)==null?void 0:w.length)||0}})}),s&&u&&f(!1),A&&!u&&f(!0),E&&!u&&t.length>0&&f(!0)},[t,u,v]);const y=s=>{h(s),r==null||r(s)},m=()=>{f(!u),F(!0)};return!t||t.length===0?null:e.jsxs("div",{className:"mb-4 relative",children:[e.jsxs("button",{onClick:m,className:"w-full flex items-center justify-between mb-2 py-2 px-3 rounded-lg bg-[#1C1C1C]/50 hover:bg-[#1C1C1C] border border-[#424242]/30 hover:border-[#424242]/60 transition-all duration-200 relative z-10",children:[e.jsx("div",{className:"text-xs font-semibold text-[#A3A3A3] uppercase tracking-wider",children:"Lore & Insights"}),e.jsx("svg",{className:`w-4 h-4 text-[#A3A3A3] transition-transform duration-200 ${u?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),u&&e.jsx("div",{className:"absolute bottom-full left-0 right-0 mb-2 z-50 animate-fade-in",children:e.jsxs("div",{className:"bg-[#1C1C1C]/95 backdrop-blur-md border border-[#424242]/60 rounded-xl shadow-2xl",children:[e.jsx("div",{className:"flex items-center gap-2 p-2 sm:p-3 border-b border-[#424242]/40",children:e.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2 flex-1",children:t.map(s=>e.jsx("button",{onClick:()=>y(s.id),className:`
                    px-3 py-2 text-xs font-medium rounded-lg transition-all duration-200 whitespace-nowrap
                    ${a===s.id?"bg-[#FF4D4D] text-white shadow-lg":"bg-[#2E2E2E]/60 text-[#A3A3A3] hover:bg-[#424242]/60 hover:text-[#F5F5F5]"}
                    ${s.isNew?"ring-2 ring-[#FF4D4D]/50":""}
                  `,disabled:o,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.isNew&&e.jsx("div",{className:"w-2 h-2 bg-[#FF4D4D] rounded-full animate-pulse"}),e.jsx("span",{children:s.title}),s.status==="loading"&&e.jsx("div",{className:"w-3 h-3 border border-current border-t-transparent rounded-full animate-spin"}),s.status==="error"&&e.jsx("div",{className:"w-3 h-3 text-red-400",children:"âš "})]})},s.id))})}),d&&e.jsx("div",{className:"p-4 max-h-64 overflow-y-auto transition-all duration-300 rounded-b-xl",style:{backgroundColor:B(d.type).bgTint,borderTop:`1px solid ${B(d.type).borderTint}`},children:d.status==="loading"||!d.content&&o?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-3 text-[#A3A3A3]",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:B(d.type).accent,borderTopColor:"transparent"}}),e.jsxs("span",{children:["Loading ",d.title,"..."]})]})}):d.status==="error"?e.jsxs("div",{className:"text-center py-8 text-[#A3A3A3]",children:[e.jsx("div",{className:"text-4xl mb-2",children:"âš ï¸"}),e.jsxs("p",{children:["Failed to load ",d.title," content"]}),e.jsx("p",{className:"text-sm mt-1",children:"Please try again later"})]}):d.content?e.jsxs("div",{className:"prose prose-invert prose-sm max-w-none",children:[e.jsx(ce,{remarkPlugins:[me],components:{h1:({children:s})=>e.jsx("h1",{className:"text-lg font-bold text-[#F5F5F5] mb-3",children:s}),h2:({children:s})=>e.jsx("h2",{className:"text-base font-semibold text-[#F5F5F5] mb-2",children:s}),h3:({children:s})=>e.jsx("h3",{className:"text-sm font-semibold text-[#F5F5F5] mb-2",children:s}),p:({children:s})=>e.jsx("p",{className:"text-[#CFCFCF] leading-relaxed mb-2",children:s}),ul:({children:s})=>e.jsx("ul",{className:"list-disc list-inside text-[#CFCFCF] mb-2 space-y-1",children:s}),ol:({children:s})=>e.jsx("ol",{className:"list-decimal list-inside text-[#CFCFCF] mb-2 space-y-1",children:s}),li:({children:s})=>e.jsx("li",{className:"text-[#CFCFCF]",children:s}),strong:({children:s})=>e.jsx("strong",{className:"font-semibold text-[#F5F5F5]",children:s}),em:({children:s})=>e.jsx("em",{className:"italic text-[#E0E0E0]",children:s}),code:({children:s})=>e.jsx("code",{className:"px-1 py-0.5 rounded text-xs font-mono",style:{backgroundColor:"#2E2E2E",color:B(d.type).accent},children:s}),pre:({children:s})=>e.jsx("pre",{className:"bg-[#1C1C1C] border border-[#424442] rounded-lg p-3 overflow-x-auto",children:s}),blockquote:({children:s})=>e.jsx("blockquote",{className:"pl-4 italic text-[#B0B0B0] my-2",style:{borderLeft:`4px solid ${B(d.type).accent}`},children:s}),a:({href:s,children:A})=>e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"underline transition-colors",style:{color:B(d.type).accent},onMouseEnter:E=>E.currentTarget.style.color=B(d.type).accentHover,onMouseLeave:E=>E.currentTarget.style.color=B(d.type).accent,children:A})},children:d.content}),c&&e.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-3 border-t border-[#424242]/50",children:[e.jsx("span",{className:"text-xs text-[#A3A3A3] mr-2",children:"Was this helpful?"}),e.jsx("button",{onClick:()=>c(d.id,"up"),className:"p-1.5 rounded-lg text-[#A3A3A3] hover:text-green-400 hover:bg-green-400/10 transition-colors",title:"Helpful",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})})}),e.jsx("button",{onClick:()=>c(d.id,"down"),className:"p-1.5 rounded-lg text-[#A3A3A3] hover:text-red-400 hover:bg-red-400/10 transition-colors",title:"Not helpful",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14H5.236a2 2 0 01-1.789-2.894l3.5-7A2 2 0 018.736 3h4.018c.163 0 .326.02.485.06L17 4m-7 10v5a2 2 0 002 2h.095c.5 0 .905-.405.905-.905 0-.714.211-1.412.608-2.006L17 13V4m-7 10h2m5-10h2a2 2 0 012 2v6a2 2 0 01-2 2h-2.5"})})})]})]}):e.jsx("div",{className:"text-center py-8 text-[#A3A3A3]",children:e.jsxs("p",{children:["No content available for ",d.title]})})})]})})]})},L=({className:t="",variant:l="text",animation:r="pulse"})=>{const o="bg-surface-light",c={text:"h-4 rounded",circular:"rounded-full",rectangular:"rounded-lg"},g={pulse:"animate-pulse",wave:"animate-shimmer bg-gradient-to-r from-surface-light via-surface to-surface-light bg-[length:200%_100%]",none:""};return e.jsx("div",{className:`
        ${o} 
        ${c[l]} 
        ${g[r]}
        ${t}
      `,"aria-label":"Loading..."})},Y=()=>e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx(L,{variant:"circular",className:"w-8 h-8 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(L,{className:"h-3 w-20"}),e.jsx(L,{className:"h-4 w-full"}),e.jsx(L,{className:"h-4 w-5/6"}),e.jsx(L,{className:"h-4 w-4/6"})]})]}),de=()=>e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"border-b border-surface-light p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(L,{className:"h-6 w-32"}),e.jsx(L,{variant:"circular",className:"w-8 h-8"})]})}),e.jsxs("div",{className:"flex-1 overflow-hidden p-4 space-y-4",children:[e.jsx(Y,{}),e.jsx(Y,{}),e.jsx(Y,{})]}),e.jsx("div",{className:"border-t border-surface-light p-4",children:e.jsx(L,{className:"h-12 w-full rounded-full"})})]}),We=()=>e.jsxs("div",{className:"mb-4 px-3 py-4 rounded-lg bg-[#1C1C1C]/60 border border-[#FF4D4D]/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-[#FF4D4D]",children:"âš ï¸"}),e.jsx("span",{className:"text-sm font-semibold text-[#FF4D4D]",children:"Failed to Load Insights"})]}),e.jsx("p",{className:"text-xs text-[#A3A3A3]",children:"There was an error loading game insights. You can still chat normally."})]}),_e=({message:t,suggestedPrompts:l,onSuggestedPromptClick:r,isLoading:o,conversationId:c,onDownloadImage:g,onDeleteQueuedMessage:h,onEditMessage:u,onFeedback:f})=>{const[v,F]=i.useState(null);return e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",onClick:()=>F(null),children:e.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[e.jsx("button",{onClick:()=>F(null),className:"absolute -top-3 -right-3 z-10 w-8 h-8 flex items-center justify-center bg-[#1C1C1C] border border-[#424242] rounded-full text-white hover:bg-[#2C2C2C] transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("img",{src:v,alt:"Full size",className:"max-w-full max-h-[85vh] rounded-lg shadow-2xl",onClick:a=>a.stopPropagation()}),e.jsx("div",{className:"flex justify-center mt-3",children:e.jsxs("button",{onClick:a=>{a.stopPropagation(),g(v,0)},className:"flex items-center gap-2 px-4 py-2 bg-[#FF4D4D] text-white text-sm font-medium rounded-lg hover:bg-[#E53A3A] transition-colors",children:[e.jsx(oe,{className:"w-4 h-4"}),"Download"]})})]})}),e.jsxs("div",{className:`flex flex-col ${t.role==="user"?"items-end":"items-start"}`,"data-message-id":t.id,children:[e.jsx("div",{className:`${t.role==="user"?"max-w-[80%] chat-message-user":"max-w-[95%] sm:max-w-[85%] chat-message-ai"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[t.role==="assistant"&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(xe,{className:"w-8 h-8 sm:w-9 sm:h-9 flex-shrink-0"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[t.imageUrl&&e.jsxs("div",{className:"chat-image-container mb-3",children:[e.jsxs("div",{className:"relative inline-block cursor-pointer group",onClick:()=>F(t.imageUrl||null),children:[e.jsx("img",{src:t.imageUrl,alt:"Uploaded",className:"w-64 h-48 sm:w-80 sm:h-60 object-cover rounded-lg border border-[#424242]/50 hover:border-[#FF4D4D]/50 transition-colors"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/0 group-hover:bg-black/30 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("p",{className:"text-[10px] text-[#A3A3A3]",children:"Click to view full size"}),e.jsxs("button",{onClick:a=>{a.stopPropagation(),g(t.imageUrl||"",0)},className:"flex items-center gap-1.5 px-2 py-1 text-[10px] text-[#FF4D4D] border border-[#FF4D4D]/50 rounded hover:bg-[#FF4D4D]/10 transition-colors",children:[e.jsx(oe,{className:"w-3 h-3"}),"Download"]})]})]}),e.jsx("div",{className:"text-[#F5F5F5] leading-relaxed",children:e.jsx(ce,{remarkPlugins:[me],components:{h1:({children:a})=>e.jsx("h1",{className:"text-lg font-bold text-[#F5F5F5] mb-3 mt-2",children:a}),h2:({children:a})=>e.jsx("h2",{className:"text-base font-semibold text-[#F5F5F5] mb-2 mt-2",children:a}),h3:({children:a})=>e.jsx("h3",{className:"text-sm font-semibold text-[#F5F5F5] mb-2 mt-2",children:a}),p:({children:a})=>e.jsx("p",{className:"text-[#CFCFCF] leading-relaxed mb-3",children:a}),ul:({children:a})=>e.jsx("ul",{className:"list-disc list-outside ml-5 text-[#CFCFCF] mb-3 space-y-1.5",children:a}),ol:({children:a})=>e.jsx("ol",{className:"list-decimal list-outside ml-5 text-[#CFCFCF] mb-3 space-y-1.5",children:a}),li:({children:a})=>e.jsx("li",{className:"text-[#CFCFCF] leading-relaxed",children:a}),strong:({children:a})=>e.jsx("strong",{className:"font-semibold text-[#F5F5F5]",children:a}),em:({children:a})=>e.jsx("em",{className:"italic text-[#E0E0E0]",children:a}),code:({children:a})=>e.jsx("code",{className:"bg-[#2E2E2E] text-[#FF4D4D] px-1.5 py-0.5 rounded text-xs font-mono",children:a}),pre:({children:a})=>e.jsx("pre",{className:"bg-[#1C1C1C] border border-[#424242] rounded-lg p-3 overflow-x-auto mb-3",children:a}),blockquote:({children:a})=>e.jsx("blockquote",{className:"border-l-4 border-[#FF4D4D] pl-4 italic text-[#B0B0B0] my-3",children:a}),a:({href:a,children:d})=>e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-[#FF4D4D] hover:text-[#FF6B6B] underline",children:d}),br:()=>e.jsx("br",{className:"my-1"})},children:t.content.replace(/\\\*/g,"*")})}),t.role==="assistant"&&e.jsx($e,{}),t.role==="assistant"&&l.length>0&&r&&!o&&e.jsx("div",{className:"mt-4",children:e.jsx(He,{prompts:l,onPromptClick:r,isLoading:o,conversationId:c})}),e.jsx("p",{className:"text-xs text-[#A3A3A3] mt-2",children:new Date(t.timestamp).toLocaleTimeString()}),t.id.startsWith("msg_pending_")&&h&&e.jsxs("button",{onClick:()=>h(t.id),className:"flex items-center gap-1 px-2 py-0.5 mt-2 text-xs text-[#FF4D4D] border border-[#FF4D4D]/50 rounded hover:bg-[#FF4D4D]/10 transition-colors",title:"Remove from queue",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remove"]})]})]})}),t.role==="user"&&!t.id.startsWith("msg_pending_")&&u&&e.jsx("button",{onClick:()=>{const a=t.content.replace(/\n\n_â³ Queued.*_$/,"");u(t.id,a)},className:"mt-1.5 p-1.5 text-[#666] hover:text-[#FF4D4D] hover:bg-[#FF4D4D]/10 rounded-md transition-colors",title:"Edit and resubmit",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),t.role==="assistant"&&f&&!o&&e.jsxs("div",{className:"flex items-center justify-center gap-1 mt-1.5 ml-11",children:[e.jsx("button",{onClick:()=>f(t.id,"up"),className:"p-1.5 text-[#666] hover:text-green-500 hover:bg-green-500/10 rounded-md transition-colors",title:"Good response",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})})}),e.jsx("button",{onClick:()=>f(t.id,"down"),className:"p-1.5 text-[#666] hover:text-red-500 hover:bg-red-500/10 rounded-md transition-colors",title:"Poor response",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14H5.236a2 2 0 01-1.789-2.894l3.5-7A2 2 0 018.736 3h4.018c.163 0 .326.02.485.06L17 4m-7 10v2a2 2 0 002 2h.095c.5 0 .905-.405.905-.905 0-.714.211-1.412.608-2.006L17 13V4m-7 10h2m5-10h2a2 2 0 012 2v6a2 2 0 01-2 2h-2.5"})})})]})]})]})},he=i.memo(_e,(t,l)=>t.message.id===l.message.id&&t.message.content===l.message.content&&t.message.timestamp===l.message.timestamp&&t.isLoading===l.isLoading&&t.suggestedPrompts.length===l.suggestedPrompts.length&&t.onDeleteQueuedMessage===l.onDeleteQueuedMessage&&t.onEditMessage===l.onEditMessage&&t.onFeedback===l.onFeedback);he.displayName="MemoizedChatMessage";const Ke=({conversation:t,onSendMessage:l,isLoading:r,isPCConnected:o=!1,onRequestConnect:c,userTier:g="free",onStop:h,isManualUploadMode:u=!1,onToggleManualUploadMode:f,suggestedPrompts:v=[],onSuggestedPromptClick:F,activeSession:a,onToggleActiveSession:d,initialMessage:y="",onMessageChange:m,queuedImage:b=null,onImageQueued:s,isSidebarOpen:A=!1,onDeleteQueuedMessage:E,onEditMessage:H,onFeedback:j})=>{const[w,I]=i.useState(y),[M,p]=i.useState(null),[k,_]=i.useState(null),[ue,J]=i.useState(!1),[G,z]=i.useState(!1),[T,ge]=i.useState([]),[Q,U]=i.useState(0),[P,R]=i.useState(()=>window.innerWidth>640),Z=i.useRef(null),V=i.useRef(null),$=i.useRef(null),O=i.useRef(null),pe=i.useRef(null),q=i.useRef(0),fe=()=>{var n;(n=Z.current)==null||n.scrollIntoView({behavior:"smooth"})},be=()=>{if(!t||!V.current)return;const n=t.messages,x=n.length;if(x>q.current){if(n[x-1].role==="assistant"){const C=V.current.querySelectorAll("[data-message-id]"),D=C[C.length-1];D&&D.scrollIntoView({behavior:"smooth",block:"start"})}else fe();q.current=x}},ee=()=>{const n=O.current;if(n){n.style.height="auto";const C=n.scrollHeight,D=Math.min(Math.max(C,44),120);n.style.height=`${D}px`}},je=n=>{const x=n.target.value;if(I(x),ee(),m==null||m(x),t&&x.startsWith("@")){const N=De.getAvailableTabNames(t);N.length>0?(ge(N),z(!0),U(0)):z(!1)}else z(!1)},te=n=>{var x;I(`@${n} `),z(!1),(x=O.current)==null||x.focus()},ve=n=>{if(G&&T.length>0){if(n.key==="ArrowDown"){n.preventDefault(),U(x=>x<T.length-1?x+1:0);return}else if(n.key==="ArrowUp"){n.preventDefault(),U(x=>x>0?x-1:T.length-1);return}else if(n.key==="Tab"||n.key==="Enter"&&G){n.preventDefault(),te(T[Q]);return}else if(n.key==="Escape"){n.preventDefault(),z(!1);return}}n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),se(n))};i.useEffect(()=>{be()},[t==null?void 0:t.messages]),i.useEffect(()=>{ee()},[w]),i.useEffect(()=>{y!==void 0&&y!==w&&I(y)},[y,w]),i.useEffect(()=>{b&&u&&(console.log("ğŸ“¸ [ChatInterface] Queued image received from WebSocket:",{queuedImageLength:b.length,queuedImagePreview:b.substring(0,50),currentImagePreview:k==null?void 0:k.substring(0,50),isManualUploadMode:u}),_(b),s==null||s())},[b,u,s]),i.useEffect(()=>{A&&P&&R(!1)},[A]);const se=n=>{if(n.preventDefault(),console.log("ğŸ“¤ [ChatInterface] Submit attempt:",{message:w.trim(),hasMessage:!!w.trim(),hasImageFile:!!M,hasImagePreview:!!k,shouldSubmit:!(!w.trim()&&!M)}),!w.trim()&&!M)return;t!=null&&t.isGameHub&&R(!1);const x=k||void 0;console.log("ğŸ“¤ [ChatInterface] Submitting:",{message:w,hasImage:!!x,imageUrl:(x==null?void 0:x.substring(0,50))+"..."}),l(w,x),I(""),p(null),_(null),$.current&&($.current.value="")},we=n=>{var N;const x=(N=n.target.files)==null?void 0:N[0];if(x){p(x);const C=new FileReader;C.onload=D=>{var re;const S=(re=D.target)==null?void 0:re.result;console.log("ğŸ“¸ [ChatInterface] Image preview created:",{hasResult:!!S,resultLength:S==null?void 0:S.length,resultStart:(S==null?void 0:S.substring(0,50))+"..."}),_(S)},C.readAsDataURL(x)}},Ne=()=>{p(null),_(null),$.current&&($.current.value="")},Fe=()=>{f==null||f()},ye=(n,x)=>{try{const N=document.createElement("a");N.href=n;const C=new Date().toISOString().slice(0,19).replace(/:/g,"-"),D=`otakon-screenshot-${x+1}-${C}.png`;N.download=D,document.body.appendChild(N),N.click(),document.body.removeChild(N)}catch(N){console.error("Failed to download image:",N),window.open(n,"_blank")}};return t?t?e.jsxs("div",{className:"h-full bg-background flex flex-col overflow-hidden",children:[e.jsxs("div",{ref:V,className:`flex-1 p-6 space-y-6 min-h-0 ${t.messages.length>0?"overflow-y-auto custom-scrollbar":"overflow-y-hidden"}`,children:[t.messages.length===0?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/images/mascot/4.png",alt:"Otagon Mascot",className:"w-32 h-32 sm:w-40 sm:h-40 md:w-48 md:h-48 object-contain aspect-square mx-auto mb-4",onError:n=>{const x=n.target;x.style.display="none"}}),e.jsxs("p",{className:"text-text-muted text-lg",children:["Start a conversation with ",e.jsx("span",{className:"bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] bg-clip-text text-transparent font-semibold",children:"Otagon"})]}),e.jsx("p",{className:"text-text-muted text-sm mt-2",children:"Ask me anything about gaming, strategies, or tips. You can also start uploading gameplay screenshots for help!"})]})}):t.messages.map(n=>e.jsx(he,{message:n,suggestedPrompts:n.role==="assistant"?v:[],onSuggestedPromptClick:F,isLoading:r,conversationId:t==null?void 0:t.id,onDownloadImage:ye,onDeleteQueuedMessage:E,onEditMessage:H,onFeedback:j},n.id)),r&&e.jsx("div",{className:"flex justify-start",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(xe,{className:"w-8 h-8 sm:w-9 sm:h-9 flex-shrink-0"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 py-2 sm:py-3",children:[e.jsx(Me,{variant:"dots",showText:!1}),h&&e.jsx("button",{onClick:h,className:"text-xs font-semibold px-2 sm:px-3 py-1 sm:py-1.5 rounded-full transition-all duration-200 bg-[#424242]/60 text-[#CFCFCF] hover:bg-[#424242] hover:text-[#F5F5F5] hover:scale-105","aria-label":"Stop generating response",children:"Stop"})]})})]})}),e.jsx("div",{ref:Z})]}),t&&!t.isGameHub&&!t.isUnreleased&&t.subtabs&&t.subtabs.length>0&&e.jsx("div",{className:"flex-shrink-0 px-3 pb-2",children:e.jsx(Te,{fallback:e.jsx(We,{}),children:e.jsx(Pe,{subtabs:t.subtabs,isLoading:r,onFeedback:j},`subtabs-${t.id}`)})}),(t==null?void 0:t.isGameHub)&&e.jsxs("div",{className:"flex-shrink-0 mx-3 pb-1.5 relative",children:[e.jsxs("button",{onClick:()=>R(!P),className:"w-full flex items-center justify-between mb-2 py-2 px-3 rounded-lg bg-[#1C1C1C]/50 hover:bg-[#1C1C1C] border border-[#424242]/30 hover:border-[#424242]/60 transition-all duration-200 relative z-10",children:[e.jsx("div",{className:`text-xs font-semibold uppercase tracking-wider transition-all duration-200 ${P?"bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] bg-clip-text text-transparent":"text-[#A3A3A3]"}`,children:"Latest Gaming News"}),e.jsx("svg",{className:`w-4 h-4 transition-all duration-200 ${P?"rotate-180 text-[#FF4D4D]":"text-[#A3A3A3]"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),P&&e.jsx("div",{className:"absolute bottom-full left-0 right-0 mb-2 z-50 animate-fade-in",children:e.jsx("div",{className:"grid grid-cols-2 gap-2 p-3 rounded-xl bg-[#1C1C1C]/95 backdrop-blur-md border border-[#424242]/60 shadow-2xl",children:[{text:"What's the latest gaming news?",shape:"âœ•"},{text:"Which games are releasing soon?",shape:"â– "},{text:"What are the latest game reviews?",shape:"â–²"},{text:"Show me the hottest new game trailers.",shape:"â—¯"}].map(n=>e.jsxs("button",{onClick:()=>{R(!1),F==null||F(n.text)},disabled:r,className:"group relative px-3 py-3 rounded-xl bg-gradient-to-br from-[#1C1C1C] to-[#0F0F0F] hover:from-[#252525] hover:to-[#1A1A1A] border border-[#424242]/30 hover:border-[#E53A3A]/50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-left overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#E53A3A]/10 to-[#FF6B35]/10 opacity-0 group-hover:opacity-100 transition-opacity duration-200"}),e.jsxs("div",{className:"relative flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsx("span",{className:"text-lg flex-shrink-0 text-[#E53A3A] font-bold leading-none",children:n.shape}),e.jsx("span",{className:"text-xs sm:text-sm text-[#E5E5E5] font-medium group-hover:text-white transition-colors leading-tight",children:n.text})]})]},n.text))})})]}),e.jsx("div",{className:"flex-shrink-0 bg-background/95 backdrop-blur-sm",children:e.jsx("div",{className:"mx-3 my-3 rounded-2xl p-px transition-all duration-300",style:{background:ue?"linear-gradient(135deg, #FF4D4D, #FFAB40)":"transparent"},children:e.jsxs("form",{onSubmit:se,className:"relative p-3 rounded-2xl bg-gradient-to-r from-[#1A1A1A] to-[#0F0F0F] animate-pulse-glow",style:{background:"linear-gradient(135deg, #1A1A1A 0%, #0F0F0F 100%)",boxShadow:"0 0 20px rgba(255, 77, 77, 0.3), 0 0 40px rgba(255, 171, 64, 0.2), 0 0 60px rgba(0, 0, 0, 0.1)"},children:[G&&T.length>0&&e.jsxs("div",{ref:pe,className:"absolute bottom-full mb-2 left-3 right-3 bg-[#1C1C1C] border border-[#424242] rounded-lg shadow-lg z-50 max-h-48 overflow-y-auto",children:[e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs text-[#A3A3A3] mb-2 px-2",children:"Select a subtab to update:"}),T.map((n,x)=>{var C;const N=(C=t==null?void 0:t.subtabs)==null?void 0:C.find(D=>D.id===n);return e.jsx("button",{type:"button",onClick:()=>te(n),className:`w-full text-left px-3 py-2 rounded transition-colors ${x===Q?"bg-[#E53A3A]/20 border border-[#E53A3A]/60":"hover:bg-[#2A2A2A] border border-transparent"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-[#E53A3A] font-mono text-sm",children:["@",n]}),N&&e.jsxs("span",{className:"text-[#888888] text-xs",children:["- ",N.title]})]})},n)})]}),e.jsx("div",{className:"px-3 py-2 border-t border-[#424242]/30 bg-[#1A1A1A]/50",children:e.jsx("div",{className:"text-xs text-[#888888]",children:"Use â†‘â†“ to navigate, Tab/Enter to select, Esc to cancel"})})]}),e.jsxs("div",{className:"relative mb-2",children:[k&&e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:k,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border border-[#424242]/40"}),e.jsx("button",{type:"button",onClick:Ne,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs hover:bg-red-600 transition-colors flex-shrink-0",children:"Ã—"})]}),e.jsxs("div",{className:"text-xs text-[#A3A3A3]",children:[e.jsx("p",{className:"font-semibold",children:"Image Ready"}),e.jsx("p",{children:"Add a message or send"})]})]}),e.jsx("textarea",{ref:O,value:w,onChange:je,onKeyDown:ve,onFocus:()=>J(!0),onBlur:()=>J(!1),placeholder:"Type your message...",className:"w-full px-4 sm:px-6 text-base text-[#F5F5F5] placeholder-[#A3A3A3] resize-none overflow-y-auto focus:outline-none disabled:opacity-60 bg-transparent border-0 rounded-xl",style:{minHeight:"44px",maxHeight:"120px",lineHeight:"44px",height:"44px",paddingTop:"10px",paddingBottom:"10px"},disabled:r,rows:1})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsxs("div",{className:"flex-1 flex items-center space-x-2 sm:space-x-3",children:[e.jsx("input",{type:"file",ref:$,onChange:we,accept:"image/*",className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>{var n;return(n=$.current)==null?void 0:n.click()},className:"w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-gradient-to-r from-[#2E2E2E]/90 to-[#1C1C1C]/90 flex items-center justify-center transition-all duration-300 hover:scale-105 text-text-muted hover:text-text-primary",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o&&e.jsxs(e.Fragment,{children:[e.jsx(Be,{isManualMode:u,onToggle:Fe,isConnected:o}),e.jsx(Le,{isConnected:o,isProcessing:r,isManualUploadMode:u,onRequestConnect:c,usage:{tier:g}})]})]}),t&&Ee.isGameTab(t)&&a&&(t.isUnreleased?e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-surface/50 rounded-lg border border-surface-light/20",children:[e.jsx("span",{className:"text-sm font-medium text-text-muted",children:"Discuss Mode"}),e.jsx("div",{className:"text-xs text-text-muted/60",children:"(No Playing mode until release)"})]}):d&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ze,{isActive:a.isActive&&a.currentGameId===t.id,onClick:d})})),e.jsx("button",{type:"submit",disabled:!w.trim()&&!M,"aria-label":"Send message",className:`flex items-center justify-center w-12 h-12 sm:w-14 sm:h-14 rounded-xl transition-all duration-300 disabled:cursor-not-allowed ${!w.trim()&&!M||r?"bg-[#2E2E2E]/15 text-[#A3A3A3]/25 scale-100":"bg-gradient-to-r from-[#FFAB40] to-[#FF8C00] text-[#181818] scale-100 md:hover:scale-105 md:hover:shadow-lg md:hover:shadow-[#FFAB40]/25 active:scale-95 font-semibold"}`,children:r?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):e.jsx(Ie,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]})]})})})]}):e.jsx(de,{}):e.jsx(de,{})},Xe=({progress:t,gameTitle:l,className:r="",showLabel:o=!0})=>{const c=Math.min(Math.max(t,0),100),g=h=>h===0?"Not Started":h<15?"Beginning":h<35?"Early Game":h<55?"Mid Game":h<75?"Late Game":h<90?"Endgame":h<100?"Almost Done":"Complete!";return e.jsxs("div",{className:`relative ${r}`,children:[o&&e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-[#D98C1F]",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-xs font-semibold text-white uppercase tracking-wider",children:"Player Progress"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] text-[#888888]",children:g(c)}),e.jsxs("span",{className:"text-xs font-bold text-[#D98C1F] min-w-[36px] text-right",children:[c,"%"]})]})]}),e.jsxs("div",{className:"relative h-3 bg-[#1A1A1A] rounded-full overflow-hidden border border-[#333333]/60 shadow-inner",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"repeating-linear-gradient(90deg, transparent, transparent 8px, rgba(255,255,255,0.03) 8px, rgba(255,255,255,0.03) 16px)"}}),e.jsx("div",{className:"absolute left-0 top-0 h-full rounded-full transition-all duration-700 ease-out",style:{width:`${c}%`,background:c>0?"linear-gradient(90deg, #D98C1F 0%, #E5A63D 50%, #FFB366 100%)":"transparent",boxShadow:c>0?"0 0 8px rgba(217, 140, 31, 0.3), inset 0 1px 0 rgba(255,255,255,0.15)":"none"}}),c>0&&e.jsx("div",{className:"absolute top-1/2 w-4 h-4 bg-white rounded-full shadow-lg border-2 border-[#D98C1F] transition-all duration-700 ease-out z-10",style:{left:`${Math.max(c,3)}%`,transform:"translateX(-50%) translateY(-50%)"},children:e.jsx("div",{className:"absolute inset-[-4px] bg-[#D98C1F]/15 rounded-full blur-sm"})}),[25,50,75].map(h=>e.jsx("div",{className:`absolute top-0 bottom-0 w-px transition-colors duration-300 ${c>=h?"bg-white/30":"bg-white/10"}`,style:{left:`${h}%`}},h))]}),c===0&&e.jsxs("p",{className:"text-[10px] text-[#666666] mt-1.5 italic flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Share screenshots to track your ",l||"game"," progress"]})]})};export{Ke as C,Te as E,Xe as G,ne as g};
