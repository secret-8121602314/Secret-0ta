{"version":3,"file":"auth-Dlzkn9Z_.js","sources":["../../src/lib/supabase.ts","../../src/components/auth/AuthCallback.tsx"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\nimport { Database } from '../types/database';\r\n\r\nconst supabaseUrl = (import.meta as any).env.VITE_SUPABASE_URL || 'https://qajcxgkqloumogioomiz.supabase.co';\r\nconst supabaseAnonKey = (import.meta as any).env.VITE_SUPABASE_ANON_KEY || 'sb_publishable_GoW6G_umt1lFF-KPbbm-Ow_D2PYxPLw';\r\n\r\nexport const supabase = createClient<Database>(supabaseUrl, supabaseAnonKey, {\r\n  auth: {\r\n    autoRefreshToken: true,\r\n    persistSession: true,\r\n    detectSessionInUrl: true\r\n  }\r\n});\r\n\r\n// Re-export Database type for convenience\r\nexport type { Database } from '../types/database';\r\n\r\n// Legacy Database types (kept for backward compatibility)\r\n// NOTE: Use generated types from src/types/database.ts instead\r\nexport interface LegacyDatabase {\r\n  public: {\r\n    Tables: {\r\n      users: {\r\n        Row: {\r\n          id: string;\r\n          auth_user_id: string;\r\n          email: string;\r\n          full_name: string | null;\r\n          avatar_url: string | null;\r\n          tier: 'free' | 'pro' | 'vanguard_pro';\r\n          has_profile_setup: boolean;\r\n          has_seen_splash_screens: boolean;\r\n          has_welcome_message: boolean;\r\n          is_new_user: boolean;\r\n          has_used_trial: boolean;\r\n          trial_started_at: string | null;\r\n          trial_expires_at: string | null;\r\n          last_activity: string;\r\n          preferences: Record<string, any>;\r\n          usage: Record<string, any>;\r\n          app_state: Record<string, any>;\r\n          profile_data: Record<string, any>;\r\n          onboarding_data: Record<string, any>;\r\n          behavior_data: Record<string, any>;\r\n          feedback_data: Record<string, any>;\r\n          usage_data: Record<string, any>;\r\n          created_at: string;\r\n          updated_at: string;\r\n          deleted_at: string | null;\r\n        };\r\n        Insert: {\r\n          id?: string;\r\n          auth_user_id: string;\r\n          email: string;\r\n          full_name?: string | null;\r\n          avatar_url?: string | null;\r\n          tier?: 'free' | 'pro' | 'vanguard_pro';\r\n          has_profile_setup?: boolean;\r\n          has_seen_splash_screens?: boolean;\r\n          has_welcome_message?: boolean;\r\n          is_new_user?: boolean;\r\n          has_used_trial?: boolean;\r\n          trial_started_at?: string | null;\r\n          trial_expires_at?: string | null;\r\n          last_activity?: string;\r\n          preferences?: Record<string, any>;\r\n          usage?: Record<string, any>;\r\n          app_state?: Record<string, any>;\r\n          profile_data?: Record<string, any>;\r\n          onboarding_data?: Record<string, any>;\r\n          behavior_data?: Record<string, any>;\r\n          feedback_data?: Record<string, any>;\r\n          usage_data?: Record<string, any>;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n          deleted_at?: string | null;\r\n        };\r\n        Update: {\r\n          id?: string;\r\n          auth_user_id?: string;\r\n          email?: string;\r\n          full_name?: string | null;\r\n          avatar_url?: string | null;\r\n          tier?: 'free' | 'pro' | 'vanguard_pro';\r\n          has_profile_setup?: boolean;\r\n          has_seen_splash_screens?: boolean;\r\n          has_welcome_message?: boolean;\r\n          is_new_user?: boolean;\r\n          has_used_trial?: boolean;\r\n          trial_started_at?: string | null;\r\n          trial_expires_at?: string | null;\r\n          last_activity?: string;\r\n          preferences?: Record<string, any>;\r\n          usage?: Record<string, any>;\r\n          app_state?: Record<string, any>;\r\n          profile_data?: Record<string, any>;\r\n          onboarding_data?: Record<string, any>;\r\n          behavior_data?: Record<string, any>;\r\n          feedback_data?: Record<string, any>;\r\n          usage_data?: Record<string, any>;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n          deleted_at?: string | null;\r\n        };\r\n      };\r\n      conversations: {\r\n        Row: {\r\n          id: string;\r\n          user_id: string;\r\n          game_id: string | null;\r\n          title: string;\r\n          messages: Record<string, any>[];\r\n          is_active: boolean;\r\n          created_at: string;\r\n          updated_at: string;\r\n        };\r\n        Insert: {\r\n          id: string;\r\n          user_id: string;\r\n          game_id?: string | null;\r\n          title: string;\r\n          messages?: Record<string, any>[];\r\n          is_active?: boolean;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n        Update: {\r\n          id?: string;\r\n          user_id?: string;\r\n          game_id?: string | null;\r\n          title?: string;\r\n          messages?: Record<string, any>[];\r\n          is_active?: boolean;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n      };\r\n      games: {\r\n        Row: {\r\n          id: string;\r\n          title: string;\r\n          description: string | null;\r\n          genre: string | null;\r\n          platform: string | null;\r\n          release_date: string | null;\r\n          rating: number | null;\r\n          image_url: string | null;\r\n          metadata: Record<string, any>;\r\n          created_at: string;\r\n          updated_at: string;\r\n        };\r\n        Insert: {\r\n          id: string;\r\n          title: string;\r\n          description?: string | null;\r\n          genre?: string | null;\r\n          platform?: string | null;\r\n          release_date?: string | null;\r\n          rating?: number | null;\r\n          image_url?: string | null;\r\n          metadata?: Record<string, any>;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n        Update: {\r\n          id?: string;\r\n          title?: string;\r\n          description?: string | null;\r\n          genre?: string | null;\r\n          platform?: string | null;\r\n          release_date?: string | null;\r\n          rating?: number | null;\r\n          image_url?: string | null;\r\n          metadata?: Record<string, any>;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n      };\r\n      waitlist: {\r\n        Row: {\r\n          id: string;\r\n          email: string;\r\n          source: string;\r\n          created_at: string;\r\n        };\r\n        Insert: {\r\n          id?: string;\r\n          email: string;\r\n          source?: string;\r\n          created_at?: string;\r\n        };\r\n        Update: {\r\n          id?: string;\r\n          email?: string;\r\n          source?: string;\r\n          created_at?: string;\r\n        };\r\n      };\r\n      user_usage: {\r\n        Row: {\r\n          id: string;\r\n          user_id: string;\r\n          text_count: number;\r\n          image_count: number;\r\n          text_limit: number;\r\n          image_limit: number;\r\n          total_requests: number;\r\n          last_reset: string;\r\n          created_at: string;\r\n          updated_at: string;\r\n        };\r\n        Insert: {\r\n          id?: string;\r\n          user_id: string;\r\n          text_count?: number;\r\n          image_count?: number;\r\n          text_limit?: number;\r\n          image_limit?: number;\r\n          total_requests?: number;\r\n          last_reset?: string;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n        Update: {\r\n          id?: string;\r\n          user_id?: string;\r\n          text_count?: number;\r\n          image_count?: number;\r\n          text_limit?: number;\r\n          image_limit?: number;\r\n          total_requests?: number;\r\n          last_reset?: string;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n      };\r\n    };\r\n    Functions: {\r\n      check_and_expire_trials: {\r\n        Args: Record<PropertyKey, never>;\r\n        Returns: undefined;\r\n      };\r\n      create_user_record: {\r\n        Args: Record<PropertyKey, never>;\r\n        Returns: undefined;\r\n      };\r\n      update_user_usage: {\r\n        Args: {\r\n          p_user_id: string;\r\n          p_text_count?: number;\r\n          p_image_count?: number;\r\n        };\r\n        Returns: undefined;\r\n      };\r\n      get_user_tier_limits: {\r\n        Args: {\r\n          p_user_id: string;\r\n        };\r\n        Returns: {\r\n          text_limit: number;\r\n          image_limit: number;\r\n        }[];\r\n      };\r\n      start_free_trial: {\r\n        Args: {\r\n          p_user_id: string;\r\n        };\r\n        Returns: boolean;\r\n      };\r\n      save_conversation: {\r\n        Args: {\r\n          p_conversation_id: string;\r\n          p_user_id: string;\r\n          p_title: string;\r\n          p_messages: Record<string, any>;\r\n          p_game_id?: string;\r\n        };\r\n        Returns: undefined;\r\n      };\r\n      load_conversations: {\r\n        Args: {\r\n          p_user_id: string;\r\n        };\r\n        Returns: {\r\n          id: string;\r\n          title: string;\r\n          messages: Record<string, any>;\r\n          game_id: string | null;\r\n          is_active: boolean;\r\n          created_at: string;\r\n          updated_at: string;\r\n        }[];\r\n      };\r\n      get_complete_user_data: {\r\n        Args: {\r\n          p_auth_user_id: string;\r\n        };\r\n        Returns: {\r\n          user_id: string;\r\n          email: string;\r\n          tier: string;\r\n          has_used_trial: boolean;\r\n          trial_expires_at: string | null;\r\n          text_count: number;\r\n          image_count: number;\r\n          text_limit: number;\r\n          image_limit: number;\r\n          preferences: Record<string, any>;\r\n          app_state: Record<string, any>;\r\n          profile_data: Record<string, any>;\r\n        }[];\r\n      };\r\n    };\r\n  };\r\n}\r\n","import React, { useEffect, useState, useRef } from 'react';\nimport { supabase } from '../../lib/supabase';\nimport { authService } from '../../services/authService';\n\ninterface AuthCallbackProps {\n  onAuthSuccess: () => void;\n  onAuthError: (error: string) => void;\n}\n\nconst AuthCallback: React.FC<AuthCallbackProps> = ({ onAuthSuccess, onAuthError }) => {\n  const [status, setStatus] = useState<'loading' | 'success' | 'error'>('loading');\n  const [error, setError] = useState<string | null>(null);\n  const hasProcessedRef = useRef(false);\n  const subscriptionRef = useRef<{ unsubscribe: () => void } | null>(null);\n\n  useEffect(() => {\n    // Prevent multiple processing using ref (more reliable than state)\n    if (hasProcessedRef.current) {\n      console.log('üîê [AuthCallback] Already processed, skipping...');\n      return;\n    }\n    \n    hasProcessedRef.current = true;\n    \n    const handleAuthCallback = async () => {\n      try {\n        console.log('üîê [AuthCallback] Handling OAuth callback...');\n        console.log('üîê [AuthCallback] Current URL:', window.location.href);\n        console.log('üîê [AuthCallback] URL search params:', window.location.search);\n        console.log('üîê [AuthCallback] URL hash:', window.location.hash);\n\n        // Check for OAuth errors in URL parameters\n        const urlParams = new URLSearchParams(window.location.search);\n        const hashParams = new URLSearchParams(window.location.hash.substring(1));\n        \n        const oauthError = urlParams.get('error') || hashParams.get('error');\n        const errorDescription = urlParams.get('error_description') || hashParams.get('error_description');\n        const errorCode = urlParams.get('error_code') || hashParams.get('error_code');\n        \n        console.log('üîê [AuthCallback] OAuth parameters:', {\n          oauthError,\n          errorDescription,\n          errorCode,\n          urlParams: Object.fromEntries(urlParams.entries()),\n          hashParams: Object.fromEntries(hashParams.entries())\n        });\n        \n        if (oauthError) {\n          console.error('üîê [AuthCallback] OAuth error detected:', { oauthError, errorDescription, errorCode });\n          let errorMessage = 'Authentication failed';\n          \n          // Handle email confirmation errors\n          if (oauthError === 'access_denied' && errorCode === 'otp_expired') {\n            errorMessage = 'Email confirmation link has expired. Please request a new confirmation email.';\n          } else if (oauthError === 'access_denied' && errorDescription?.includes('Email link is invalid')) {\n            errorMessage = 'Email confirmation link is invalid. Please request a new confirmation email.';\n          } else if (oauthError === 'access_denied' && errorDescription?.includes('expired')) {\n            errorMessage = 'Email confirmation link has expired. Please request a new confirmation email.';\n          }\n          // Handle OAuth errors\n          else if (oauthError === 'server_error') {\n            errorMessage = 'Authentication server error. This may be due to Supabase configuration. Please try again.';\n          } else if (oauthError === 'access_denied') {\n            errorMessage = 'Authentication was cancelled. Please try again.';\n          } else if (oauthError === 'invalid_request') {\n            errorMessage = 'Invalid authentication request. Please check configuration.';\n          } else if (oauthError === 'unauthorized_client') {\n            errorMessage = 'Authentication client is not authorized. Please check Supabase configuration.';\n          } else if (oauthError === 'unsupported_response_type') {\n            errorMessage = 'Authentication response type not supported. Please check Supabase configuration.';\n          } else if (oauthError === 'invalid_scope') {\n            errorMessage = 'Authentication scope is invalid. Please check Supabase configuration.';\n          } else if (errorDescription) {\n            errorMessage = decodeURIComponent(errorDescription);\n          }\n          \n          setError(errorMessage);\n          setStatus('error');\n          onAuthError(errorMessage);\n          return;\n        }\n        \n        // Set up auth state change listener\n        const { data: { subscription } } = supabase.auth.onAuthStateChange(async (event, session) => {\n          console.log('üîê [AuthCallback] Auth state change:', { event, session });\n          \n          if (event === 'SIGNED_IN' && session?.user) {\n            console.log('üîê [AuthCallback] User signed in:', session.user.email);\n            console.log('üîê [AuthCallback] User metadata:', session.user.user_metadata);\n            console.log('üîê [AuthCallback] App metadata:', session.user.app_metadata);\n            console.log('üîê [AuthCallback] User identities:', session.user.identities);\n            \n            // Detect the OAuth provider\n            const provider = session.user.app_metadata?.provider || \n                           session.user.app_metadata?.providers?.[0] || \n                           session.user.identities?.[0]?.provider || \n                           'unknown';\n            console.log('üîê [AuthCallback] Detected provider:', provider);\n            \n            // Wait for database trigger to create user record\n            console.log('üîê [AuthCallback] Waiting for database trigger to create user record...');\n            await new Promise(resolve => setTimeout(resolve, 1500)); // Increased wait time for Discord\n            \n            // Load user data through AuthService\n            try {\n              await authService.loadUserFromSupabase(session.user.id);\n              console.log('üîê [AuthCallback] User data loaded successfully');\n              \n              // User is authenticated, notify parent component\n              setStatus('success');\n              onAuthSuccess();\n            } catch (loadError) {\n              console.error('üîê [AuthCallback] Error loading user data:', loadError);\n              setError('Failed to load user data. Please try again.');\n              setStatus('error');\n              onAuthError('Failed to load user data');\n            }\n            \n            // Unsubscribe from auth state changes\n            subscription.unsubscribe();\n          } else if (event === 'SIGNED_OUT') {\n            console.log('üîê [AuthCallback] User signed out');\n            setError('Authentication failed');\n            setStatus('error');\n            onAuthError('Authentication failed');\n            subscription.unsubscribe();\n          }\n        });\n        \n        // Store subscription in ref for cleanup\n        subscriptionRef.current = subscription;\n        \n        // Also try to get the current session\n        const { data, error } = await supabase.auth.getSession();\n        console.log('üîê [AuthCallback] Current session:', { data, error });\n        \n        if (error) {\n          console.error('üîê [AuthCallback] Auth callback error:', error);\n          setError(error.message);\n          setStatus('error');\n          onAuthError(error.message);\n          subscription.unsubscribe();\n          return;\n        }\n\n        if (data.session?.user) {\n          console.log('üîê [AuthCallback] User already authenticated:', data.session.user.email);\n          \n          // Wait for database trigger to create user record\n          console.log('üîê [AuthCallback] Waiting for database trigger to create user record...');\n          await new Promise(resolve => setTimeout(resolve, 1000));\n          \n          // Load user data through AuthService\n          await authService.loadUserFromSupabase(data.session.user.id);\n          \n          // User is authenticated, notify parent component\n          setStatus('success');\n          onAuthSuccess();\n          subscription.unsubscribe();\n        } else {\n          console.log('üîê [AuthCallback] No session found, waiting for auth state change...');\n          console.log('üîê [AuthCallback] URL search params:', window.location.search);\n          \n          // Try to handle OAuth callback manually if there are URL parameters\n          const urlParams = new URLSearchParams(window.location.search);\n          const hashParams = new URLSearchParams(window.location.hash.substring(1));\n          \n          if (urlParams.has('code') || urlParams.has('error') || hashParams.has('access_token')) {\n            console.log('üîê [AuthCallback] OAuth parameters found, trying manual handling...');\n            \n            // Wait a bit for the OAuth process to complete\n            await new Promise(resolve => setTimeout(resolve, 1000));\n            \n            // Try to get session again\n            const retrySession = await supabase.auth.getSession();\n            console.log('üîê [AuthCallback] Retry session after manual handling:', retrySession);\n            \n            if (retrySession.data.session?.user) {\n              console.log('üîê [AuthCallback] User authenticated after retry:', retrySession.data.session.user.email);\n              \n              // Wait for database trigger to create user record\n              console.log('üîê [AuthCallback] Waiting for database trigger to create user record...');\n              await new Promise(resolve => setTimeout(resolve, 500));\n              \n              // Load user data through AuthService\n              await authService.loadUserFromSupabase(retrySession.data.session.user.id);\n              \n              // User is authenticated, notify parent component\n              setStatus('success');\n              onAuthSuccess();\n              subscription.unsubscribe();\n              return;\n            }\n          }\n          \n          // Set a timeout to handle cases where auth state change doesn't fire\n          setTimeout(() => {\n            if (status === 'loading') {\n              console.log('üîê [AuthCallback] Timeout waiting for auth state change');\n              setError('Authentication timeout');\n              setStatus('error');\n              onAuthError('Authentication timeout');\n              subscription.unsubscribe();\n            }\n          }, 10000); // 10 second timeout\n        }\n      } catch (error) {\n        console.error('üîê [AuthCallback] Auth callback error:', error);\n        const errorMessage = 'An unexpected error occurred';\n        setError(errorMessage);\n        setStatus('error');\n        onAuthError(errorMessage);\n      }\n    };\n\n    handleAuthCallback();\n    \n    // Cleanup function\n    return () => {\n      if (subscriptionRef.current) {\n        subscriptionRef.current.unsubscribe();\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []); // Empty deps - only run once on mount\n\n  if (status === 'loading') {\n    return (\n      <div className=\"h-screen bg-gradient-to-br from-[#111111] to-[#0A0A0A] flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#FF4D4D] mx-auto mb-4\"></div>\n          <p className=\"text-[#CFCFCF] text-lg\">Completing authentication...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (status === 'error') {\n    return (\n      <div className=\"h-screen bg-gradient-to-br from-[#111111] to-[#0A0A0A] flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"text-red-500 text-6xl mb-4\">‚ö†Ô∏è</div>\n          <h2 className=\"text-2xl font-bold text-[#F5F5F5] mb-2\">Authentication Error</h2>\n          <p className=\"text-[#CFCFCF] mb-6\">{error}</p>\n          <div className=\"space-y-3\">\n            <button\n              onClick={() => {\n                // Clear the URL parameters and redirect to login\n                window.history.replaceState({}, document.title, window.location.pathname);\n                onAuthError('User cancelled authentication');\n              }}\n              className=\"bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] hover:from-[#D42A2A] hover:to-[#C87A1A] text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 hover:scale-105 active:scale-95\"\n            >\n              Return to Login\n            </button>\n            {error && error.includes('Email confirmation link') && (\n              <button\n                onClick={() => {\n                  // Clear the URL parameters and redirect to login with a flag to show resend option\n                  window.history.replaceState({}, document.title, window.location.pathname);\n                  onAuthError('Email confirmation expired - show resend option');\n                }}\n                className=\"bg-gradient-to-r from-[#4F46E5] to-[#7C3AED] hover:from-[#4338CA] hover:to-[#6D28D9] text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 hover:scale-105 active:scale-95\"\n              >\n                Request New Confirmation Email\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-screen bg-gradient-to-br from-[#111111] to-[#0A0A0A] flex items-center justify-center\">\n      <div className=\"text-center\">\n        <div className=\"text-green-500 text-6xl mb-4\">‚úÖ</div>\n        <h2 className=\"text-2xl font-bold text-[#F5F5F5] mb-2\">Authentication Successful</h2>\n        <p className=\"text-[#CFCFCF]\">Redirecting to the app...</p>\n      </div>\n    </div>\n  );\n};\n\nexport default AuthCallback;\n"],"names":["supabaseUrl","supabaseAnonKey","supabase","createClient","AuthCallback","onAuthSuccess","onAuthError","status","setStatus","useState","error","setError","hasProcessedRef","useRef","subscriptionRef","useEffect","urlParams","hashParams","oauthError","errorDescription","errorCode","errorMessage","subscription","event","session","provider","_a","_c","_b","_e","_d","resolve","authService","loadError","data","retrySession","jsxs","jsx"],"mappings":"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"}