{"version":3,"mappings":"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","names":["MAX_IMAGE_SIZE_BYTES","MIN_BASE64_LENGTH","validateScreenshotDataUrl","dataUrl","base64Marker","parts","base64Data","getDataUrlSizeMB","Logo","className","size","spin","spinOnce","bounce","sizeClasses","getAnimation","animations","jsx","getPublicPath","CheckIcon","FounderImage","showBorder","showShadow","showBadge","showStatus","borderClasses","shadowClasses","jsxs","e","target","fallback","_a","InstallationTabs","pcAppImage","activeTab","setActiveTab","useState","tabs","tab","feature1","feature2","feature3","feature4","feature5","feature6","geminiLogo","GamepadIcon","FeatureIcon","icon","icons","Fragment","Feature","React","title","description","image","isGemini","FeaturesCarousel","features","autoplayOptions","emblaRef","emblaApi","useEmblaCarousel","Autoplay","selectedIndex","setSelectedIndex","scrollSnaps","setScrollSnaps","isMobile","setIsMobile","useEffect","checkMobile","scrollPrev","useCallback","scrollNext","scrollTo","index","onSelect","slidesToShow","grouped","i","feature","group","slideIndex","idx","_","FeatureListItem","children","VanguardFeatureListItem","comingSoon","StarIcon","QuoteIcon","Testimonial","quote","author","isVisible","TestimonialsCarousel","testimonials","testimonial","LandingPage","onGetStarted","onOpenAbout","onOpenPrivacy","onOpenRefund","onOpenTerms","onOpenContact","onDirectNavigation","email","setEmail","isSubmitting","setIsSubmitting","submitMessage","setSubmitMessage","scrollY","setScrollY","backgroundRef","useRef","chatHintVisible","setChatHintVisible","testimonialsVisible","setTestimonialsVisible","chatHintRef","testimonialRefs","path","preventInstallPrompt","handleScroll","observerOptions","chatObserverOptions","handleIntersection","entries","setter","entry","prev","chatObserver","testimonialObservers","ref","observer","handleWaitlistSubmit","result","WaitlistService","error","toastService","handleScrollTo","id","el","GLOBAL_PROMPT_KEY","PWAInstallBanner","deferredPrompt","setDeferredPrompt","hasPrompt","setHasPrompt","isInstalled","setIsInstalled","isPWAMode","markAppAsInstalled","globalPrompt","handleBeforeInstallPrompt","installEvent","handleAppInstalled","res","manifest","err","handleInstallClick","outcome","LoginSplashScreen","onComplete","onBackToLanding","onSetAppState","isLoading","setIsLoading","password","setPassword","emailMode","setEmailMode","errorMessage","setErrorMessage","successMessage","setSuccessMessage","isAnimating","setIsAnimating","rememberMe","setRememberMe","emailError","setEmailError","passwordError","setPasswordError","showTermsModal","setShowTermsModal","showPrivacyModal","setShowPrivacyModal","showSignupSuccess","setShowSignupSuccess","showPassword","setShowPassword","showSignupModal","setShowSignupModal","signupModalType","setSignupModalType","signupModalMessage","setSignupModalMessage","validatePassword","errors","validateEmail","togglePasswordVisibility","handleSignupModalClose","handleKeyDown","handleAuth","method","authService","handleEmailAuth","providerCheck","passwordValidation","errorMsg","handleForgotPassword","Button","TermsModal","PrivacyModal","InitialSplashScreen","user","isProcessing","setIsProcessing","handleDownloadPCClient","handleStartAdventure","supabase","KeyboardIcon","ScreenshotIcon","HandsFreeIcon","isActive","PauseIcon","PlayIcon","InsightsIcon","ProBadge","FeatureItem","HowToUseSplashScreen","isMounted","setIsMounted","HowToUseSplashScreen$1","ProFeature","proFeatures","vanguardFeatures","ProFeaturesSplashScreen","onUpgrade","onUpgradeToVanguard","f","ProFeaturesSplashScreen$1","HintIcon","DesktopIcon","BookmarkIcon","allSlides","slides","SplashScreen","onSkipConnection","onConnect","status","connectionCode","onConnectionSuccess","step","setStep","code","setCode","syncInitiated","setSyncInitiated","connectionSuccessCalled","setConnectionSuccessCalled","touchStartX","setTouchStartX","touchEndX","setTouchEndX","ConnectionStatus","currentSlide","isLastStep","isConnecting","isConnected","handleNext","s","handlePrev","handleConnectClick","handleTouchStart","touch","handleTouchMove","handleTouchEnd","distance","minSwipeDistance","isLeftSwipe","isRightSwipe","isCodeValid","SplashScreen$1","useActiveSession","initialState","session","setSession","toggleSession","conversationId","prevSession","setActiveSession","ContextMenu","isOpen","position","onClose","onDelete","onPin","onUnpin","onClearConversation","canDelete","canPin","isPinned","isEverythingElse","menuRef","handleClickOutside","event","handleEscape","Sidebar","conversations","activeConversation","onConversationSelect","onDeleteConversation","onPinConversation","onUnpinConversation","onAddGame","contextMenu","setContextMenu","longPressTimer","longPressDelay","conversationList","a","b","aIsGameHub","bIsGameHub","handleContextMenu","handleLongPressStart","handleLongPressEnd","closeContextMenu","handleDelete","handlePin","handleUnpin","handleClearConversation","conversation","isGameHub","isUnreleased","isRegularGame","borderClass","titleClass","_b","_c","_d","CreditIndicator","onClick","textCount","textLimit","imageCount","imageLimit","textPercentRemaining","imagePercentRemaining","radiusOuter","circumferenceOuter","offsetOuter","radiusInner","circumferenceInner","offsetInner","strokeWidth","HandsFreeToggle","isHandsFree","onToggle","LoadingSpinner","SettingsContextMenu","onOpenSettings","onOpenGuide","onLogout","userTier","onTrialStart","isTrialEligible","setIsTrialEligible","isStartingTrial","setIsStartingTrial","currentUser","supabaseService","handleStartTrial","ProfileSetupBanner","onDismiss","isExpanded","setIsExpanded","profile","setProfile","currentStep","setCurrentStep","query","handleChange","steps","handleBack","handleOptionSelect","field","value","currentStepData","progressPercent","shouldUseOverlay","originalOverflow","collapsedBanner","expandedCard","option","handleOverlayClick","WelcomeScreen","onStartChat","_onAddGame","OverviewTab","FeaturesTab","HotkeysTab","BestPracticesTab","tip","tipIndex","practices","section","sectionIndex","ChatErrorFallback","MainApp","_onOpenSettings","_onOpenAbout","_onOpenPrivacy","_onOpenRefund","_onOpenContact","_onOpenTerms","propConnectionStatus","propConnectionError","propOnConnect","propOnDisconnect","propOnClearConnectionError","propOnWebSocketMessage","showProfileSetupBanner","onProfileSetupComplete","onProfileSetupDismiss","setUser","setConversations","setActiveConversation","isInitializing","setIsInitializing","suggestedPrompts","setSuggestedPrompts","abortController","setAbortController","isManualUploadMode","setIsManualUploadMode","saved","sidebarOpen","setSidebarOpen","settingsOpen","setSettingsOpen","creditModalOpen","setCreditModalOpen","welcomeScreenOpen","setWelcomeScreenOpen","connectionModalOpen","setConnectionModalOpen","setConnectionCode","lastSuccessfulConnection","setLastSuccessfulConnection","isHandsFreeMode","setIsHandsFreeMode","handsFreeModalOpen","setHandsFreeModalOpen","currentInputMessage","setCurrentInputMessage","queuedScreenshot","setQueuedScreenshot","isLoadingConversationsRef","hasLoadedConversationsRef","handleSendMessageRef","lastRequestTimeRef","RATE_LIMIT_DELAY_MS","useMemo","addGameModalOpen","setAddGameModalOpen","deepCloneConversations","cloned","key","msg","settingsContextMenu","setSettingsContextMenu","connectionStatus","connectionError","savedConnectionCode","lastConnection","ttsService","handleWebSocketMessage","data","codeToUse","validation","sizeMB","handleScreenshotQueued","loadData","retryCount","UserService","gameHubFromEnsure","ConversationService","userConversations","active","currentGameHub","conv","newConversation","updatedConversations","finalConversations","finalActive","GAME_HUB_ID","newsPrompts","fallbackPrompts","suggestedPromptsService","gameHubConv","delay","timeout","subscription","payload","updated","refreshUserData","handleWebSocketError","handleWebSocketOpen","handleWebSocketClose","storedCode","connect","chatInput","gameHub","c","handleConversationSelect","targetConversation","mergedConversations","handleDeleteConversation","wasActive","deletedConversation","gameHubTab","firstConversation","handlePinConversation","pinnedAt","handleUnpinConversation","handleCreditModalOpen","handleCreditModalClose","handleUpgrade","handleOpenGuide","handleAddGame","handleCreateGame","gameName","formattedMessage","handleSendMessage","handleConnectionModalOpen","handleConnectionModalClose","handleClearConnectionError","handleHandsFreeToggle","handleHandsFreeModalClose","handleToggleHandsFreeFromModal","newMode","handleSettingsContextMenu","closeSettingsContextMenu","handleOpenSettings","handleLogout","handleConnect","handleDisconnect","disconnect","handleSuggestedPromptClick","prompt","handleInputMessageChange","message","handleToggleActiveSession","wasPlaying","willBePlaying","playingSummary","sessionSummaryService","summaryMessage","planningSummary","handleStopAI","pollForSubtabUpdates","attempts","maxAttempts","resolve","targetConv","loadingSubtabs","loadedSubtabs","stillLoading","freshConversations","updatedActiveConv","st","handleCreateGameTab","gameInfo","existingConversation","newGameTab","gameTabService","aiService","imageUrl","now","timeSinceLastRequest","sessionService","newMessage","tabManagementService","command","queryType","currentCount","limit","usagePercent","remaining","SupabaseService","controller","conversationWithOptimizedContext","contextSummarizationService","__vitePreload","n","summarizedConversation","response","aiMessage","hintMatch","textToSpeak","cleanText","ttsError","showAINotification","isScreenLockedOrHidden","notificationText","notificationError","suggestionsToUse","processedSuggestions","tag","progress","updatedConv","objective","refreshedConversation","updateData","parsed","modifyData","deleteData","updatedSubtabs","gameTitle","confidence","genre","isFullscreen","shouldCreateTab","targetConvId","existingGameTab","targetConversationId","refreshedConversations","MessageRoutingService","gameTab","fallbackSuggestions","hasLoadingSubtabs","_e","recoveryAction","errorRecoveryService","ErrorBoundary","GameProgressBar","ChatInterface","SettingsModal","CreditModal","ConnectionModal","HandsFreeModal","AddGameModal","refreshedUser","LandingPageRoute","navigate","useNavigate","searchParams","setSearchParams","useSearchParams","activeModal","setActiveModal","loaderData","useLoaderData","onboardingStatus","modal","handleGetStarted","handleOpenAbout","handleOpenPrivacy","handleOpenRefund","handleOpenTerms","handleOpenContact","handleCloseModal","handleDirectNavigation","AboutModal","RefundPolicyModal","ContactUsModal","LoginRoute","handleComplete","handleBackToLanding","handleSetAppState","AuthCallbackRoute","handleAuthSuccess","handleAuthError","AuthCallback","InitialOnboardingRoute","HowToUseRoute","setStatus","setError","savedCode","disconnectWebSocket","handleSkipConnection","connectWebSocket","dbError","displayError","handleConnectionSuccess","FeaturesConnectedRoute","ProFeaturesRoute","handleUpgradeToVanguard","MainAppRoute","setConnectionStatus","profileData","authLoader","request","pathname","redirect","rpcData","rpcError","userData","onboardingLoader","currentPath","appLoader","routes","router","createBrowserRouter","AppWrapper","Suspense","RouterProvider","ReactDOM"],"ignoreList":[],"sources":["../../src/utils/imageValidation.ts","../../src/components/ui/Logo.tsx","../../src/components/ui/CheckIcon.tsx","../../src/components/FounderImage.tsx","../../src/components/InstallationTabs.tsx","../../src/assets/images/feature-images/feature1.png","../../src/assets/images/feature-images/feature2.png","../../src/assets/images/feature-images/feature3.png","../../src/assets/images/feature-images/feature4.png","../../src/assets/images/feature-images/feature5.png","../../src/assets/images/feature-images/feature6.png","../../src/assets/images/landing/google.png","../../src/assets/images/landing/PC app.png","../../src/components/LandingPageFresh.tsx","../../src/components/splash/PWAInstallBanner.tsx","../../src/components/splash/LoginSplashScreen.tsx","../../src/components/splash/InitialSplashScreen.tsx","../../src/components/ui/KeyboardIcon.tsx","../../src/components/ui/ScreenshotIcon.tsx","../../src/components/ui/HandsFreeIcon.tsx","../../src/components/ui/PauseIcon.tsx","../../src/components/ui/PlayIcon.tsx","../../src/components/splash/HowToUseSplashScreen.tsx","../../src/components/splash/ProFeaturesSplashScreen.tsx","../../src/components/ui/HintIcon.tsx","../../src/components/ui/DesktopIcon.tsx","../../src/components/ui/BookmarkIcon.tsx","../../src/components/splash/SplashScreen.tsx","../../src/hooks/useActiveSession.ts","../../src/components/ui/ContextMenu.tsx","../../src/components/layout/Sidebar.tsx","../../src/components/ui/CreditIndicator.tsx","../../src/components/ui/HandsFreeToggle.tsx","../../src/components/ui/LoadingSpinner.tsx","../../src/components/ui/SettingsContextMenu.tsx","../../src/components/ui/ProfileSetupBanner.tsx","../../src/components/welcome/WelcomeScreen.tsx","../../src/components/MainApp.tsx","../../src/router/routes/LandingPageRoute.tsx","../../src/router/routes/LoginRoute.tsx","../../src/router/routes/AuthCallbackRoute.tsx","../../src/router/routes/InitialOnboardingRoute.tsx","../../src/router/routes/HowToUseRoute.tsx","../../src/router/routes/FeaturesConnectedRoute.tsx","../../src/router/routes/ProFeaturesRoute.tsx","../../src/router/routes/MainAppRoute.tsx","../../src/router/index.tsx","../../src/AppWrapper.tsx","../../src/main.tsx?v=20251116024900"],"sourcesContent":["// ========================================\r\n// IMAGE DATA URL VALIDATION UTILITY\r\n// ========================================\r\n\r\nexport interface ValidationResult {\r\n  valid: boolean;\r\n  error?: string;\r\n}\r\n\r\n// Maximum image size: 10MB for base64 encoded data\r\n// Base64 encoding increases size by ~37%, so 10MB base64  7.3MB actual image\r\nconst MAX_IMAGE_SIZE_BYTES = 10 * 1024 * 1024 * 1.37;\r\n\r\n// Minimum reasonable base64 image data (1x1 pixel PNG is ~100 chars)\r\nconst MIN_BASE64_LENGTH = 100;\r\n\r\n/**\r\n * Validates a screenshot data URL before processing or sending to AI\r\n * \r\n * Checks performed:\r\n * 1. Type validation (must be string)\r\n * 2. Format validation (must start with data:image/)\r\n * 3. Size validation (max 10MB encoded)\r\n * 4. Base64 marker presence\r\n * 5. Base64 data exists and is non-empty\r\n * 6. Base64 format validation (rough check)\r\n * \r\n * @param dataUrl - The data URL to validate\r\n * @returns ValidationResult with valid flag and optional error message\r\n */\r\nexport function validateScreenshotDataUrl(dataUrl: unknown): ValidationResult {\r\n  // 1. Check if it's a string\r\n  if (typeof dataUrl !== 'string') {\r\n    return { valid: false, error: 'Screenshot data must be a string' };\r\n  }\r\n\r\n  // 2. Check if it starts with data:image/\r\n  if (!dataUrl.startsWith('data:image/')) {\r\n    return { valid: false, error: 'Invalid image format - must be a data URL (data:image/...)' };\r\n  }\r\n\r\n  // 3. Check size (prevent memory exhaustion from huge images)\r\n  if (dataUrl.length > MAX_IMAGE_SIZE_BYTES) {\r\n    const sizeMB = (dataUrl.length / (1024 * 1024)).toFixed(2);\r\n    return { valid: false, error: `Image too large (${sizeMB}MB). Maximum size is 10MB.` };\r\n  }\r\n\r\n  // 4. Check if base64 section exists\r\n  const base64Marker = ';base64,';\r\n  if (!dataUrl.includes(base64Marker)) {\r\n    return { valid: false, error: 'Missing base64 encoding in data URL' };\r\n  }\r\n\r\n  // 5. Extract and validate base64 data exists\r\n  const parts = dataUrl.split(base64Marker);\r\n  if (parts.length !== 2) {\r\n    return { valid: false, error: 'Malformed data URL - invalid base64 marker' };\r\n  }\r\n\r\n  const base64Data = parts[1];\r\n  if (!base64Data || base64Data.length < MIN_BASE64_LENGTH) {\r\n    return { valid: false, error: 'Invalid or empty base64 image data' };\r\n  }\r\n\r\n  // 6. Check if base64 string contains only valid base64 characters\r\n  // Valid base64: A-Z, a-z, 0-9, +, /, and = for padding (max 2 at end)\r\n  if (!/^[A-Za-z0-9+/]+={0,2}$/.test(base64Data)) {\r\n    return { valid: false, error: 'Malformed base64 data - contains invalid characters' };\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Safely normalizes a data URL by ensuring it has the proper prefix\r\n * Only adds prefix if validation passes\r\n * \r\n * @param dataUrl - The data URL to normalize\r\n * @returns Normalized data URL or null if validation fails\r\n */\r\nexport function normalizeDataUrl(dataUrl: string): string | null {\r\n  // If it already has the prefix, validate and return\r\n  if (dataUrl.startsWith('data:image/')) {\r\n    const result = validateScreenshotDataUrl(dataUrl);\r\n    return result.valid ? dataUrl : null;\r\n  }\r\n\r\n  // Try adding the data:image/png;base64, prefix\r\n  const normalized = `data:image/png;base64,${dataUrl}`;\r\n  const result = validateScreenshotDataUrl(normalized);\r\n  \r\n  return result.valid ? normalized : null;\r\n}\r\n\r\n/**\r\n * Gets the approximate size of a data URL in megabytes\r\n * \r\n * @param dataUrl - The data URL to measure\r\n * @returns Size in MB rounded to 2 decimal places\r\n */\r\nexport function getDataUrlSizeMB(dataUrl: string): number {\r\n  return parseFloat((dataUrl.length / (1024 * 1024)).toFixed(2));\r\n}\r\n\r\n/**\r\n * Extracts the MIME type from a data URL\r\n * \r\n * @param dataUrl - The data URL\r\n * @returns MIME type (e.g., 'image/png') or null if invalid\r\n */\r\nexport function extractMimeType(dataUrl: string): string | null {\r\n  const match = dataUrl.match(/^data:([^;]+);/);\r\n  return match ? match[1] : null;\r\n}\r\n","import React from 'react';\r\nimport { getPublicPath } from '../../utils/publicPath';\r\n\r\ninterface LogoProps {\r\n  className?: string;\r\n  size?: 'sm' | 'md' | 'lg' | 'xl';\r\n  spin?: boolean;\r\n  spinOnce?: boolean; // New: rotates once and stops\r\n  bounce?: boolean;\r\n}\r\n\r\nconst Logo: React.FC<LogoProps> = ({ className = '', size = 'md', spin = false, spinOnce = false, bounce = false }) => {\r\n  const sizeClasses = {\r\n    sm: 'w-8 h-8',\r\n    md: 'w-12 h-12',\r\n    lg: 'w-16 h-16',\r\n    xl: 'w-24 h-24',\r\n  };\r\n\r\n  const getAnimation = () => {\r\n    const animations = [];\r\n    if (bounce) {\r\n      animations.push('bounce 2s infinite');\r\n    }\r\n    if (spinOnce) {\r\n      animations.push('spin-once 2s ease-in-out forwards');\r\n    } else if (spin) {\r\n      animations.push('spin 6s linear infinite');\r\n    }\r\n    return animations.length > 0 ? animations.join(', ') : 'none';\r\n  };\r\n\r\n  return (\r\n    <img\r\n      src={getPublicPath('/images/otagon-logo.png')}\r\n      alt=\"Otagon Logo\"\r\n      className={`${sizeClasses[size]} ${className}`}\r\n      style={{ \r\n        filter: 'drop-shadow(0 0 24px rgba(255, 140, 0, 0.3))',\r\n        objectFit: 'contain',\r\n        animation: getAnimation()\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default Logo;\r\n","import React from 'react';\r\n\r\nconst CheckIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"3\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n    className={className}\r\n  >\r\n    <polyline points=\"20 6 9 17 4 12\" />\r\n  </svg>\r\n);\r\n\r\nexport default CheckIcon;\r\n","import React from 'react';\r\nimport { getPublicPath } from '../utils/publicPath';\r\n\r\ninterface FounderImageProps {\r\n  className?: string;\r\n  size?: 'sm' | 'md' | 'lg' | 'xl';\r\n  showBorder?: boolean;\r\n  showShadow?: boolean;\r\n  showBadge?: boolean;\r\n  showStatus?: boolean;\r\n}\r\n\r\nconst FounderImage: React.FC<FounderImageProps> = ({ \r\n  className = \"\", \r\n  size = 'md',\r\n  showBorder = true,\r\n  showShadow = true,\r\n  showBadge = true,\r\n  showStatus = true\r\n}) => {\r\n  const sizeClasses = {\r\n    sm: 'w-16 h-16',\r\n    md: 'w-24 h-24',\r\n    lg: 'w-32 h-32',\r\n    xl: 'w-40 h-40'\r\n  };\r\n\r\n  const borderClasses = showBorder \r\n    ? 'border-2 border-[#E53A3A]/30 ring-2 ring-[#D98C1F]/20' \r\n    : '';\r\n\r\n  const shadowClasses = showShadow \r\n    ? 'shadow-lg shadow-[#E53A3A]/20' \r\n    : '';\r\n\r\n  return (\r\n    <div className={`relative ${className}`}>\r\n      {/* Founder Portrait */}\r\n      <div className={`relative overflow-hidden rounded-full ${sizeClasses[size]} ${borderClasses} ${shadowClasses}`}>\r\n        <img\r\n          src={getPublicPath('/images/founder-image.jpg')}\r\n          alt=\"Otagon Founder - AI Gaming Visionary\"\r\n          className=\"w-full h-full object-cover object-center\"\r\n          style={{\r\n            objectPosition: 'center 30%' // Position to show face clearly\r\n          }}\r\n          onError={(e) => {\r\n            // Fallback if image doesn't load\r\n            const target = e.target as HTMLImageElement;\r\n            target.style.display = 'none';\r\n            const fallback = target.parentElement?.querySelector('.fallback') as HTMLElement;\r\n            if (fallback) {\r\n              fallback.style.display = 'flex';\r\n            }\r\n          }}\r\n        />\r\n        \r\n        {/* Fallback Avatar */}\r\n        <div className=\"fallback hidden absolute inset-0 bg-gradient-to-br from-[#E53A3A] to-[#D98C1F] rounded-full items-center justify-center\">\r\n          <div className=\"text-white font-bold text-center\">\r\n            <div className=\"text-2xl\"></div>\r\n            <div className=\"text-xs mt-1\">Founder</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Status Indicator */}\r\n      {showStatus && (\r\n        <div className=\"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 border-2 border-white rounded-full\">\r\n          <div className=\"w-full h-full bg-green-400 rounded-full animate-pulse\"></div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Founder Badge */}\r\n      {showBadge && (\r\n        <div className=\"absolute -top-2 -right-2 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] text-white text-xs px-2 py-1 rounded-full font-bold shadow-lg\">\r\n          FOUNDER\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FounderImage;\r\n","import React, { useState } from 'react';\r\n\r\ninterface InstallationTabsProps {\r\n  pcAppImage: string;\r\n}\r\n\r\ntype TabType = 'windows' | 'ios' | 'android';\r\n\r\nconst InstallationTabs: React.FC<InstallationTabsProps> = ({ pcAppImage }) => {\r\n  const [activeTab, setActiveTab] = useState<TabType>('windows');\r\n\r\n  const tabs: { id: TabType; label: string; icon: React.ReactNode }[] = [\r\n    {\r\n      id: 'windows',\r\n      label: 'Windows',\r\n      icon: (\r\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n          <path d=\"M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-12.9-1.801\" />\r\n        </svg>\r\n      ),\r\n    },\r\n    {\r\n      id: 'ios',\r\n      label: 'iOS',\r\n      icon: (\r\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n          <path d=\"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z\" />\r\n        </svg>\r\n      ),\r\n    },\r\n    {\r\n      id: 'android',\r\n      label: 'Android',\r\n      icon: (\r\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n          <path d=\"M17.6 9.48l1.84-3.18c.16-.31.04-.69-.26-.85a.637.637 0 0 0-.83.22l-1.88 3.24a11.43 11.43 0 0 0-8.94 0L5.65 5.67a.643.643 0 0 0-.87-.2c-.28.18-.37.54-.22.83L6.4 9.48A10.81 10.81 0 0 0 1 18h22a10.81 10.81 0 0 0-5.4-8.52M7 15.25a1.25 1.25 0 1 1 2.5 0 1.25 1.25 0 0 1-2.5 0m7.5 0a1.25 1.25 0 1 1 2.5 0 1.25 1.25 0 0 1-2.5 0z\" />\r\n        </svg>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      {/* Tab Navigation */}\r\n      <div className=\"flex justify-center mb-8 md:mb-10\">\r\n        <div className=\"inline-flex bg-gradient-to-r from-neutral-900/80 to-neutral-800/80 backdrop-blur-xl border border-neutral-700/60 rounded-2xl p-1.5 shadow-2xl\">\r\n          {tabs.map((tab) => (\r\n            <button\r\n              key={tab.id}\r\n              onClick={() => setActiveTab(tab.id)}\r\n              className={`\r\n                flex items-center gap-2 px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-300\r\n                ${\r\n                  activeTab === tab.id\r\n                    ? 'bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] text-white shadow-lg scale-105'\r\n                    : 'text-neutral-400 hover:text-neutral-200 hover:bg-neutral-800/50'\r\n                }\r\n              `}\r\n            >\r\n              {tab.icon}\r\n              <span>{tab.label}</span>\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tab Content */}\r\n      <div className=\"relative\">\r\n        {/* Windows PC Tab */}\r\n        {activeTab === 'windows' && (\r\n          <div className=\"animate-fade-slide-up\">\r\n            <div className=\"bg-gradient-to-br from-neutral-900/60 to-neutral-800/40 backdrop-blur-xl border border-neutral-700/60 rounded-3xl p-8 md:p-10 shadow-2xl\">\r\n              <div className=\"grid md:grid-cols-2 gap-8 md:gap-12 items-center\">\r\n                {/* Left: PC App Image */}\r\n                <div className=\"order-2 md:order-1\">\r\n                  <div className=\"relative group\">\r\n                    <div className=\"absolute -inset-4 bg-gradient-to-r from-[#E53A3A]/20 to-[#D98C1F]/20 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500\"></div>\r\n                    <img\r\n                      src={pcAppImage}\r\n                      alt=\"Otagon Connector for Windows\"\r\n                      className=\"relative w-full h-auto rounded-2xl shadow-2xl border border-neutral-700/40\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Right: Instructions */}\r\n                <div className=\"order-1 md:order-2\">\r\n                  <div className=\"mb-6\">\r\n                    <h3 className=\"text-2xl md:text-3xl font-bold text-white mb-3\">\r\n                      Otagon Connector for Windows\r\n                    </h3>\r\n                    <p className=\"text-lg text-neutral-300 leading-relaxed\">\r\n                      Get help while gaming! This handy PC tool captures your game screen and sends it to Otagon so you can get hints without leaving your game.\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-6 mb-8\">\r\n                    {/* Step 1 */}\r\n                    <div className=\"flex gap-4\">\r\n                      <div className=\"flex-shrink-0 flex items-center\">\r\n                        <div className=\"w-3 h-3 rounded-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] shadow-lg\">\r\n                        </div>\r\n                      </div>\r\n                      <div>\r\n                        <h4 className=\"text-lg font-semibold text-white mb-1\">\r\n                          Download & Install\r\n                        </h4>\r\n                        <p className=\"text-neutral-400 leading-relaxed\">\r\n                          Download the Otagon Connector app and install it on your PC (just like any other program)\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Step 2 */}\r\n                    <div className=\"flex gap-4\">\r\n                      <div className=\"flex-shrink-0 flex items-center\">\r\n                        <div className=\"w-3 h-3 rounded-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] shadow-lg\">\r\n                        </div>\r\n                      </div>\r\n                      <div>\r\n                        <h4 className=\"text-lg font-semibold text-white mb-1\">\r\n                          Connect to Otagon\r\n                        </h4>\r\n                        <p className=\"text-neutral-400 leading-relaxed\">\r\n                          Open the Connector app to see your 6-digit code, then type that code into Otagon (on your web browser or phone)\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Download Button */}\r\n                  <div className=\"flex justify-center md:justify-start\">\r\n                    <button\r\n                      disabled\r\n                      className=\"inline-flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-neutral-600 to-neutral-500 text-neutral-300 font-bold text-lg rounded-xl shadow-2xl transition-all duration-300 cursor-not-allowed opacity-50\"\r\n                    >\r\n                    <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\r\n                    </svg>\r\n                    <span>Coming Soon</span>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* iOS Tab */}\r\n        {activeTab === 'ios' && (\r\n          <div className=\"animate-fade-slide-up\">\r\n            <div className=\"bg-gradient-to-br from-neutral-900/60 to-neutral-800/40 backdrop-blur-xl border border-neutral-700/60 rounded-3xl p-8 md:p-10 shadow-2xl max-w-3xl mx-auto\">\r\n              <div className=\"text-center mb-8\">\r\n                <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-r from-[#E53A3A]/20 to-[#D98C1F]/20 mb-4\">\r\n                  <svg className=\"w-10 h-10 text-white\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                    <path d=\"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z\" />\r\n                  </svg>\r\n                </div>\r\n                <h3 className=\"text-2xl md:text-3xl font-bold text-white mb-3\">\r\n                  Get Otagon on iPhone/iPad\r\n                </h3>\r\n                <p className=\"text-lg text-neutral-300 leading-relaxed\">\r\n                  Save Otagon to your home screen for easy access anytime\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"space-y-5\">\r\n                {/* Step 1 */}\r\n                <div className=\"flex gap-4 items-start\">\r\n                  <div className=\"flex-shrink-0 flex items-center pt-1\">\r\n                    <div className=\"w-3 h-3 rounded-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] shadow-lg\">\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-neutral-200 leading-relaxed text-lg\">\r\n                      Open <span className=\"font-semibold text-white\">Safari</span> on your iPhone or iPad and visit Otagon\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Step 2 */}\r\n                <div className=\"flex gap-4 items-start\">\r\n                  <div className=\"flex-shrink-0 flex items-center pt-1\">\r\n                    <div className=\"w-3 h-3 rounded-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] shadow-lg\">\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-neutral-200 leading-relaxed text-lg\">\r\n                      Go to the <span className=\"font-semibold text-white\">login page</span>\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Step 3 */}\r\n                <div className=\"flex gap-4 items-start\">\r\n                  <div className=\"flex-shrink-0 flex items-center pt-1\">\r\n                    <div className=\"w-3 h-3 rounded-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] shadow-lg\">\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-neutral-200 leading-relaxed text-lg\">\r\n                      Tap the <span className=\"font-semibold text-white\">Share button</span> at the bottom (the square with an arrow pointing up)\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Step 4 */}\r\n                <div className=\"flex gap-4 items-start\">\r\n                  <div className=\"flex-shrink-0 flex items-center pt-1\">\r\n                    <div className=\"w-3 h-3 rounded-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] shadow-lg\">\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-neutral-200 leading-relaxed text-lg\">\r\n                      Choose <span className=\"font-semibold text-white\">Add to Home Screen</span>, then tap <span className=\"font-semibold text-white\">Add</span>. That's it!\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Android Tab */}\r\n        {activeTab === 'android' && (\r\n          <div className=\"animate-fade-slide-up\">\r\n            <div className=\"bg-gradient-to-br from-neutral-900/60 to-neutral-800/40 backdrop-blur-xl border border-neutral-700/60 rounded-3xl p-8 md:p-10 shadow-2xl max-w-3xl mx-auto\">\r\n              <div className=\"text-center mb-8\">\r\n                <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-r from-[#E53A3A]/20 to-[#D98C1F]/20 mb-4\">\r\n                  <svg className=\"w-10 h-10 text-white\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                    <path d=\"M17.6 9.48l1.84-3.18c.16-.31.04-.69-.26-.85a.637.637 0 0 0-.83.22l-1.88 3.24a11.43 11.43 0 0 0-8.94 0L5.65 5.67a.643.643 0 0 0-.87-.2c-.28.18-.37.54-.22.83L6.4 9.48A10.81 10.81 0 0 0 1 18h22a10.81 10.81 0 0 0-5.4-8.52M7 15.25a1.25 1.25 0 1 1 2.5 0 1.25 1.25 0 0 1-2.5 0m7.5 0a1.25 1.25 0 1 1 2.5 0 1.25 1.25 0 0 1-2.5 0z\" />\r\n                  </svg>\r\n                </div>\r\n                <h3 className=\"text-2xl md:text-3xl font-bold text-white mb-3\">\r\n                  Get Otagon on Android\r\n                </h3>\r\n                <p className=\"text-lg text-neutral-300 leading-relaxed\">\r\n                  Save Otagon to your home screen for easy access anytime\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"space-y-5\">\r\n                {/* Step 1 */}\r\n                <div className=\"flex gap-4 items-start\">\r\n                  <div className=\"flex-shrink-0 flex items-center pt-1\">\r\n                    <div className=\"w-3 h-3 rounded-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] shadow-lg\">\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-neutral-200 leading-relaxed text-lg\">\r\n                      Open <span className=\"font-semibold text-white\">Chrome</span> on your Android phone or tablet and visit Otagon\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Step 2 */}\r\n                <div className=\"flex gap-4 items-start\">\r\n                  <div className=\"flex-shrink-0 flex items-center pt-1\">\r\n                    <div className=\"w-3 h-3 rounded-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] shadow-lg\">\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-neutral-200 leading-relaxed text-lg\">\r\n                      Go to the <span className=\"font-semibold text-white\">login page</span>\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Step 3 */}\r\n                <div className=\"flex gap-4 items-start\">\r\n                  <div className=\"flex-shrink-0 flex items-center pt-1\">\r\n                    <div className=\"w-3 h-3 rounded-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] shadow-lg\">\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-neutral-200 leading-relaxed text-lg\">\r\n                      Tap the <span className=\"font-semibold text-white\">three dots menu ()</span> in the top right corner\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Step 4 */}\r\n                <div className=\"flex gap-4 items-start\">\r\n                  <div className=\"flex-shrink-0 flex items-center pt-1\">\r\n                    <div className=\"w-3 h-3 rounded-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] shadow-lg\">\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-neutral-200 leading-relaxed text-lg\">\r\n                      Choose <span className=\"font-semibold text-white\">Add to Home screen</span> or <span className=\"font-semibold text-white\">Install app</span>. Done!\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InstallationTabs;\r\n","export default \"__VITE_ASSET__D0iwSPkS__\"","export default \"__VITE_ASSET__6sgaB6pw__\"","export default \"__VITE_ASSET__DmQfp9Up__\"","export default \"__VITE_ASSET__DVNKN4bq__\"","export default \"__VITE_ASSET__C5lxMogJ__\"","export default \"__VITE_ASSET__Wnr2IDcG__\"","export default \"__VITE_ASSET__Cct5SsqH__\"","export default \"__VITE_ASSET__BKYZjwYq__\"","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport Logo from './ui/Logo';\r\nimport CheckIcon from './ui/CheckIcon';\r\nimport StarIcon from './ui/StarIcon';\r\nimport FounderImage from './FounderImage';\r\nimport InstallationTabs from './InstallationTabs';\r\nimport { WaitlistService } from '../services/waitlistService';\r\nimport { toastService } from '../services/toastService';\r\nimport useEmblaCarousel from 'embla-carousel-react';\r\nimport Autoplay from 'embla-carousel-autoplay';\r\n\r\n// Import feature images\r\nimport feature1 from '../assets/images/feature-images/feature1.png';\r\nimport feature2 from '../assets/images/feature-images/feature2.png';\r\nimport feature3 from '../assets/images/feature-images/feature3.png';\r\nimport feature4 from '../assets/images/feature-images/feature4.png';\r\nimport feature5 from '../assets/images/feature-images/feature5.png';\r\nimport feature6 from '../assets/images/feature-images/feature6.png';\r\nimport geminiLogo from '../assets/images/landing/google.png';\r\nimport pcAppImage from '../assets/images/landing/PC app.png';\r\n\r\nconst GamepadIcon = ({ className }: { className?: string }) => (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n        <rect x=\"2\" y=\"6\" width=\"20\" height=\"12\" rx=\"2\"></rect>\r\n        <path d=\"M6 12h4\"></path>\r\n        <path d=\"M14 10v4\"></path>\r\n        <path d=\"M18 10v4\"></path>\r\n        <path d=\"M10 10v4\"></path>\r\n    </svg>\r\n);\r\n\r\nconst ProBadge = () => (\r\n    <span className=\"text-sm font-bold bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] text-white px-2.5 py-1 rounded-full uppercase tracking-wider ml-3\">\r\n        PRO\r\n    </span>\r\n);\r\n\r\nconst FeatureIcon = ({ icon }: { icon: 'eye' | 'bookmark' | 'network' | 'mic' | 'insights' | 'cpu' }) => {\r\n    const icons = {\r\n        eye: (\r\n            <>\r\n                <path d=\"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z\" />\r\n                <circle cx=\"12\" cy=\"12\" r=\"3\" />\r\n            </>\r\n        ),\r\n        bookmark: (\r\n            <>\r\n                <path d=\"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z\" />\r\n            </>\r\n        ),\r\n        network: (\r\n            <>\r\n                <rect x=\"16\" y=\"16\" width=\"6\" height=\"6\" rx=\"1\" />\r\n                <rect x=\"2\" y=\"16\" width=\"6\" height=\"6\" rx=\"1\" />\r\n                <rect x=\"9\" y=\"2\" width=\"6\" height=\"6\" rx=\"1\" />\r\n                <path d=\"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3\" />\r\n                <path d=\"M12 12V8\" />\r\n            </>\r\n        ),\r\n        mic: (\r\n            <>\r\n                <path d=\"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z\" />\r\n                <path d=\"M19 10v2a7 7 0 0 1-14 0v-2\" />\r\n                <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"22\" />\r\n            </>\r\n        ),\r\n        insights: (\r\n            <>\r\n                <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" />\r\n                <path d=\"M3 9h18M9 21V9\" />\r\n            </>\r\n        ),\r\n        cpu: (\r\n            <>\r\n                <rect x=\"4\" y=\"4\" width=\"16\" height=\"16\" rx=\"2\" ry=\"2\"></rect>\r\n                <rect x=\"9\" y=\"9\" width=\"6\" height=\"6\"></rect>\r\n                <line x1=\"9\" y1=\"1\" x2=\"9\" y2=\"4\"></line>\r\n                <line x1=\"15\" y1=\"1\" x2=\"15\" y2=\"4\"></line>\r\n                <line x1=\"9\" y1=\"20\" x2=\"9\" y2=\"23\"></line>\r\n                <line x1=\"15\" y1=\"20\" x2=\"15\" y2=\"23\"></line>\r\n                <line x1=\"20\" y1=\"9\" x2=\"23\" y2=\"9\"></line>\r\n                <line x1=\"20\" y1=\"14\" x2=\"23\" y2=\"14\"></line>\r\n                <line x1=\"1\" y1=\"9\" x2=\"4\" y2=\"9\"></line>\r\n                <line x1=\"1\" y1=\"14\" x2=\"4\" y2=\"14\"></line>\r\n            </>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"relative flex h-full w-full items-center justify-center rounded-2xl p-4 group hover:scale-105 transition-all duration-500\" style={{ pointerEvents: 'auto' }}>\r\n            <div className=\"absolute inset-0 bg-gradient-to-r from-[#E53A3A]/20 to-[#D98C1F]/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500\" style={{ pointerEvents: 'none' }}></div>\r\n            <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                width=\"60\"\r\n                height=\"60\"\r\n                viewBox=\"0 0 24 24\"\r\n                fill=\"none\"\r\n                stroke=\"url(#feature-gradient)\"\r\n                strokeWidth=\"1.5\"\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                className=\"opacity-60 group-hover:opacity-100 transition-opacity duration-500\"\r\n            >\r\n                <defs>\r\n                    <linearGradient id=\"feature-gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n                        <stop offset=\"0%\" stopColor=\"#E53A3A\" />\r\n                        <stop offset=\"100%\" stopColor=\"#D98C1F\" />\r\n                    </linearGradient>\r\n                </defs>\r\n                {icons[icon]}\r\n            </svg>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst Feature = React.memo(({ title, description, icon, image, isGemini }: { title: React.ReactNode, description: string, icon?: 'eye' | 'bookmark' | 'network' | 'mic' | 'insights' | 'cpu', image?: string, isGemini?: boolean }) => {\r\n        return (\r\n        <div className=\"flex flex-col items-center text-center group p-6 rounded-2xl md:hover:bg-gradient-to-br md:hover:from-neutral-800/20 md:hover:to-neutral-900/20 transition-all duration-500\">\r\n            <div className={`w-full max-w-4xl aspect-video min-h-[300px] md:min-h-[400px] mb-6 animate-fade-slide-up md:group-hover:scale-105 transition-transform duration-500 ${isGemini ? 'bg-transparent flex items-center justify-center' : ''}`}>\r\n                {image ? (\r\n                    isGemini ? (\r\n                        <div className=\"w-full max-w-md aspect-[5/6] flex items-center justify-center bg-transparent\">\r\n                            <img \r\n                                src={image} \r\n                                alt={typeof title === 'string' ? title : ''} \r\n                                className=\"w-1/2 h-1/2 object-contain\"\r\n                                loading=\"lazy\"\r\n                                decoding=\"async\"\r\n                                onError={(e) => {\r\n                                    console.error(' Image failed to load:', image, e);\r\n                                    console.error(' Image element:', e.target);\r\n                                }}\r\n                                onLoad={() => console.log(' Image loaded successfully:', image)}\r\n                                style={{ \r\n                                    display: 'block',\r\n                                    imageRendering: 'crisp-edges',\r\n                                    WebkitFontSmoothing: 'antialiased',\r\n                                    backfaceVisibility: 'hidden',\r\n                                    transform: 'translateZ(0)'\r\n                                }}\r\n                            />\r\n                        </div>\r\n                    ) : (\r\n                        <img \r\n                            src={image} \r\n                            alt={typeof title === 'string' ? title : ''} \r\n                            className=\"w-full h-full object-contain\"\r\n                            loading=\"lazy\"\r\n                            decoding=\"async\"\r\n                            onError={(e) => {\r\n                                console.error(' Image failed to load:', image, e);\r\n                                console.error(' Image element:', e.target);\r\n                            }}\r\n                            onLoad={() => console.log(' Image loaded successfully:', image)}\r\n                            style={{ \r\n                                display: 'block',\r\n                                imageRendering: 'crisp-edges',\r\n                                WebkitFontSmoothing: 'antialiased',\r\n                                backfaceVisibility: 'hidden',\r\n                                transform: 'translateZ(0)'\r\n                            }}\r\n                        />\r\n                    )\r\n                ) : icon ? (\r\n                    <FeatureIcon icon={icon} />\r\n                ) : null}\r\n            </div>\r\n            <div className=\"animate-fade-slide-up md:group-hover:translate-y-1 transition-transform duration-500\">\r\n                <h3 className=\"text-2xl lg:text-3xl font-bold tracking-tight text-white mb-4 leading-tight md:group-hover:text-transparent md:group-hover:bg-clip-text md:group-hover:bg-gradient-to-r md:group-hover:from-[#E53A3A] md:group-hover:to-[#D98C1F] transition-all duration-500\">{title}</h3>\r\n                <p className=\"text-lg text-neutral-300 leading-relaxed md:group-hover:text-neutral-200 transition-colors duration-500\">{description}</p>\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nconst FeaturesCarousel = ({ features }: { features: Array<{ title: string; description: string; image: string; isGemini?: boolean }> }) => {\r\n    const autoplayOptions = {\r\n        delay: 5000,\r\n        stopOnInteraction: true,\r\n        stopOnMouseEnter: true,\r\n        playOnInit: true\r\n    };\r\n\r\n    const [emblaRef, emblaApi] = useEmblaCarousel(\r\n        { \r\n            loop: true,\r\n            align: 'start',\r\n            slidesToScroll: 1,\r\n            skipSnaps: false,\r\n            dragFree: false,\r\n            containScroll: 'trimSnaps',\r\n            breakpoints: {\r\n                '(min-width: 768px)': { \r\n                    align: 'start'\r\n                }\r\n            }\r\n        },\r\n        [Autoplay(autoplayOptions)]\r\n    );\r\n    \r\n    const [selectedIndex, setSelectedIndex] = useState(0);\r\n    const [scrollSnaps, setScrollSnaps] = useState<number[]>([]);\r\n    const [isMobile, setIsMobile] = useState(false);\r\n\r\n    // Detect mobile screen size\r\n    useEffect(() => {\r\n        const checkMobile = () => {\r\n            setIsMobile(window.innerWidth < 768);\r\n        };\r\n        checkMobile();\r\n        window.addEventListener('resize', checkMobile);\r\n        return () => window.removeEventListener('resize', checkMobile);\r\n    }, []);\r\n\r\n    const scrollPrev = useCallback(() => {\r\n        if (emblaApi) emblaApi.scrollPrev();\r\n    }, [emblaApi]);\r\n    \r\n    const scrollNext = useCallback(() => {\r\n        if (emblaApi) emblaApi.scrollNext();\r\n    }, [emblaApi]);\r\n    \r\n    const scrollTo = useCallback((index: number) => {\r\n        if (emblaApi) emblaApi.scrollTo(index);\r\n    }, [emblaApi]);\r\n\r\n    const onSelect = useCallback(() => {\r\n        if (!emblaApi) return;\r\n        setSelectedIndex(emblaApi.selectedScrollSnap());\r\n    }, [emblaApi]);\r\n\r\n    useEffect(() => {\r\n        if (!emblaApi) return;\r\n        onSelect();\r\n        setScrollSnaps(emblaApi.scrollSnapList());\r\n        emblaApi.on('select', onSelect);\r\n        emblaApi.on('reInit', onSelect);\r\n        \r\n        return () => {\r\n            emblaApi.off('select', onSelect);\r\n            emblaApi.off('reInit', onSelect);\r\n        };\r\n    }, [emblaApi, onSelect]);\r\n\r\n    // On mobile: show 1 item per slide, on desktop: show 2 items per slide\r\n    const slidesToShow = isMobile ? features : (() => {\r\n        const grouped = [];\r\n        for (let i = 0; i < features.length; i += 2) {\r\n            grouped.push(features.slice(i, i + 2));\r\n        }\r\n        return grouped;\r\n    })();\r\n\r\n    return (\r\n        <div className=\"relative px-4 md:px-0\">\r\n            {/* Embla Container */}\r\n            <div className=\"overflow-hidden\" ref={emblaRef}>\r\n                <div className=\"flex touch-pan-y touch-pinch-zoom -ml-4\">\r\n                    {isMobile ? (\r\n                        // Mobile: 1 item per slide\r\n                        features.map((feature, index) => (\r\n                            <div \r\n                                key={index} \r\n                                className=\"flex-[0_0_100%] min-w-0 pl-4\"\r\n                            >\r\n                                <Feature\r\n                                    title={feature.title}\r\n                                    description={feature.description}\r\n                                    image={feature.image}\r\n                                    isGemini={feature.isGemini}\r\n                                />\r\n                            </div>\r\n                        ))\r\n                    ) : (\r\n                        // Desktop: 2 items per slide\r\n                        slidesToShow.map((group, slideIndex) => (\r\n                            <div \r\n                                key={slideIndex} \r\n                                className=\"flex-[0_0_100%] min-w-0 pl-4\"\r\n                            >\r\n                                <div className=\"grid grid-cols-2 gap-8\">\r\n                                    {Array.isArray(group) && group.map((feature, idx) => (\r\n                                        <Feature\r\n                                            key={slideIndex * 2 + idx}\r\n                                            title={feature.title}\r\n                                            description={feature.description}\r\n                                            image={feature.image}\r\n                                            isGemini={feature.isGemini}\r\n                                        />\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        ))\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Navigation Arrows */}\r\n            <button\r\n                onClick={scrollPrev}\r\n                className=\"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-3 md:-translate-x-16 lg:-translate-x-20 bg-transparent border-2 border-[#E53A3A] text-[#E53A3A] p-2 md:p-3 rounded-lg md:hover:bg-gradient-to-r md:hover:from-[#E53A3A] md:hover:to-[#D98C1F] md:hover:text-white md:hover:border-transparent md:hover:shadow-2xl md:hover:shadow-[#E53A3A]/50 md:hover:scale-110 active:scale-95 focus:bg-transparent focus:outline-none transition-[background,transform,shadow,opacity] duration-300 z-10 disabled:opacity-30 disabled:cursor-not-allowed backdrop-blur-sm opacity-40 md:hover:opacity-100\"\r\n                aria-label=\"Previous slide\"\r\n            >\r\n                <svg className=\"w-5 h-5 md:w-8 md:h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"3\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 19l-7-7 7-7\" />\r\n                </svg>\r\n            </button>\r\n            <button\r\n                onClick={scrollNext}\r\n                className=\"absolute right-0 top-1/2 -translate-y-1/2 translate-x-3 md:translate-x-16 lg:translate-x-20 bg-transparent border-2 border-[#E53A3A] text-[#E53A3A] p-2 md:p-3 rounded-lg md:hover:bg-gradient-to-r md:hover:from-[#E53A3A] md:hover:to-[#D98C1F] md:hover:text-white md:hover:border-transparent md:hover:shadow-2xl md:hover:shadow-[#E53A3A]/50 md:hover:scale-110 active:scale-95 focus:bg-transparent focus:outline-none transition-[background,transform,shadow,opacity] duration-300 z-10 disabled:opacity-30 disabled:cursor-not-allowed backdrop-blur-sm opacity-40 md:hover:opacity-100\"\r\n                aria-label=\"Next slide\"\r\n            >\r\n                <svg className=\"w-5 h-5 md:w-8 md:h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"3\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\r\n                </svg>\r\n            </button>\r\n\r\n            {/* Pagination Dots */}\r\n            <div className=\"hidden md:flex justify-center gap-3 mt-8\">\r\n                {scrollSnaps.map((_, idx) => (\r\n                    <button\r\n                        key={idx}\r\n                        onClick={() => scrollTo(idx)}\r\n                        className={`transition-all duration-300 rounded-full ${\r\n                            idx === selectedIndex\r\n                                ? 'w-12 h-3 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F]'\r\n                                : 'w-3 h-3 bg-neutral-600 hover:bg-neutral-500'\r\n                        }`}\r\n                        aria-label={`Go to slide ${idx + 1}`}\r\n                        aria-current={idx === selectedIndex ? 'true' : 'false'}\r\n                    />\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst FeatureListItem = ({ children }: { children: React.ReactNode }) => (\r\n    <li className=\"flex items-start gap-4\">\r\n        <CheckIcon className=\"w-6 h-6 mt-1 text-green-500 flex-shrink-0\" />\r\n        <span className=\"text-neutral-200 text-base leading-relaxed\">{children}</span>\r\n    </li>\r\n);\r\n\r\nconst VanguardFeatureListItem = ({ children, comingSoon = false }: { children: React.ReactNode, comingSoon?: boolean }) => (\r\n    <li className=\"flex items-start gap-4\">\r\n        <StarIcon className=\"w-6 h-6 mt-1 text-[#FFAB40] flex-shrink-0\" />\r\n        <div className=\"flex-1\">\r\n            <span className=\"text-neutral-200 font-medium text-base leading-relaxed block\">\r\n                {children}\r\n            </span>\r\n            {comingSoon && (\r\n                <span className=\"inline-block mt-2 text-xs font-semibold bg-gradient-to-r from-sky-500/20 to-blue-500/20 text-sky-300 border-2 border-sky-500/40 px-3 py-1 rounded-full uppercase\">Coming Soon</span>\r\n            )}\r\n        </div>\r\n    </li>\r\n);\r\n\r\nconst QuoteIcon = () => (\r\n    <svg className=\"w-12 h-12 text-neutral-600 mb-6\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n        <path d=\"M6.5,10c0,2.21-1.79,4-4,4v-2c1.1,0,2-0.9,2-2h-2V4h6V10z M18.5,10c0,2.21-1.79,4-4,4v-2c1.1,0,2-0.9,2-2h-2V4h6V10z\"></path>\r\n    </svg>\r\n);\r\n\r\nconst Testimonial = React.memo(({ quote, author, title, index, isVisible }: { quote: string, author: string, title: string, index: number, isVisible: boolean }) => (\r\n    <div \r\n        className={`bg-gradient-to-r from-[#1C1C1C]/60 to-[#0A0A0A]/60 backdrop-blur-xl border-0 md:border-2 rounded-3xl p-6 md:p-8 flex flex-col justify-between h-full animate-fade-slide-up transition-all duration-500 ${\r\n            isVisible \r\n                ? 'from-[#1C1C1C]/80 to-[#0A0A0A]/80 md:border-neutral-700/80 scale-105 shadow-2xl shadow-[#E53A3A]/10' \r\n                : 'md:border-neutral-800/60'\r\n        } md:hover:bg-gradient-to-r md:hover:from-[#1C1C1C]/80 md:hover:to-[#0A0A0A]/80 md:hover:border-neutral-700/80 md:hover:scale-105 md:hover:shadow-2xl md:hover:shadow-[#E53A3A]/10`}\r\n        style={{ transitionDelay: isVisible ? `${index * 150}ms` : '0ms' }}\r\n    >\r\n        <div className=\"mb-6\">\r\n            <QuoteIcon />\r\n            <p className=\"text-lg md:text-xl text-neutral-200 leading-relaxed\">\"{quote}\"</p>\r\n        </div>\r\n        <div>\r\n            <p className=\"font-bold text-white text-base md:text-lg\">{author}</p>\r\n            <p className=\"text-sm md:text-base text-neutral-400\">{title}</p>\r\n        </div>\r\n    </div>\r\n));\r\n\r\nconst TestimonialsCarousel = ({ testimonials }: { testimonials: Array<{ quote: string; author: string; title: string }> }) => {\r\n    const autoplayOptions = {\r\n        delay: 5000,\r\n        stopOnInteraction: true,\r\n        stopOnMouseEnter: true,\r\n        playOnInit: true\r\n    };\r\n\r\n    const [emblaRef, emblaApi] = useEmblaCarousel(\r\n        { \r\n            loop: true,\r\n            align: 'center',\r\n            slidesToScroll: 1,\r\n            skipSnaps: false,\r\n            dragFree: false,\r\n            containScroll: 'trimSnaps',\r\n            duration: 25\r\n        },\r\n        [Autoplay(autoplayOptions)]\r\n    );\r\n    \r\n    const [selectedIndex, setSelectedIndex] = useState(0);\r\n    const [scrollSnaps, setScrollSnaps] = useState<number[]>([]);\r\n\r\n    const scrollPrev = useCallback(() => {\r\n        if (emblaApi) emblaApi.scrollPrev();\r\n    }, [emblaApi]);\r\n    \r\n    const scrollNext = useCallback(() => {\r\n        if (emblaApi) emblaApi.scrollNext();\r\n    }, [emblaApi]);\r\n    \r\n    const scrollTo = useCallback((index: number) => {\r\n        if (emblaApi) emblaApi.scrollTo(index);\r\n    }, [emblaApi]);\r\n\r\n    const onSelect = useCallback(() => {\r\n        if (!emblaApi) return;\r\n        setSelectedIndex(emblaApi.selectedScrollSnap());\r\n    }, [emblaApi]);\r\n\r\n    useEffect(() => {\r\n        if (!emblaApi) return;\r\n        onSelect();\r\n        setScrollSnaps(emblaApi.scrollSnapList());\r\n        emblaApi.on('select', onSelect);\r\n        emblaApi.on('reInit', onSelect);\r\n        \r\n        return () => {\r\n            emblaApi.off('select', onSelect);\r\n            emblaApi.off('reInit', onSelect);\r\n        };\r\n    }, [emblaApi, onSelect]);\r\n\r\n    return (\r\n        <div className=\"relative\">\r\n            {/* Carousel Container */}\r\n            <div className=\"overflow-hidden\" ref={emblaRef}>\r\n                <div className=\"flex touch-pan-y touch-pinch-zoom\">\r\n                    {testimonials.map((testimonial, index) => (\r\n                        <div \r\n                            key={index}\r\n                            className=\"flex-[0_0_100%] min-w-0 px-4\"\r\n                        >\r\n                            <Testimonial\r\n                                quote={testimonial.quote}\r\n                                author={testimonial.author}\r\n                                title={testimonial.title}\r\n                                index={index}\r\n                                isVisible={true}\r\n                            />\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Navigation Arrows - Below on mobile, overlaid on desktop */}\r\n            <div className=\"flex justify-center gap-4 mt-6 md:hidden\">\r\n                <button\r\n                    onClick={scrollPrev}\r\n                    className=\"bg-transparent border-2 border-[#E53A3A] text-[#E53A3A] p-3 rounded-lg active:bg-gradient-to-r active:from-[#E53A3A] active:to-[#D98C1F] active:text-white active:border-transparent md:hover:bg-gradient-to-r md:hover:from-[#E53A3A] md:hover:to-[#D98C1F] md:hover:text-white md:hover:border-transparent md:hover:shadow-2xl md:hover:shadow-[#E53A3A]/50 md:hover:scale-110 active:scale-95 focus:outline-none transition-[background,transform,shadow,opacity,border,color] duration-300 disabled:opacity-30 disabled:cursor-not-allowed backdrop-blur-sm\"\r\n                    aria-label=\"Previous testimonial\"\r\n                >\r\n                    <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"3\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 19l-7-7 7-7\" />\r\n                    </svg>\r\n                </button>\r\n                <button\r\n                    onClick={scrollNext}\r\n                    className=\"bg-transparent border-2 border-[#E53A3A] text-[#E53A3A] p-3 rounded-lg active:bg-gradient-to-r active:from-[#E53A3A] active:to-[#D98C1F] active:text-white active:border-transparent md:hover:bg-gradient-to-r md:hover:from-[#E53A3A] md:hover:to-[#D98C1F] md:hover:text-white md:hover:border-transparent md:hover:shadow-2xl md:hover:shadow-[#E53A3A]/50 md:hover:scale-110 active:scale-95 focus:outline-none transition-[background,transform,shadow,opacity,border,color] duration-300 disabled:opacity-30 disabled:cursor-not-allowed backdrop-blur-sm\"\r\n                    aria-label=\"Next testimonial\"\r\n                >\r\n                    <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"3\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\r\n                    </svg>\r\n                </button>\r\n            </div>\r\n\r\n            {/* Desktop overlaid buttons */}\r\n            <button\r\n                onClick={scrollPrev}\r\n                className=\"hidden md:block absolute left-2 top-1/2 -translate-y-1/2 bg-transparent border-2 border-[#E53A3A] text-[#E53A3A] p-2 rounded-lg md:hover:bg-gradient-to-r md:hover:from-[#E53A3A] md:hover:to-[#D98C1F] md:hover:text-white md:hover:border-transparent md:hover:shadow-2xl md:hover:shadow-[#E53A3A]/50 md:hover:scale-110 active:scale-95 focus:outline-none transition-[background,transform,shadow,opacity,border,color] duration-300 z-10 disabled:opacity-30 disabled:cursor-not-allowed backdrop-blur-sm opacity-60 md:hover:opacity-100\"\r\n                aria-label=\"Previous testimonial\"\r\n            >\r\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"3\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 19l-7-7 7-7\" />\r\n                </svg>\r\n            </button>\r\n            <button\r\n                onClick={scrollNext}\r\n                className=\"hidden md:block absolute right-2 top-1/2 -translate-y-1/2 bg-transparent border-2 border-[#E53A3A] text-[#E53A3A] p-2 rounded-lg md:hover:bg-gradient-to-r md:hover:from-[#E53A3A] md:hover:to-[#D98C1F] md:hover:text-white md:hover:border-transparent md:hover:shadow-2xl md:hover:shadow-[#E53A3A]/50 md:hover:scale-110 active:scale-95 focus:outline-none transition-[background,transform,shadow,opacity,border,color] duration-300 z-10 disabled:opacity-30 disabled:cursor-not-allowed backdrop-blur-sm opacity-60 md:hover:opacity-100\"\r\n                aria-label=\"Next testimonial\"\r\n            >\r\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"3\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\r\n                </svg>\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n\r\ninterface LandingPageProps {\r\n  onGetStarted: () => void;\r\n  onOpenAbout: () => void;\r\n  onOpenPrivacy: () => void;\r\n  onOpenRefund: () => void;\r\n  onOpenTerms: () => void;\r\n  onOpenContact: () => void;\r\n  onDirectNavigation: (_path: string) => void;\r\n}\r\n\r\nconst LandingPage: React.FC<LandingPageProps> = ({ onGetStarted, onOpenAbout, onOpenPrivacy, onOpenRefund, onOpenTerms, onOpenContact, onDirectNavigation }) => {\r\n  const [email, setEmail] = useState('');\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [submitMessage, setSubmitMessage] = useState('');\r\n\r\n  const [scrollY, setScrollY] = useState(0);\r\n  const backgroundRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Scroll animation states for mobile\r\n  const [chatHintVisible, setChatHintVisible] = useState(false);\r\n  const [testimonialsVisible, setTestimonialsVisible] = useState<Record<number, boolean>>({});\r\n  \r\n  // Refs for IntersectionObserver\r\n  const chatHintRef = useRef<HTMLDivElement>(null);\r\n  const testimonialRefs = useRef<(HTMLDivElement | null)[]>([]);\r\n\r\n    // Handle direct URL navigation on component mount\r\n    useEffect(() => {\r\n        const path = window.location.pathname;\r\n        if (path !== '/' && path !== '') {\r\n            onDirectNavigation(path);\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []); // Only run once on mount to check initial URL\r\n\r\n    // Prevent PWA install prompt on landing page\r\n    useEffect(() => {\r\n        const preventInstallPrompt = (e: Event) => {\r\n            e.preventDefault();\r\n            console.log(' [Landing Page] Prevented PWA install prompt - only show on login/app');\r\n        };\r\n        \r\n        window.addEventListener('beforeinstallprompt', preventInstallPrompt);\r\n        \r\n        return () => {\r\n            window.removeEventListener('beforeinstallprompt', preventInstallPrompt);\r\n        };\r\n    }, []);\r\n\r\n    // Parallax scroll effect\r\n    useEffect(() => {\r\n        const handleScroll = () => {\r\n            setScrollY(window.scrollY);\r\n        };\r\n\r\n        window.addEventListener('scroll', handleScroll);\r\n        return () => window.removeEventListener('scroll', handleScroll);\r\n    }, []);\r\n\r\n    // Scroll animations for mobile only\r\n    useEffect(() => {\r\n        const isMobile = window.innerWidth < 768;\r\n        if (!isMobile) return;\r\n\r\n        const observerOptions: IntersectionObserverInit = {\r\n            threshold: 0.6,\r\n            rootMargin: '0px'\r\n        };\r\n\r\n        const chatObserverOptions: IntersectionObserverInit = {\r\n            threshold: 0.7,\r\n            rootMargin: '0px'\r\n        };\r\n\r\n        const handleIntersection = (\r\n            entries: IntersectionObserverEntry[],\r\n            setter: React.Dispatch<React.SetStateAction<boolean>> | React.Dispatch<React.SetStateAction<Record<number, boolean>>>,\r\n            index?: number\r\n        ) => {\r\n            entries.forEach((entry) => {\r\n                if (typeof index === 'number') {\r\n                    (setter as React.Dispatch<React.SetStateAction<Record<number, boolean>>>)((prev) => ({\r\n                        ...prev,\r\n                        [index]: entry.isIntersecting\r\n                    }));\r\n                } else {\r\n                    (setter as React.Dispatch<React.SetStateAction<boolean>>)(entry.isIntersecting);\r\n                }\r\n            });\r\n        };\r\n\r\n        const chatObserver = new IntersectionObserver(\r\n            (entries) => handleIntersection(entries, setChatHintVisible),\r\n            chatObserverOptions\r\n        );\r\n\r\n        if (chatHintRef.current) {\r\n            chatObserver.observe(chatHintRef.current);\r\n        }\r\n\r\n        const testimonialObservers = testimonialRefs.current.map((ref, index) => {\r\n            if (!ref) return null;\r\n            const observer = new IntersectionObserver(\r\n                (entries) => handleIntersection(entries, setTestimonialsVisible, index),\r\n                observerOptions\r\n            );\r\n            observer.observe(ref);\r\n            return observer;\r\n        });\r\n\r\n        return () => {\r\n            chatObserver.disconnect();\r\n            testimonialObservers.forEach((observer) => observer?.disconnect());\r\n        };\r\n    }, []);\r\n\r\n  const handleWaitlistSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!email) {\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    setSubmitMessage('');\r\n\r\n    try {\r\n      const result = await WaitlistService.addToWaitlist(email, 'landing_page');\r\n      \r\n      if (result.success) {\r\n        if (result.alreadyExists) {\r\n          setSubmitMessage('You\\'re already on our waitlist! We\\'ll email you when access is ready.');\r\n        } else {\r\n          setSubmitMessage('Thanks for joining! We\\'ll email you when access is ready.');\r\n        }\r\n        setEmail('');\r\n      } else {\r\n        setSubmitMessage(result.error || 'Failed to join waitlist. Please try again.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Waitlist submission error:', error);\r\n      toastService.error('Failed to join waitlist. Please try again.');\r\n      setSubmitMessage('An unexpected error occurred. Please try again.');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n    const handleScrollTo = (id: string) => (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });\r\n    };\r\n\r\n  return (\r\n        <div \r\n            ref={backgroundRef}\r\n            className=\"text-white font-inter relative custom-scrollbar animate-fade-in\"\r\n            style={{\r\n                backgroundColor: '#111111',\r\n                minHeight: '100vh',\r\n                height: 'auto',\r\n                overflowX: 'hidden',\r\n                overflowY: 'auto',\r\n                WebkitOverflowScrolling: 'touch'\r\n            }}\r\n        >\r\n            {/* Enhanced Background Glows */}\r\n            <div className=\"absolute top-0 left-0 w-full h-full -z-15 pointer-events-none hero-glow-texture-top\"></div>\r\n            <div className=\"absolute bottom-0 left-0 w-full h-full -z-15 pointer-events-none hero-glow-texture-bottom\"></div>\r\n            \r\n            {/* Animated Floating Particles with Parallax */}\r\n            <div className=\"absolute inset-0 -z-12 pointer-events-none\">\r\n                {[...Array(40)].map((_, i) => (\r\n                    <div\r\n                        key={i}\r\n                        className=\"absolute w-1 h-1 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-full opacity-40 animate-float\"\r\n                        style={{\r\n                            left: `${Math.random() * 100}%`,\r\n                            top: `${Math.random() * 100}%`,\r\n                            transform: `translateY(${scrollY * (0.2 + Math.random() * 0.4)}px)`,\r\n                            animationDelay: `${Math.random() * 3}s`,\r\n                            animationDuration: `${4 + Math.random() * 4}s`\r\n                        }}\r\n                    />\r\n                ))}\r\n          </div>\r\n          \r\n            {/* Floating Geometric Shapes with Parallax */}\r\n            <div className=\"absolute inset-0 -z-12 pointer-events-none\">\r\n                {[...Array(16)].map((_, i) => (\r\n                    <div\r\n                        key={`shape-${i}`}\r\n                        className=\"absolute opacity-15 animate-drift\"\r\n                        style={{\r\n                            left: `${Math.random() * 100}%`,\r\n                            top: `${Math.random() * 100}%`,\r\n                            transform: `translateY(${scrollY * (0.1 + Math.random() * 0.3)}px)`,\r\n                            animationDelay: `${Math.random() * 4}s`,\r\n                            animationDuration: `${6 + Math.random() * 4}s`\r\n                        }}\r\n                    >\r\n                        <div className=\"w-4 h-4 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] transform rotate-45\"></div>\r\n          </div>\r\n                ))}\r\n        </div>\r\n\r\n            {/* Full Page Grid Pattern */}\r\n            <div \r\n                className=\"absolute inset-0 -z-10 opacity-10 pointer-events-none\"\r\n                style={{\r\n                    background: 'linear-gradient(90deg, #FF4D4D10 1px, transparent 1px), linear-gradient(0deg, #FF4D4D10 1px, transparent 1px)',\r\n                    backgroundSize: '30px 30px',\r\n                }}\r\n            ></div>\r\n\r\n            {/* Fade out gradients for background pattern */}\r\n            <div className=\"absolute top-0 left-0 w-full h-64 bg-gradient-to-b from-[#111111] via-[#111111]/80 to-transparent -z-5 pointer-events-none\"></div>\r\n            <div className=\"absolute bottom-0 left-0 w-full h-64 bg-gradient-to-t from-[#111111] via-[#111111]/80 to-transparent -z-5 pointer-events-none\"></div>\r\n\r\n            {/* Main Content */}\r\n            <main>\r\n      {/* Hero Section */}\r\n                <section className=\"relative pt-20 pb-6 md:pb-8 text-center\">\r\n                    \r\n                    <div className=\"container mx-auto px-6 relative overflow-visible\">\r\n                        <div className=\"flex flex-col items-center justify-center gap-4 mb-10 overflow-visible\">\r\n                            <Logo className=\"h-32 w-32\" spinOnce={true} />\r\n                            <h1 \r\n                                className=\"text-6xl md:text-7xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] leading-none py-2\"\r\n                                style={{\r\n                                    lineHeight: '1.3',\r\n                                    paddingTop: '1rem',\r\n                                    paddingBottom: '1rem',\r\n                                    display: 'block',\r\n                                    overflow: 'visible',\r\n                                    minHeight: '1.3em',\r\n                                    height: 'auto'\r\n                                }}\r\n                            >\r\n              Otagon\r\n            </h1>\r\n          </div>\r\n          \r\n                        <h2 className=\"text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-bold tracking-tight mb-6 text-white leading-tight\">\r\n                            Never Get Stuck Again\r\n                        </h2>\r\n                        \r\n                        <p className=\"text-lg sm:text-xl md:text-2xl lg:text-3xl text-neutral-300 mb-8 font-medium px-4\">\r\n                            Get instant, spoiler-free hints without leaving your game\r\n                        </p>\r\n                        \r\n                        {/* Social Proof */}\r\n                        <div className=\"flex flex-col sm:flex-row items-center justify-center gap-6 mb-8\">\r\n                            <div className=\"flex items-center gap-2 text-lg text-neutral-300\">\r\n                                <div className=\"flex -space-x-2\">\r\n                                    {[...Array(5)].map((_, i) => (\r\n                                        <div key={i} className=\"w-8 h-8 rounded-full overflow-hidden\">\r\n                                            <img \r\n                                                src={`/images/landing/${i + 1}.png`}\r\n                                                alt={`Gamer ${i + 1}`}\r\n                                                className=\"w-full h-full rounded-full object-cover\"\r\n                                            />\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                                <span className=\"ml-2\">\r\n                                    <span className=\"font-bold text-white\">1000+</span> gamers waiting\r\n                                </span>\r\n                            </div>\r\n                            <div className=\"hidden sm:block w-px h-6 bg-neutral-600\"></div>\r\n                            <div className=\"flex items-center gap-2 text-lg text-neutral-300\">\r\n                                <svg className=\"w-5 h-5 text-[#FFAB40]\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path d=\"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z\"/>\r\n                                </svg>\r\n                                <span>Trusted by <span className=\"font-bold text-white\">50+</span> beta testers</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div \r\n                            ref={chatHintRef}\r\n                            className={`relative mx-auto my-16 w-full max-w-2xl h-auto rounded-3xl bg-black/60 backdrop-blur-xl p-2 shadow-2xl border-2 transition-all duration-500 ${\r\n                                chatHintVisible \r\n                                    ? 'border-[#E53A3A]/60 shadow-2xl shadow-[#E53A3A]/25 scale-105' \r\n                                    : 'border-[#424242]/40'\r\n                            } md:group md:hover:border-[#E53A3A]/60 md:hover:shadow-2xl md:hover:shadow-[#E53A3A]/25 md:hover:scale-105`}\r\n                            style={{\r\n                                animation: 'glow 2s ease-in-out infinite alternate',\r\n                                boxShadow: chatHintVisible ? '0 0 20px rgba(229, 58, 58, 0.5), 0 0 40px rgba(229, 58, 58, 0.3), 0 0 60px rgba(229, 58, 58, 0.2)' : '0 0 20px rgba(229, 58, 58, 0.3), 0 0 40px rgba(229, 58, 58, 0.1), 0 0 60px rgba(229, 58, 58, 0.1)'\r\n                            }}\r\n                        >\r\n                            <div className=\"bg-transparent rounded-2xl p-6 space-y-6\">\r\n                                {/* User Prompt */}\r\n                                <div className=\"flex justify-end\">\r\n                                    <p className=\"text-base text-[#F5F5F5] bg-gradient-to-r from-rose-900/15 to-rose-800/15 py-3 px-6 rounded-2xl rounded-br-none border-2 border-rose-500/40 backdrop-blur-sm shadow-lg\">\r\n                                        What should I do here?\r\n                                    </p>\r\n                                </div>\r\n                                {/* Model Response */}\r\n                                <div className=\"flex justify-start\">\r\n                                    <div className=\"border-2 border-neutral-700/60 bg-gradient-to-r from-neutral-800/15 to-neutral-700/15 p-6 rounded-2xl rounded-bl-none max-w-[80%] text-left backdrop-blur-sm shadow-lg\">\r\n                                        <p className=\"text-base font-bold text-white mb-2\">Hint:</p>\r\n                                        <p className=\"text-base text-[#F5F5F5] leading-relaxed\">\r\n                                        The contraption on the far wall seems to be missing a gear. Perhaps there's one nearby?\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n          </div>\r\n        </div>\r\n                        \r\n                        <p className=\"text-xl md:text-2xl text-neutral-300 max-w-4xl mx-auto mb-8 leading-relaxed\">\r\n              Otagon sees your screen and gives you the perfect nudge to keep you playingwithout ruining the surprise. Stop searching, start playing.\r\n            </p>\r\n\r\n                        {/* Enhanced Waitlist Form */}\r\n                        <div className=\"max-w-2xl mx-auto px-4\">\r\n                            <form id=\"waitlist-form\" onSubmit={handleWaitlistSubmit} className=\"flex flex-col sm:flex-row gap-4 mb-4\">\r\n                                <div className=\"flex-grow relative group\">\r\n            <input\r\n              type=\"email\"\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              placeholder=\"Enter your email address\"\r\n              required\r\n              disabled={isSubmitting}\r\n                                        className=\"w-full bg-gradient-to-r from-[#1C1C1C] to-[#0A0A0A] border-2 border-neutral-800/60 rounded-xl py-4 sm:py-5 px-4 sm:px-6 text-white placeholder-neutral-400 focus:outline-none focus:ring-4 focus:ring-[#FFAB40]/30 focus:border-[#FFAB40] transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed text-base sm:text-lg backdrop-blur-sm hover:border-neutral-700/80\"\r\n              aria-label=\"Email for waitlist\"\r\n            />\r\n                                </div>\r\n                                <button\r\n              type=\"submit\"\r\n              disabled={isSubmitting}\r\n                                    className=\"bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] text-white font-bold py-4 sm:py-5 px-8 sm:px-12 rounded-xl transition-all duration-300 transform md:hover:scale-105 md:hover:shadow-2xl md:hover:shadow-[#E53A3A]/30 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:active:scale-100 text-base sm:text-lg relative overflow-hidden group min-h-[56px]\"\r\n                                >\r\n                                    <div className=\"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300\"></div>\r\n                                    <span className=\"relative z-10\">\r\n                                        {isSubmitting ? (\r\n                                            <div className=\"flex items-center justify-center\">\r\n                                                <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3\"></div>\r\n                                                Joining...\r\n                                            </div>\r\n                                        ) : (\r\n                                            'Join the Waitlist'\r\n                                        )}\r\n                                    </span>\r\n                                </button>\r\n          </form>\r\n\r\n                            {/* Trust Indicators */}\r\n                            <div className=\"flex flex-col sm:flex-row items-center justify-center gap-6 text-sm text-neutral-400\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <CheckIcon className=\"w-4 h-4 text-green-400\" />\r\n                                    <span>No spam, ever</span>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <CheckIcon className=\"w-4 h-4 text-green-400\" />\r\n                                    <span>Free to join</span>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <CheckIcon className=\"w-4 h-4 text-green-400\" />\r\n                                    <span>Early access</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n          {submitMessage && (\r\n                            <div className={`mt-6 text-center text-lg ${submitMessage.includes('Thanks') ? 'text-green-400' : 'text-red-400'}`}>\r\n              {submitMessage}\r\n            </div>\r\n          )}\r\n\r\n                        <p className=\"text-sm text-neutral-400 mt-4\">\r\n                            Join thousands of gamers on the waitlist!\r\n                        </p>\r\n                    </div>\r\n                </section>\r\n\r\n                {/* How It Works Section */}\r\n                <section className=\"py-10 md:py-14 bg-transparent relative\">\r\n                    <div className=\"container mx-auto px-8 max-w-6xl relative\">\r\n                        <div className=\"text-center mb-8 md:mb-10 animate-fade-slide-up\">\r\n                            <h2 className=\"text-5xl md:text-6xl font-bold tracking-tight text-white mb-6\">How It Works</h2>\r\n                            <p className=\"text-xl text-neutral-300 mt-6 leading-relaxed\">Get unstuck, get smart, get back to gamingall without leaving your game.</p>\r\n                        </div>\r\n                        \r\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-12\">\r\n                            {/* Step 1 */}\r\n                            <div className=\"text-center animate-fade-slide-up\">\r\n                                <div className=\"flex items-center justify-center mx-auto mb-6\">\r\n                                    <svg className=\"w-16 h-16\" fill=\"url(#keyboard-gradient)\" viewBox=\"0 0 16 16\">\r\n                                        <defs>\r\n                                            <linearGradient id=\"keyboard-gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n                                                <stop offset=\"0%\" stopColor=\"#E53A3A\" />\r\n                                                <stop offset=\"100%\" stopColor=\"#D98C1F\" />\r\n                                            </linearGradient>\r\n                                        </defs>\r\n                                        <path d=\"M0 6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6zm13 .25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25h-.5a.25.25 0 0 0-.25.25zM2.25 8a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5A.25.25 0 0 0 3 8.75v-.5A.25.25 0 0 0 2.75 8h-.5zM4 8.25v.5c0 .138.112.25.25.25h.5A.25.25 0 0 0 5 8.75v-.5A.25.25 0 0 0 4.75 8h-.5a.25.25 0 0 0-.25.25zM6.25 8a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5A.25.25 0 0 0 7 8.75v-.5A.25.25 0 0 0 6.75 8h-.5zM8 8.25v.5c0 .138.112.25.25.25h.5A.25.25 0 0 0 9 8.75v-.5A.25.25 0 0 0 8.75 8h-.5a.25.25 0 0 0-.25.25zM13.25 8a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25h-.5zm0 2a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25h-.5zm-3-2a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h1.5a.25.25 0 0 0 .25-.25v-.5A.25.25 0 0 0 10.75 8h-1.5zm.75 2.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25h-.5a.25.25 0 0 0-.25.25zM11.25 6a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25h-.5zM9 6.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5A.25.25 0 0 0 9.75 6h-.5a.25.25 0 0 0-.25.25zM7.25 6a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5A.25.25 0 0 0 8 6.75v-.5A.25.25 0 0 0 7.75 6h-.5zM5 6.25v.5c0 .138.112.25.25.25h.5A.25.25 0 0 0 6 6.75v-.5A.25.25 0 0 0 5.75 6h-.5a.25.25 0 0 0-.25.25zM2.25 6a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h1.5A.25.25 0 0 0 4 6.75v-.5A.25.25 0 0 0 3.75 6h-1.5zM2 10.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25h-.5a.25.25 0 0 0-.25.25zM4.25 10a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h5.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25h-5.5z\"/>\r\n                                    </svg>\r\n                                </div>\r\n                                <h3 className=\"text-2xl font-bold text-white mb-4\">Press a Hotkey on Your PC</h3>\r\n                                <p className=\"text-lg text-neutral-300 leading-relaxed\">\r\n                                    Instantly capture and analyze PC screenshots\r\n                                </p>\r\n                            </div>\r\n                            \r\n                            {/* Step 2 */}\r\n                            <div className=\"text-center animate-fade-slide-up\">\r\n                                <div className=\"flex items-center justify-center mx-auto mb-6\">\r\n                                    <svg className=\"w-16 h-16\" fill=\"url(#message-gradient)\" viewBox=\"0 0 24 24\">\r\n                                        <defs>\r\n                                            <linearGradient id=\"message-gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n                                                <stop offset=\"0%\" stopColor=\"#E53A3A\" />\r\n                                                <stop offset=\"100%\" stopColor=\"#D98C1F\" />\r\n                                            </linearGradient>\r\n                                        </defs>\r\n                                        <path d=\"M2 8.994A5.99 5.99 0 0 1 8 3h8c3.313 0 6 2.695 6 5.994V21H8c-3.313 0-6-2.695-6-5.994V8.994zM14 11v2h2v-2h-2zm-6 0v2h2v-2H8z\"/>\r\n                                    </svg>\r\n                                </div>\r\n                                <h3 className=\"text-2xl font-bold text-white mb-4\">Get an Instant Hint on Your Phone</h3>\r\n                                <p className=\"text-lg text-neutral-300 leading-relaxed\">\r\n                                    AI analyzes your situation and delivers spoiler-free hints to your mobile or second monitor\r\n                                </p>\r\n                            </div>\r\n                            \r\n                            {/* Step 3 */}\r\n                            <div className=\"text-center animate-fade-slide-up\">\r\n                                <div className=\"flex items-center justify-center mx-auto mb-6\">\r\n                                    <svg className=\"w-16 h-16\" fill=\"url(#joystick-gradient)\" viewBox=\"0 0 24 24\">\r\n                                        <defs>\r\n                                            <linearGradient id=\"joystick-gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n                                                <stop offset=\"0%\" stopColor=\"#E53A3A\" />\r\n                                                <stop offset=\"100%\" stopColor=\"#D98C1F\" />\r\n                                            </linearGradient>\r\n                                        </defs>\r\n                                        <path d=\"M16 6H8a6 6 0 0 0 0 12h8a6 6 0 0 0 0-12zm-5 7H9v2H7v-2H5v-2h2V9h2v2h2v2zm3.5 2a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3-3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z\"/>\r\n                                    </svg>\r\n                                </div>\r\n                                <h3 className=\"text-2xl font-bold text-white mb-4\">Keep Playing</h3>\r\n                                <p className=\"text-lg text-neutral-300 leading-relaxed\">\r\n                                    Get the nudge you need and dive back into action without alt-tabbing or overlays\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Features Section */}\r\n                <section id=\"features\" className=\"py-10 md:py-14 bg-transparent relative\">\r\n                    <div className=\"container mx-auto px-8 max-w-6xl relative\">\r\n                        <div className=\"text-center mb-8 md:mb-10 animate-fade-slide-up\">\r\n                            <h2 className=\"text-5xl md:text-6xl font-bold tracking-tight text-white mb-6 leading-tight\" style={{ lineHeight: '1.3', minHeight: '1.3em', height: 'auto', paddingTop: '0.5rem', paddingBottom: '0.5rem' }}>Your Journey From First Moment to Victory</h2>\r\n                            <p className=\"text-xl text-neutral-300 mt-6 leading-relaxed\">Features built to match your gaming style, not slow you down</p>\r\n                        </div>\r\n                        <FeaturesCarousel \r\n                            features={[\r\n                                {\r\n                                    title: \"Powered by Google Gemini\",\r\n                                    description: \"Experience cutting-edge AI assistance powered by Google's advanced Gemini technology for accurate, context-aware gaming help.\",\r\n                                    image: geminiLogo,\r\n                                    isGemini: true,\r\n                                },\r\n                                {\r\n                                    title: \"From First Screenshot to Victory\",\r\n                                    description: \"Upload a screenshot. Otagon identifies your game and becomes your personal guideno spoilers, full context.\",\r\n                                    image: feature1\r\n                                },\r\n                                {\r\n                                    title: \"Play Your Way\",\r\n                                    description: \"Story-driven explorer? Completionist? Speedrunner? Tell us once, and every hint, strategy, and insight matches your playstyle.\",\r\n                                    image: feature2\r\n                                },\r\n                                {\r\n                                    title: \"Your Gaming Dashboard\",\r\n                                    description: \"Track multiple games at once. Each has its own conversation, progress bar, and AI-generated insight tabs tailored to that game's genre.\",\r\n                                    image: feature4\r\n                                },\r\n                                {\r\n                                    title: \"Play From Anywhere\",\r\n                                    description: \"Gaming on console? Manually upload screenshots from your phone. Help arrives instantly in the same conversation.\",\r\n                                    image: feature5\r\n                                },\r\n                                {\r\n                                    title: \"Stay Focused, Stay Ahead\",\r\n                                    description: \"Skip the wiki-hunting. Otagon provides quest tips, secret locations, build optimizationall without spoiling your discovery.\",\r\n                                    image: feature6\r\n                                },\r\n                                {\r\n                                    title: \"Never Pause for Help Again\",\r\n                                    description: \"Hands-Free mode reads AI insights aloud. Get strategy tips, lore context, or build advice without leaving the game.\",\r\n                                    image: feature3\r\n                                },\r\n                            ]}\r\n                        />\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Installation Section */}\r\n                <section id=\"installation\" className=\"py-10 md:py-14 bg-transparent relative\">\r\n                    <div className=\"container mx-auto px-8 max-w-6xl relative\">\r\n                        <div className=\"text-center mb-8 md:mb-10 animate-fade-slide-up\">\r\n                            <h2 className=\"text-5xl md:text-6xl font-bold tracking-tight text-white mb-6\">Install Otagon Everywhere</h2>\r\n                            <p className=\"text-xl text-neutral-300 mt-6 leading-relaxed\">Access on mobile, sync with PC for seamless gaming</p>\r\n                        </div>\r\n                        \r\n                        <InstallationTabs pcAppImage={pcAppImage} />\r\n                    </div>\r\n                </section>\r\n\r\n                {/* For Every Gamer, For Every Genre Section */}\r\n                <section className=\"py-10 md:py-14 bg-transparent relative\">\r\n                    <div className=\"container mx-auto px-8 max-w-6xl relative\">\r\n                        <div className=\"text-center mb-8 md:mb-10 animate-fade-slide-up\">\r\n                            <h2 className=\"text-5xl md:text-6xl font-bold tracking-tight text-white mb-6\">For Every Challenge, In Every World</h2>\r\n                        </div>\r\n                        \r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\r\n                            {/* Souls-likes & Action RPGs */}\r\n                            <div className=\"text-center animate-fade-slide-up\">\r\n                                <div className=\"flex items-center justify-center mx-auto mb-4\">\r\n                                    <svg className=\"w-16 h-16\" fill=\"url(#souls-gradient)\" viewBox=\"0 0 800 800\">\r\n                                        <defs>\r\n                                            <linearGradient id=\"souls-gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n                                                <stop offset=\"0%\" stopColor=\"#E53A3A\" />\r\n                                                <stop offset=\"100%\" stopColor=\"#D98C1F\" />\r\n                                            </linearGradient>\r\n                                        </defs>\r\n                                        <path d=\"M750.5,225H576v-75h40c6.6,0,12-5.4,12-12V12c0-6.6-5.4-12-12-12h-89.5h-253H184c-6.6,0-12,5.4-12,12v126c0,6.6,5.4,12,12,12h40v75H49.5C22.2,225,0,247.2,0,274.5v476C0,777.8,22.2,800,49.5,800h701c27.3,0,49.5-22.2,49.5-49.5v-476C800,247.2,777.8,225,750.5,225z M299,150h202v106H299V150z M725,725H75V300h152.6c7.3,18.2,25.1,31,45.9,31h253c20.8,0,38.6-12.8,45.9-31H725V725z\"/>\r\n                                        <path d=\"M383.6,428h-13.5c-0.7,0-1.3,0.1-2,0.2c-2.5,0.3-4.9,1.5-6.8,3.4l-29.9,29.9l-29.9-29.9c-1.9-1.9-4.3-3-6.8-3.4c-0.7-0.1-1.3-0.2-2-0.2h-13.5c-6.6,0-12,5.4-12,12v155c0,6.6,5.4,12,12,12h13.5c6.6,0,12-5.4,12-12V487.8l17.7,17.7c2.5,2.5,5.8,3.6,9.1,3.5c3.3,0.2,6.6-1,9.1-3.5l17.7-17.7V595c0,6.6,5.4,12,12,12h13.5c6.6,0,12-5.4,12-12V440C395.6,433.4,390.2,428,383.6,428z\"/>\r\n                                        <path d=\"M520.9,427h-67c-0.4,0-0.8,0-1.1,0.1c-0.4,0-0.7-0.1-1.1-0.1h-13.5c-6.6,0-12,5.4-12,12v155c0,6.6,5.4,12,12,12h13.5c6.6,0,12-5.4,12-12v-59h57.3c6.6,0,12-5.4,12-12v-6v-7v-58v-2v-11C532.9,432.4,527.5,427,520.9,427z M495.9,498h-32.3v-34h32.3V498z\"/>\r\n                                    </svg>\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold text-white mb-3\">Souls-likes & Action RPGs</h3>\r\n                                <p className=\"text-neutral-300 leading-relaxed\">\r\n                                    Master tough bosses and find hidden paths without rage-quitting. We'll give you a hint, not the easy way out.\r\n              </p>\r\n            </div>\r\n\r\n                            {/* RPGs */}\r\n                            <div className=\"text-center animate-fade-slide-up\">\r\n                                <div className=\"flex items-center justify-center mx-auto mb-4\">\r\n                                    <svg className=\"w-16 h-16\" viewBox=\"0 0 64 64\">\r\n                                        <path fill=\"#ea8039\" d=\"M53.5,13.81l2.83-6.13-6.1,2.81a24.35,24.35,0,0,1-6.93,2.2A7.16,7.16,0,0,0,38.18,16a7.13,7.13,0,1,0,13,5.22A34.82,34.82,0,0,1,53.5,13.81Z\"/>\r\n                                        <path fill=\"#ea8039\" d=\"M50.3,23.49a9.21,9.21,0,0,1-4.13-2.4,9.44,9.44,0,0,1-.8-12.41,9.42,9.42,0,0,0-6.18,16.07l.07.06c.1.1.2.18.3.27a7.12,7.12,0,0,0,9.74-.3A7.31,7.31,0,0,0,50.3,23.49Z\"/>\r\n                                        <path fill=\"#ea8039\" d=\"M40.51,13.71a9.43,9.43,0,0,0,14.82,4.92,9.42,9.42,0,0,1-16.07,6.18l-.07-.07-.27-.3a7,7,0,0,1,1.59-10.73Z\"/>\r\n                                        <path fill=\"#e8a63a\" d=\"M37.76,15.2l-.12-6.75-4.27,5.18a24.26,24.26,0,0,1-5.28,5,7.12,7.12,0,1,0,10.65,8.29,7,7,0,0,0,.19-4A34.56,34.56,0,0,1,37.76,15.2Z\"/>\r\n                                        <path fill=\"#ea8039\" d=\"M39.08,25.31a9.36,9.36,0,0,1-10.76-6.86,9.48,9.48,0,0,1-.11-4.34,9.42,9.42,0,0,0,1.42,17.16l.09,0,.39.11a7.12,7.12,0,0,0,8.63-4.5A6.44,6.44,0,0,0,39.08,25.31Z\"/>\r\n                                        <path fill=\"#e8a63a\" d=\"M23.37,25.17l-3.61-4,.17,5.35a19.15,19.15,0,0,1-.55,5.75,5.73,5.73,0,0,0,.84,4.79,5.67,5.67,0,1,0,7.88-7.93A27.66,27.66,0,0,1,23.37,25.17Z\"/>\r\n                                        <path fill=\"#ea8039\" d=\"M29.47,30.52a7.41,7.41,0,0,1-3,2.28,7.5,7.5,0,0,1-7-.74,7.42,7.42,0,0,1-2.34-2.54,7.49,7.49,0,0,0,9.84,9.53L27,39l.3-.13a5.67,5.67,0,0,0,2.8-7.23A5.19,5.19,0,0,0,29.47,30.52Z\"/>\r\n                                        <path fill=\"#e85b23\" d=\"M48.8,26.25l6.76.12-5.19,4.27a24.27,24.27,0,0,0-5,5.28,7.13,7.13,0,0,1-5.22,3.16,7,7,0,0,1-6.77-3.33A7.13,7.13,0,0,1,37.1,25.26a7,7,0,0,1,4-.19A35,35,0,0,0,48.8,26.25Z\"/>\r\n                                        <path fill=\"#ea8039\" d=\"M38.69,24.92a9.26,9.26,0,0,0,.37,4.76A9.45,9.45,0,0,0,49.89,35.8a9.41,9.41,0,0,1-17.15-1.42.29.29,0,0,1,0-.1c-.05-.12-.08-.26-.12-.38a7.13,7.13,0,0,1,4.51-8.64A7.53,7.53,0,0,1,38.69,24.92Z\"/>\r\n                                        <path fill=\"#e85b23\" d=\"M38.84,40.63l4,3.61-5.34-.16a19.54,19.54,0,0,0-5.76.54,5.67,5.67,0,1,1,3.14-8.72A27.79,27.79,0,0,0,38.84,40.63Z\"/>\r\n                                        <path fill=\"#ea8039\" d=\"M33.48,34.53a7.52,7.52,0,0,0,1,12.39A7.49,7.49,0,0,1,25,37.07L25,37c0-.1.09-.19.14-.29a5.66,5.66,0,0,1,7.22-2.81A6.19,6.19,0,0,1,33.48,34.53Z\"/>\r\n                                        <path fill=\"#e5cfb3\" d=\"M46.6,17.16,36.77,20.3a1.51,1.51,0,0,0-.53.32L22,34.91a5.05,5.05,0,0,0,0,7.14h0a5,5,0,0,0,7.14,0L43.38,27.77a1.26,1.26,0,0,0,.32-.53l3.15-9.84A.19.19,0,0,0,46.6,17.16Z\"/>\r\n                                        <path fill=\"#d1baa1\" d=\"M29.09,42.05,43.38,27.77a1.26,1.26,0,0,0,.32-.53l3.15-9.84a.21.21,0,0,0-.05-.2L22,42.05A5,5,0,0,0,29.09,42.05Z\"/>\r\n                                        <path fill=\"#f4e4d3\" d=\"M46.85,17.4a.19.19,0,0,0-.25-.24l-9.45,3-3,9.45a.19.19,0,0,0,.24.25l9.45-3Z\"/>\r\n                                        <path fill=\"#f9f3ed\" d=\"M22,37.48,36.32,23.19a1.26,1.26,0,0,1,.53-.32L46,19.93l.81-2.53a.19.19,0,0,0-.25-.24L36.77,20.3a1.51,1.51,0,0,0-.53.32L22,34.91a5.06,5.06,0,0,0-1.27,5A5,5,0,0,1,22,37.48Z\"/>\r\n                                        <path fill=\"#5df9e6\" d=\"M43.3,27.07l3.14-9.83a.18.18,0,0,0,0-.2L45,18.44l-2.51,7.83a1.26,1.26,0,0,1-.32.53L27.88,41.09a5,5,0,0,1-2.44,1.33,5,5,0,0,1-2.56.42,5,5,0,0,0,5.81-1L43,27.6A1.32,1.32,0,0,0,43.3,27.07Z\"/>\r\n                                        <path fill=\"#041256\" d=\"M25.52,44.53a6,6,0,0,1-4.28-10.32L35.53,19.92a2.3,2.3,0,0,1,.93-.57L46.3,16.2h0a1.21,1.21,0,0,1,1.21.3,1.18,1.18,0,0,1,.29,1.21l-3.15,9.83a2.22,2.22,0,0,1-.56.93L29.8,42.76A6,6,0,0,1,25.52,44.53Zm19.9-25.95-8.35,2.67a.57.57,0,0,0-.13.08L22.66,35.62a4,4,0,0,0,0,5.73,4.07,4.07,0,0,0,5.73,0L42.67,27.06a.35.35,0,0,0,.08-.13Z\"/>\r\n                                        <rect fill=\"#d0e0ef\" height=\"2.61\" rx=\"0.89\" transform=\"translate(36.31 -2.85) rotate(45)\" width=\"15.43\" x=\"13.88\" y=\"41.11\"/>\r\n                                        <path fill=\"#fff\" d=\"M16.5,38.58a.89.89,0,0,1,1.26,0l9.29,9.29.29-.29a.9.9,0,0,0,0-1.27l-9.65-9.65a.91.91,0,0,0-1.26,0l-.58.58a.9.9,0,0,0,0,1.27l.36.36Z\"/>\r\n                                        <path fill=\"#5df9e6\" d=\"M26.9,46.31l-9.65-9.65a.83.83,0,0,0-.51-.23l9.05,9a.9.9,0,0,1,0,1.27l-.58.58a.93.93,0,0,1-.75.24l.6.6a.89.89,0,0,0,1.26,0l.58-.58A.9.9,0,0,0,26.9,46.31Z\"/>\r\n                                        <path fill=\"#385272\" d=\"M18.42,50.73l4.82-4.83L18.1,40.76l-4.87,4.87a2.55,2.55,0,0,1-1.39.69,5,5,0,1,0,5.83,5.9A2.86,2.86,0,0,1,18.42,50.73Z\"/>\r\n                                        <rect fill=\"#577491\" height=\"0.54\" transform=\"translate(37.3 -0.51) rotate(45)\" width=\"5.5\" x=\"16.51\" y=\"44.5\"/>\r\n                                        <rect fill=\"#577491\" height=\"0.54\" transform=\"translate(37.82 0.75) rotate(45)\" width=\"5.5\" x=\"15.26\" y=\"45.75\"/>\r\n                                        <rect fill=\"#577491\" height=\"0.54\" transform=\"translate(38.33 2) rotate(45)\" width=\"5.5\" x=\"14\" y=\"47\"/>\r\n                                        <rect fill=\"#577491\" height=\"0.54\" transform=\"translate(38.85 3.25) rotate(45)\" width=\"5.5\" x=\"12.75\" y=\"48.26\"/>\r\n                                        <path fill=\"#5df9e6\" d=\"M17.41,51.72a2.72,2.72,0,0,1,.75-1.49L23,45.4l-5.15-5.14-.33.33,4.34,4.34L17,49.75a2.79,2.79,0,0,0-.75,1.5,5,5,0,0,1-1.39,2.62A5,5,0,0,1,10,55.15a5,5,0,0,0,7.46-3.43Z\"/>\r\n                                        <path fill=\"#577491\" d=\"M8.91,50a5,5,0,0,1,3.33-2.2,2.55,2.55,0,0,0,1.4-.69l5.42-5.42-1-1-4.87,4.87a2.55,2.55,0,0,1-1.39.69,5,5,0,0,0-3.72,7A4.94,4.94,0,0,1,8.91,50Z\"/>\r\n                                        <path fill=\"#041256\" d=\"M26.13,49.42a1.88,1.88,0,0,1-1.34-.56l-9.65-9.65a1.87,1.87,0,0,1,0-2.67l.58-.58a1.9,1.9,0,0,1,2.68,0l9.65,9.65a1.91,1.91,0,0,1,0,2.68l-.58.57A1.89,1.89,0,0,1,26.13,49.42Zm.07-2h0Zm-9.57-9.57,9.52,9.52.41-.45-9.5-9.5Zm10,9h0Z\"/>\r\n                                        <path fill=\"#041256\" d=\"M12.73,57.33a5.83,5.83,0,0,1-.59,0,6.1,6.1,0,0,1-4.45-2.67,6,6,0,0,1,4-9.29,1.61,1.61,0,0,0,.86-.42l4.87-4.87a1,1,0,1,1,1.42,1.42l-4.87,4.87a3.63,3.63,0,0,1-1.93,1,4.08,4.08,0,0,0-2.68,1.76,4,4,0,0,0,6.25,5.07A4,4,0,0,0,16.69,52a3.82,3.82,0,0,1,1-2l4.83-4.82A1,1,0,0,1,24,46.61l-4.82,4.82a2,2,0,0,0-.48,1A5.91,5.91,0,0,1,17,55.55,6,6,0,0,1,12.73,57.33Z\"/>\r\n                                        <path fill=\"#041256\" d=\"M13.16,52A.83.83,0,0,1,12,52a.85.85,0,0,1,0-1.18A.83.83,0,0,1,13.16,52Z\"/>\r\n                                    </svg>\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold text-white mb-3\">RPGs</h3>\r\n                                <p className=\"text-neutral-300 leading-relaxed\">\r\n                                    Uncover deep lore and track complex quests without accidentally reading major story spoilers.\r\n              </p>\r\n            </div>\r\n\r\n                            {/* Puzzle Games */}\r\n                            <div className=\"text-center animate-fade-slide-up\">\r\n                                <div className=\"flex items-center justify-center mx-auto mb-4\">\r\n                                    <svg className=\"w-16 h-16\" viewBox=\"0 0 500 500\">\r\n                                        <path fill=\"#E53A3A\" d=\"M202.78,371.74a34.27,34.27,0,0,1,36.11-13.5,34,34,0,0,1-8.18,67.09,34.17,34.17,0,0,1-27.93-14.46v76.51h171.7A20.55,20.55,0,0,0,395,466.83V295.23h-76.9a34,34,0,1,0-38.35,0h-77Z\"/>\r\n                                        <path fill=\"#D98C1F\" d=\"M362.63,295.23v171.6a20.55,20.55,0,0,1-20.55,20.55h32.4A20.55,20.55,0,0,0,395,466.83V295.23Z\"/>\r\n                                        <path fill=\"#E53A3A\" d=\"M126.17,295.23a34,34,0,1,1-39.13,0H10.53v171.6a20.55,20.55,0,0,0,20.55,20.55h171.7V410.47a33.83,33.83,0,0,0,32,14.63,34,34,0,0,0-4-67.82,33.82,33.82,0,0,0-28,14.85v-76.9Z\"/>\r\n                                        <path fill=\"#D98C1F\" d=\"M374.46,203.72a33.84,33.84,0,1,1,38.92,0h76.09V34a21.33,21.33,0,0,0-21.33-21.33H298.27V89.1a33.64,33.64,0,0,0-31.84-14.54,33.84,33.84,0,0,0,4,67.45,33.63,33.63,0,0,0,27.85-14.77v76.48Z\"/>\r\n                                        <path fill=\"#E53A3A\" d=\"M468.14,12.62h-32.4A21.33,21.33,0,0,1,457.07,34V203.72h32.4V34A21.33,21.33,0,0,0,468.14,12.62Z\"/>\r\n                                        <path fill=\"#D98C1F\" d=\"M202.78,218.72a34.27,34.27,0,0,1-36.11,13.5,34,34,0,0,1,8.18-67.09,34.17,34.17,0,0,1,27.93,14.46V103.08H31.08a20.55,20.55,0,0,0-20.55,20.54V295.23H87.44a34,34,0,1,0,38.34,0h77Z\"/>\r\n                                    </svg>\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold text-white mb-3\">Puzzle Games</h3>\r\n                                <p className=\"text-neutral-300 leading-relaxed\">\r\n                                    Get a clue for that brain-bending puzzle, not the entire solution. Preserve your \"aha!\" moment.\r\n              </p>\r\n            </div>\r\n\r\n                            {/* Open-World Adventures */}\r\n                            <div className=\"text-center animate-fade-slide-up\">\r\n                                <div className=\"flex items-center justify-center mx-auto mb-4\">\r\n                                    <img src=\"/icons/openworld.svg\" alt=\"Open World Adventures\" className=\"w-16 h-16\" />\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold text-white mb-3\">Open-World Adventures</h3>\r\n                                <p className=\"text-neutral-300 leading-relaxed\">\r\n                                    Hunt down every last collectible and conquer secret challenges with a gentle nudge in the right direction.\r\n              </p>\r\n            </div>\r\n\r\n                            {/* Metroidvanias */}\r\n                            <div className=\"text-center animate-fade-slide-up\">\r\n                                <div className=\"flex items-center justify-center mx-auto mb-4\">\r\n                                    <svg className=\"w-16 h-16\" viewBox=\"0 0 1367 1562\">\r\n                                        <rect fill=\"#E62129\" height=\"97.6415\" width=\"780.786\" x=\"293\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.5262\" width=\"976.069\" x=\"195\" y=\"98\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.6415\" width=\"195.283\" x=\"195\" y=\"195\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.6415\" width=\"195.168\" x=\"976\" y=\"195\"/>\r\n                                        <rect fill=\"#E62129\" height=\"195.168\" width=\"97.6415\" x=\"293\" y=\"293\"/>\r\n                                        <rect fill=\"#E62129\" height=\"195.168\" width=\"97.5262\" x=\"390\" y=\"390\"/>\r\n                                        <rect fill=\"#E62129\" height=\"195.168\" width=\"97.6415\" x=\"976\" y=\"293\"/>\r\n                                        <rect fill=\"#E62129\" height=\"195.168\" width=\"97.5262\" x=\"879\" y=\"390\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.6415\" width=\"780.786\" x=\"293\" y=\"586\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.5262\" width=\"585.503\" x=\"391\" y=\"683\"/>\r\n                                        <rect fill=\"#E62129\" height=\"390.451\" width=\"97.5262\" x=\"98\" y=\"488\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.1804\" width=\"97.6415\" x=\"195\" y=\"781\"/>\r\n                                        <rect fill=\"#E62129\" height=\"390.335\" width=\"97.6415\" y=\"683\"/>\r\n                                        <rect fill=\"#E62129\" height=\"390.451\" width=\"97.5262\" x=\"1171\" y=\"488\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.1804\" width=\"97.6415\" x=\"1074\" y=\"781\"/>\r\n                                        <rect fill=\"#E62129\" height=\"390.335\" width=\"97.6415\" x=\"1269\" y=\"683\"/>\r\n                                        <rect fill=\"#F98812\" height=\"292.809\" width=\"97.6415\" x=\"195\" y=\"293\"/>\r\n                                        <rect fill=\"#F98812\" height=\"97.6415\" width=\"97.6415\" x=\"293\" y=\"488\"/>\r\n                                        <rect fill=\"#F98812\" height=\"292.809\" width=\"97.6415\" x=\"1074\" y=\"293\"/>\r\n                                        <rect fill=\"#F98812\" height=\"97.6415\" width=\"97.6415\" x=\"976\" y=\"488\"/>\r\n                                        <rect fill=\"#F98812\" height=\"195.283\" width=\"97.5262\" x=\"390\" y=\"195\"/>\r\n                                        <rect fill=\"#F98812\" height=\"195\" width=\"198\" x=\"583\" y=\"195\"/>\r\n                                        <rect fill=\"#F98812\" height=\"195.283\" width=\"99.1401\" x=\"877\" y=\"195\"/>\r\n                                        <rect fill=\"#F98812\" height=\"195\" width=\"391\" x=\"488\" y=\"390\"/>\r\n                                        <rect fill=\"#1D1819\" height=\"195.283\" width=\"94.9901\" x=\"488\" y=\"195\"/>\r\n                                        <rect fill=\"#1D1819\" height=\"195.283\" width=\"96.1429\" x=\"781\" y=\"195\"/>\r\n                                        <rect fill=\"#990000\" height=\"195.629\" width=\"97.6415\" x=\"195\" y=\"586\"/>\r\n                                        <rect fill=\"#990000\" height=\"292.348\" width=\"97.6415\" x=\"293\" y=\"684\"/>\r\n                                        <rect fill=\"#990000\" height=\"293\" width=\"195\" x=\"390\" y=\"781\"/>\r\n                                        <rect fill=\"#990000\" height=\"195.629\" width=\"97.7568\" x=\"1074\" y=\"586\"/>\r\n                                        <rect fill=\"#990000\" height=\"292.809\" width=\"97.5262\" x=\"976\" y=\"684\"/>\r\n                                        <rect fill=\"#990000\" height=\"293\" width=\"195\" x=\"781\" y=\"781\"/>\r\n                                        <rect fill=\"#990000\" height=\"195\" width=\"195\" x=\"586\" y=\"781\"/>\r\n                                        <rect fill=\"#F98812\" height=\"97.5262\" width=\"195.168\" y=\"1171\"/>\r\n                                        <rect fill=\"#F98812\" height=\"97.6415\" width=\"292.809\" y=\"1074\"/>\r\n                                        <rect fill=\"#F98812\" height=\"97.6415\" width=\"292.809\" x=\"1074\" y=\"1074\"/>\r\n                                        <rect fill=\"#F98812\" height=\"97.5262\" width=\"195.744\" x=\"1171\" y=\"1171\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.5262\" width=\"195.168\" x=\"586\" y=\"976\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.6415\" width=\"780.786\" x=\"293\" y=\"1074\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.5262\" width=\"196.897\" x=\"584\" y=\"1171\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.6415\" width=\"195.283\" x=\"195\" y=\"1269\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.6415\" width=\"390.451\" x=\"195\" y=\"1366\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.5262\" width=\"195.052\" x=\"293\" y=\"1464\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.5262\" width=\"195.168\" x=\"878\" y=\"1464\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.6415\" width=\"390.451\" x=\"781\" y=\"1366\"/>\r\n                                        <rect fill=\"#E62129\" height=\"97.6415\" width=\"195.168\" x=\"976\" y=\"1269\"/>\r\n                                        <rect fill=\"#F98812\" height=\"293\" width=\"195\" x=\"98\" y=\"878\"/>\r\n                                        <rect fill=\"#F98812\" height=\"293\" width=\"195\" x=\"1074\" y=\"878\"/>\r\n                                        <rect fill=\"#990000\" height=\"97.5262\" width=\"390.451\" x=\"195\" y=\"1171\"/>\r\n                                        <rect fill=\"#990000\" height=\"97.6415\" width=\"390.451\" x=\"781\" y=\"1171\"/>\r\n                                        <rect fill=\"#990000\" height=\"97.6415\" width=\"585.618\" x=\"390\" y=\"1269\"/>\r\n                                        <rect fill=\"#F98812\" height=\"97.6415\" width=\"97.6415\" x=\"293\" y=\"976\"/>\r\n                                        <rect fill=\"#F98812\" height=\"97.1804\" width=\"97.5262\" x=\"976\" y=\"976\"/>\r\n                                    </svg>\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold text-white mb-3\">Metroidvanias</h3>\r\n                                <p className=\"text-neutral-300 leading-relaxed\">\r\n                                    Lost after finding a new power? Discover which hidden path just opened up without checking a full map.\r\n              </p>\r\n            </div>\r\n\r\n                            {/* Survival & Crafting */}\r\n                            <div className=\"text-center animate-fade-slide-up\">\r\n                                <div className=\"flex items-center justify-center mx-auto mb-4\">\r\n                                    <svg className=\"w-16 h-16\" viewBox=\"0 0 500 500\">\r\n                                        <path fill=\"#faae3b\" d=\"M360.62,93.33c1.11,18.72-33.87,73.85-33.87,73.85C305.59,76.87,192.91,10.68,192.91,10.68s26.67,31.6-30.1,124-31.29,150.15-31.29,150.15h0c12.3,44.84,62.05,78.42,121.64,78.42s104-36.12,121.64-78.42h.05C411.52,203.21,360.62,93.33,360.62,93.33Z\"/>\r\n                                        <path fill=\"#ee3734\" d=\"M201.59,311.38c0-29,51.16-88.94,51.16-88.94s51.15,60,51.15,88.94-22.9,52.48-51.15,52.48S201.59,340.37,201.59,311.38Z\"/>\r\n                                        <path fill=\"rgba(0,0,0,0.15)\" d=\"M168.71,336.69c22.2,16.49,51.85,26.61,84.49,26.61,59.6,0,104-36.12,121.64-78.42h.05c36.63-81.67-14.27-191.55-14.27-191.55,1.11,18.72-33.87,73.85-33.87,73.85C305.59,76.87,192.91,10.68,192.91,10.68S438.82,258.17,168.71,336.69Z\"/>\r\n                                        <ellipse fill=\"#513b2c\" cx=\"55.48\" cy=\"453.93\" rx=\"22.06\" ry=\"36.04\" transform=\"translate(-107.9 26.8) rotate(-13.96)\"/>\r\n                                        <path fill=\"#fff\" d=\"M46,419.29c.27-.08.5-.26.78-.33l-.82.2Z\"/>\r\n                                        <path fill=\"#fff\" d=\"M63.36,489.11l.82-.2c-.28.07-.57,0-.85.07Z\"/>\r\n                                        <path fill=\"#b3814b\" d=\"M466.56,351.71a36,36,0,0,0-43.67-26.28L46.78,419c11.83-2.94,25.31,10.33,30.11,29.65S76,486,64.18,488.91l376.1-93.52A36,36,0,0,0,466.56,351.71Z\"/>\r\n                                        <polygon fill=\"rgba(0,0,0,0.15)\" points=\"64.18 488.91 440.28 395.39 466.56 351.71 76.89 448.61 64.18 488.91\"/>\r\n                                        <ellipse fill=\"#513b2c\" cx=\"444.52\" cy=\"453.93\" rx=\"36.04\" ry=\"22.06\" transform=\"translate(-103.27 775.77) rotate(-76.04)\"/>\r\n                                        <path fill=\"#fff\" d=\"M454,419.29c-.27-.08-.5-.26-.78-.33l.82.2Z\"/>\r\n                                        <path fill=\"#fff\" d=\"M436.64,489.11l-.82-.2c.28.07.57,0,.85.07Z\"/>\r\n                                        <path fill=\"#b3814b\" d=\"M33.44,351.71a36,36,0,0,1,43.67-26.28L453.22,419c-11.83-2.94-25.31,10.33-30.11,29.65s.89,37.36,12.71,40.3L59.72,395.39A36,36,0,0,1,33.44,351.71Z\"/>\r\n                                        <polygon fill=\"rgba(0,0,0,0.15)\" points=\"435.82 488.91 59.72 395.39 33.44 351.71 423.11 448.61 435.82 488.91\"/>\r\n                                    </svg>\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold text-white mb-3\">Survival & Crafting</h3>\r\n                                <p className=\"text-neutral-300 leading-relaxed\">\r\n                                    Need a specific resource? Learn where to find it or what recipe you're missing to build your ultimate base.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Pricing Section */}\r\n                <section id=\"pricing\" className=\"py-8 md:py-10 bg-transparent\">\r\n                    <div className=\"container mx-auto px-8\">\r\n                        <div className=\"text-center mb-8 md:mb-10 animate-fade-slide-up\">\r\n                            <h2 className=\"text-4xl md:text-5xl font-bold tracking-tight text-white mb-4\">Choose Your Plan</h2>\r\n                            <p className=\"text-lg text-neutral-300 leading-relaxed\">Start for free. Upgrade when you're ready.</p>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 items-stretch\">\r\n                            \r\n                        {/* Free Plan */}\r\n                        <div className=\"bg-gradient-to-r from-[#1C1C1C]/60 to-[#0A0A0A]/60 backdrop-blur-xl border-2 border-neutral-800/60 rounded-2xl p-6 flex flex-col animate-fade-slide-up hover:border-neutral-700/80 hover:scale-105 hover:shadow-[0_0_30px_rgba(229,58,58,0.3)] hover:shadow-[#E53A3A]/20 transition-all duration-500 group cursor-pointer\">\r\n                                <h3 className=\"text-2xl font-bold text-white mb-2\">Free</h3>\r\n                                <p className=\"text-neutral-300 mb-6 text-sm\">For the Casual Player</p>\r\n                                <div className=\"mb-6\">\r\n                                    <span className=\"text-4xl font-bold text-white\">$0</span>\r\n                                    <span className=\"text-lg text-neutral-300\">/month</span>\r\n                                </div>\r\n                                <ul className=\"space-y-3 mb-8\">\r\n                                    <FeatureListItem>55 Text | 25 Image Queries/month</FeatureListItem>\r\n                                    <FeatureListItem>Knowledge till January 2025</FeatureListItem>\r\n                                    <FeatureListItem>Standard AI Model</FeatureListItem>\r\n                                    <FeatureListItem>PC-to-Mobile Sync</FeatureListItem>\r\n                                    <FeatureListItem>Progress Tracking</FeatureListItem>\r\n                                    <FeatureListItem>14 day free trial for Pro</FeatureListItem>\r\n                                </ul>\r\n                                <div className=\"mt-auto\">\r\n                                    <button\r\n                                        onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}\r\n                                        className=\"w-full bg-gradient-to-r from-neutral-600 to-neutral-500 text-neutral-300 font-bold py-3 px-6 rounded-lg cursor-not-allowed opacity-50\"\r\n                                        disabled\r\n                                        title=\"Coming Soon - Join the waitlist to be notified when pricing goes live!\"\r\n                                    >\r\n                                        Coming Soon\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n\r\n                        {/* Vanguard Plan (center and highlighted) */}\r\n                        <div className=\"relative border-2 border-[#FFAB40] rounded-2xl p-6 bg-gradient-to-r from-[#111] to-[#0A0A0A] shadow-2xl shadow-[#D98C1F]/30 transform lg:scale-105 flex flex-col animate-fade-slide-up hover:shadow-[#D98C1F]/50 hover:scale-110 hover:z-50 transition-all duration-500 group cursor-pointer animate-glow-pulse\">\r\n                                <div className=\"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] text-white text-xs font-bold px-4 py-1 rounded-full uppercase tracking-wider shadow-2xl\">\r\n                                    Limited Offer\r\n                                </div>\r\n                                <h3 className=\"text-3xl font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] mb-2\">Pro Vanguard</h3>\r\n                                <p className=\"text-neutral-300 mb-6 text-sm\">Become a Founding Member</p>\r\n                                <div className=\"mb-6\">\r\n                                    <span className=\"text-4xl font-bold text-white\">$20</span>\r\n                                    <span className=\"text-lg text-neutral-300\">/year</span>\r\n                                    <p className=\"text-green-400 font-medium text-sm mt-1\">Lifetime Price Guarantee!</p>\r\n                                </div>\r\n                                <ul className=\"space-y-3 mb-6\">\r\n                                    <FeatureListItem>Everything in Pro, plus:</FeatureListItem>\r\n                                </ul>\r\n                                <ul className=\"space-y-3 mb-8 border-l-2 border-[#FFAB40]/40 pl-4 ml-2\">\r\n                                    <VanguardFeatureListItem>Permanent Price Lock-in</VanguardFeatureListItem>\r\n                                    <VanguardFeatureListItem>Exclusive 'Vanguard' Badge</VanguardFeatureListItem>\r\n                                    <VanguardFeatureListItem>Founder's Council Access</VanguardFeatureListItem>\r\n                                    <VanguardFeatureListItem>Beta Access to Features</VanguardFeatureListItem>\r\n                                    <VanguardFeatureListItem comingSoon={true}>Revenue Sharing</VanguardFeatureListItem>\r\n                                </ul>\r\n                                <div className=\"mt-auto\">\r\n                                    <button \r\n                                        onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}\r\n                                        className=\"w-full bg-gradient-to-r from-neutral-600 to-neutral-500 text-neutral-300 font-bold py-3 px-6 rounded-lg cursor-not-allowed opacity-50\"\r\n                                        disabled\r\n                                        title=\"Coming Soon - Join the waitlist to be notified when pricing goes live!\"\r\n                                    >\r\n                                        Coming Soon\r\n                                    </button>\r\n            </div>\r\n          </div>\r\n\r\n                        {/* Pro (Monthly) Plan */}\r\n                        <div className=\"bg-gradient-to-r from-[#1C1C1C]/60 to-[#0A0A0A]/60 backdrop-blur-xl border-2 border-neutral-800/60 rounded-2xl p-6 flex flex-col animate-fade-slide-up hover:border-neutral-700/80 hover:scale-105 hover:shadow-[0_0_30px_rgba(229,58,58,0.3)] hover:shadow-[#E53A3A]/20 transition-all duration-500 group cursor-pointer\">\r\n                                <h3 className=\"text-2xl font-bold text-white mb-2\">Pro</h3>\r\n                                <p className=\"text-neutral-300 mb-6 text-sm\">For the Serious Gamer</p>\r\n                                <div className=\"mb-6\">\r\n                                    <span className=\"text-4xl font-bold text-white\">$3.99</span>\r\n                                    <span className=\"text-lg text-neutral-300\">/month</span>\r\n                                </div>\r\n                                <ul className=\"space-y-3 mb-8\">\r\n                                    <FeatureListItem>Everything in Free, plus:</FeatureListItem>\r\n                                    <FeatureListItem>1,583 Text | 328 Image Queries/month</FeatureListItem>\r\n                                    <FeatureListItem>Up-to-date knowledge using web search</FeatureListItem>\r\n                                    <FeatureListItem>Advanced AI Model</FeatureListItem>\r\n                                    <FeatureListItem>In-Depth Insight Tabs</FeatureListItem>\r\n                                    <FeatureListItem>Hands-Free Voice Response</FeatureListItem>\r\n                                    <FeatureListItem>Batch Screenshot Capture</FeatureListItem>\r\n                                    <FeatureListItem>Priority Support & No Ads</FeatureListItem>\r\n                                </ul>\r\n                                <div className=\"mt-auto\">\r\n                                    <button \r\n                                        onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}\r\n                                        className=\"w-full bg-gradient-to-r from-neutral-600 to-neutral-500 text-neutral-300 font-bold py-3 px-6 rounded-lg cursor-not-allowed opacity-50\"\r\n                                        disabled\r\n                                        title=\"Coming Soon - Join the waitlist to be notified when pricing goes live!\"\r\n                                    >\r\n                                        Coming Soon\r\n                                    </button>\r\n                                </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n                </section>\r\n\r\n                {/* Testimonials Section */}\r\n                <section className=\"py-10 md:py-14 bg-transparent relative\">\r\n                    <div className=\"container mx-auto px-8 max-w-6xl relative\">\r\n                        <div className=\"text-center mb-8 md:mb-10 animate-fade-slide-up\">\r\n                            <h2 className=\"text-5xl md:text-6xl font-bold tracking-tight text-white mb-6 leading-tight\" style={{ lineHeight: '1.3', minHeight: '1.3em', height: 'auto', paddingTop: '0.5rem', paddingBottom: '0.5rem' }}>What Gamers Are Saying</h2>\r\n                        </div>\r\n                        \r\n                        {/* Mobile Carousel (< 768px) */}\r\n                        <div className=\"block md:hidden\">\r\n                            <TestimonialsCarousel \r\n                                testimonials={[\r\n                                    {\r\n                                        quote: \"Finally, a gaming assistant that doesn't spoil the story! I was stuck on a puzzle in Elden Ring for hours, and Otagon gave me just the right hint to figure it out myself.\",\r\n                                        author: \"Sarah Chen\",\r\n                                        title: \"Souls-like Enthusiast\"\r\n                                    },\r\n                                    {\r\n                                        quote: \"The PC-to-mobile sync is a game-changer. I can get help without alt-tabbing and losing my immersion. It's like having a gaming buddy who knows exactly when to chime in.\",\r\n                                        author: \"Marcus Rodriguez\",\r\n                                        title: \"RPG Completionist\"\r\n                                    },\r\n                                    {\r\n                                        quote: \"Just press F1 during intense boss fights and get spoken hints without pausing the game. The hands-free mode is a lifesaver - it's like having an expert coach right beside me.\",\r\n                                        author: \"Safi Rahman\",\r\n                                        title: \"Souls-like Speedrunner\"\r\n                                    }\r\n                                ]}\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Desktop Grid (>= 768px) */}\r\n                        <div className=\"hidden md:grid grid-cols-2 lg:grid-cols-3 gap-8\">\r\n                            <div ref={(el) => (testimonialRefs.current[0] = el)}>\r\n                                <Testimonial\r\n                                    quote=\"Finally, a gaming assistant that doesn't spoil the story! I was stuck on a puzzle in Elden Ring for hours, and Otagon gave me just the right hint to figure it out myself.\"\r\n                                    author=\"Sarah Chen\"\r\n                                    title=\"Souls-like Enthusiast\"\r\n                                    index={0}\r\n                                    isVisible={testimonialsVisible[0] || false}\r\n                                />\r\n                            </div>\r\n                            <div ref={(el) => (testimonialRefs.current[1] = el)}>\r\n                                <Testimonial\r\n                                    quote=\"The PC-to-mobile sync is a game-changer. I can get help without alt-tabbing and losing my immersion. It's like having a gaming buddy who knows exactly when to chime in.\"\r\n                                    author=\"Marcus Rodriguez\"\r\n                                    title=\"RPG Completionist\"\r\n                                    index={1}\r\n                                    isVisible={testimonialsVisible[1] || false}\r\n                                />\r\n                            </div>\r\n                            <div ref={(el) => (testimonialRefs.current[2] = el)}>\r\n                                <Testimonial\r\n                                    quote=\"Just press F1 during intense boss fights and get spoken hints without pausing the game. The hands-free mode is a lifesaver - it's like having an expert coach right beside me.\"\r\n                                    author=\"Safi Rahman\"\r\n                                    title=\"Souls-like Speedrunner\"\r\n                                    index={2}\r\n                                    isVisible={testimonialsVisible[2] || false}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Earn by Playing Section */}\r\n                <section id=\"earn-by-playing\" className=\"hidden py-10 md:py-14 bg-transparent\">\r\n                    <div className=\"container mx-auto px-6 max-w-4xl\">\r\n                        {/* Gradient border wrapper */}\r\n                        <div className=\"p-[1px] bg-gradient-to-br from-[#E53A3A]/50 to-[#D98C1F]/50 rounded-xl\">\r\n                            <div className=\"bg-[#111111] rounded-[11px] p-8 md:p-12 text-left flex flex-col\">\r\n                                <div>\r\n                                    <div className=\"flex justify-start mb-4\">\r\n                                        <div className=\"flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-br from-[#E53A3A]/10 to-[#FFAB40]/10 border border-neutral-700/50\">\r\n                                            <GamepadIcon className=\"w-12 h-12 text-[#FFAB40]\" />\r\n                                        </div>\r\n                                    </div>\r\n                                    <h2 className=\"text-4xl md:text-5xl font-bold tracking-tight text-white mb-6\">\r\n                                        Earn by Playing\r\n                                    </h2>\r\n                                    <div className=\"mb-6\">\r\n                                        <span className=\"text-base font-bold bg-sky-500/20 text-sky-300 border border-sky-500/30 px-3 py-1 rounded-full uppercase tracking-wider\">Coming when we reach 10,000 pro subs</span>\r\n                                    </div>\r\n                                    <p className=\"text-lg text-[#FFAB40] font-semibold mb-4\">Exclusive to Vanguard Users</p>\r\n                                </div>\r\n\r\n                                <div className=\"flex-grow\">\r\n                                    <ul className=\"space-y-4 text-lg max-w-2xl mb-6 leading-relaxed\">\r\n                                        <VanguardFeatureListItem>Earn instant rewards for completing in-game challenges.</VanguardFeatureListItem>\r\n                                        <VanguardFeatureListItem>Discover secrets, defeat bosses, find rare loot, or uncover lore.</VanguardFeatureListItem>\r\n                                        <VanguardFeatureListItem>Each achievement helps train our AI and puts money in your pocket, rewarded based on the challenge.</VanguardFeatureListItem>\r\n                                    </ul>\r\n                                </div>\r\n\r\n                                <div className=\"mt-auto\">\r\n                                    <button\r\n                                        onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}\r\n                                        className=\"w-full bg-neutral-600 text-neutral-400 font-bold py-3 px-6 rounded-lg cursor-not-allowed opacity-50\"\r\n                                        disabled\r\n                                        title=\"Coming when we reach 10,000 pro subs - Join the waitlist to be notified when this feature goes live!\"\r\n                                    >\r\n                                        Coming when we reach 10,000 pro subs\r\n                                    </button>\r\n                                    <p className=\"text-xs text-neutral-500 mt-3 text-center\">Join the waitlist to be notified when this feature goes live!</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Founder Section */}\r\n                <section id=\"founder\" className=\"py-10 md:py-14 bg-transparent\">\r\n                    <div className=\"container mx-auto px-8 md:px-10 max-w-5xl\">\r\n                        {/* Section Header */}\r\n                        <div className=\"text-center mb-8 md:mb-10 animate-fade-slide-up\">\r\n                            <h2 className=\"text-4xl md:text-6xl font-bold tracking-tight text-white mb-6\">\r\n                                Meet the Founder\r\n                            </h2>\r\n                            <p className=\"text-lg md:text-xl text-neutral-300 max-w-3xl mx-auto leading-relaxed\">\r\n                                Hey, I'm Amaana passionate gamer from Hyderabad who spent my early days printing cheat codes at internet cafes.\r\n                                After years of thinking about how people interact with technology, I'm building the future of gaming assistance.\r\n              </p>\r\n            </div>\r\n\r\n                        {/* Hero-Style Layout */}\r\n                        <div className=\"text-center animate-fade-slide-up\">\r\n                            {/* Founder Image - Centered */}\r\n                            <div className=\"flex justify-center mb-8\">\r\n                                <FounderImage size=\"xl\" showBadge={false} showStatus={false} />\r\n                            </div>\r\n\r\n                            {/* Decorative Gradient Line */}\r\n                            <div className=\"w-24 h-1 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] mx-auto mb-8 rounded-full\"></div>\r\n\r\n                            {/* Name and Title - Centered */}\r\n                            <div className=\"space-y-3 mb-8\">\r\n                                <h3 className=\"text-4xl md:text-5xl font-bold text-white\">\r\n                                    Amaan\r\n                                </h3>\r\n                                <p className=\"text-xl md:text-2xl text-neutral-300 font-medium\">\r\n                                    Service Designer\r\n                                </p>\r\n                            </div>                            {/* Personal Quote - Centered */}\r\n                            <div className=\"max-w-4xl mx-auto mb-12\">\r\n                                <div className=\"bg-gradient-to-r from-[#0F0F0F]/60 to-[#1A1A1A]/60 border-2 border-neutral-700/60 rounded-2xl p-8 md:p-10 backdrop-blur-sm\">\r\n                                    <p className=\"text-[#CFCFCF] leading-relaxed text-lg md:text-xl italic\">\r\n                                        \"Like you, I've spent my life passionate about games. From getting lost in the deep lore of modern RPGs\r\n                                        to the frustration of needing a small hint and getting a massive spoiler in return. That's why I built Otagon\r\n                                        - to preserve the magic of discovery while giving you just the nudge you need.\"\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n                            {/* Contact Buttons - Centered */}\r\n                            <div className=\"flex flex-col sm:flex-row items-center justify-center gap-6 md:gap-8\">\r\n                                <a\r\n                                    href=\"https://www.linkedin.com/in/readmetxt/\"\r\n                                    target=\"_blank\"\r\n                                    rel=\"noopener noreferrer\"\r\n                                    className=\"inline-flex items-center justify-center gap-3 bg-gradient-to-r from-[#0077B5] to-[#005885] md:hover:from-[#005885] md:hover:to-[#004066] text-white font-semibold py-4 px-8 rounded-xl transition-all duration-300 md:hover:scale-105 active:scale-95 shadow-lg md:hover:shadow-xl md:hover:shadow-[#0077B5]/25\"\r\n                                >\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                                        <path d=\"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z\"></path>\r\n                                        <rect x=\"2\" y=\"9\" width=\"4\" height=\"12\"></rect>\r\n                                        <circle cx=\"4\" cy=\"4\" r=\"2\"></circle>\r\n                                    </svg>\r\n                                    <span className=\"hidden sm:inline\">Connect on LinkedIn</span>\r\n                                    <span className=\"sm:hidden\">LinkedIn</span>\r\n                                </a>\r\n\r\n                                <a\r\n                                    href=\"mailto:support@otagon.app\"\r\n                                    className=\"inline-flex items-center justify-center gap-3 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] md:hover:from-[#D42A2A] md:hover:to-[#C87A1A] text-white font-semibold py-4 px-8 rounded-xl transition-all duration-300 md:hover:scale-105 active:scale-95 shadow-lg md:hover:shadow-xl md:hover:shadow-[#E53A3A]/25\"\r\n                                >\r\n                                    <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\"/>\r\n                                    </svg>\r\n                                    <span className=\"hidden sm:inline\">Email Amaan</span>\r\n                                    <span className=\"sm:hidden\">Email</span>\r\n                                </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n                </section>\r\n      </main>\r\n\r\n      {/* Footer */}\r\n            <footer className=\"bg-transparent border-t border-neutral-800/50\">\r\n                <div className=\"container mx-auto px-6 py-8\">\r\n                    <div className=\"flex flex-col md:flex-row justify-between items-center gap-6\">\r\n                        {/* Footer Links - Two rows on mobile, single row on desktop */}\r\n                        <div className=\"flex flex-col md:flex-row items-center gap-3 md:gap-6 text-sm font-medium text-neutral-400 order-1 md:order-2\">\r\n                           <div className=\"flex items-center gap-4 md:gap-6\">\r\n                               <a href=\"#pricing\" onClick={handleScrollTo('pricing')} className=\"hover:text-white transition-colors\">Pricing</a>\r\n                               <button type=\"button\" onClick={onOpenAbout} className=\"hover:text-white transition-colors active:scale-95\">About</button>\r\n                               <button type=\"button\" onClick={onOpenTerms} className=\"hover:text-white transition-colors active:scale-95\">Terms</button>\r\n                           </div>\r\n                           <div className=\"flex items-center gap-4 md:gap-6\">\r\n                               <button type=\"button\" onClick={onOpenPrivacy} className=\"hover:text-white transition-colors active:scale-95\">Privacy</button>\r\n                               <button type=\"button\" onClick={onOpenRefund} className=\"hover:text-white transition-colors active:scale-95\">Refund Policy</button>\r\n                               <button type=\"button\" onClick={onOpenContact} className=\"hover:text-white transition-colors active:scale-95\">Contact Us</button>\r\n                           </div>\r\n            </div>\r\n            \r\n                        {/* Logo and Branding - Centered on mobile, left side on desktop */}\r\n                        <div className=\"flex flex-col items-center md:items-start text-center md:text-left order-2 md:order-1\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <Logo className=\"h-8 w-8\" bounce={false} />\r\n                                <span className=\"text-xl font-bold\">Otagon</span>\r\n              </div>\r\n                             <p className=\"text-neutral-400 mt-2 text-sm\">&copy; {new Date().getFullYear()} Otagon. All rights reserved.</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </footer>\r\n            \r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LandingPage;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { isPWAMode, markAppAsInstalled } from '../../utils/pwaDetection';\r\nimport type { BeforeInstallPromptEvent } from '../../types/enhanced';\r\n\r\ninterface PWAInstallBannerProps {\r\n  className?: string;\r\n}\r\n\r\nconst BANNER_DISMISS_KEY = 'otakon_pwa_banner_dismissed';\r\nconst GLOBAL_PROMPT_KEY = '__otagon_beforeinstallprompt';\r\n\r\n// Extend Window interface for global prompt storage\r\ninterface WindowWithPrompt extends Window {\r\n  [key: string]: BeforeInstallPromptEvent | null | unknown;\r\n}\r\n\r\nconst PWAInstallBanner: React.FC<PWAInstallBannerProps> = ({ className = '' }) => {\r\n  const [deferredPrompt, setDeferredPrompt] = useState<BeforeInstallPromptEvent | null>(null);\r\n  const [hasPrompt, setHasPrompt] = useState(false);\r\n  const [isInstalled, setIsInstalled] = useState(false);\r\n\r\n  useEffect(() => {\r\n    console.log(' [PWA Install Banner] Component mounted, checking installation status...');\r\n    console.log(' Current URL:', window.location.href);\r\n    console.log(' Is HTTPS?', window.location.protocol === 'https:');\r\n    console.log(' Is localhost?', window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1');\r\n    \r\n    // Check if app is already installed\r\n    const checkIfInstalled = () => {\r\n      // Check if running in standalone mode (PWA)\r\n      if (isPWAMode()) {\r\n        console.log(' [PWA Install Banner] App is already installed (running in PWA mode)');\r\n        setIsInstalled(true);\r\n        markAppAsInstalled();\r\n        return;\r\n      }\r\n      \r\n      // Check if app was previously installed\r\n      if (localStorage.getItem('otakon_pwa_installed') === 'true') {\r\n        console.log(' [PWA Install Banner] App was previously installed');\r\n        setIsInstalled(true);\r\n        return;\r\n      }\r\n      \r\n      console.log('  [PWA Install Banner] App not installed yet');\r\n    };\r\n\r\n    checkIfInstalled();\r\n\r\n    const globalPrompt = (window as WindowWithPrompt)[GLOBAL_PROMPT_KEY] as BeforeInstallPromptEvent | null;\r\n    if (globalPrompt) {\r\n      console.log(' [PWA Install Banner] Found existing beforeinstallprompt event');\r\n      setDeferredPrompt(globalPrompt);\r\n      setHasPrompt(true);\r\n    }\r\n\r\n    // Listen for beforeinstallprompt event\r\n    const handleBeforeInstallPrompt = (e: Event) => {\r\n      console.log(' [PWA Install Banner] beforeinstallprompt event fired');\r\n      e.preventDefault();\r\n      const installEvent = e as BeforeInstallPromptEvent;\r\n      (window as WindowWithPrompt)[GLOBAL_PROMPT_KEY] = installEvent;\r\n      setDeferredPrompt(installEvent);\r\n      setHasPrompt(true);\r\n    };\r\n\r\n    // Listen for appinstalled event\r\n    const handleAppInstalled = () => {\r\n      console.log(' [PWA Install Banner] App installed successfully!');\r\n      setIsInstalled(true);\r\n      markAppAsInstalled();\r\n      (window as WindowWithPrompt)[GLOBAL_PROMPT_KEY] = null;\r\n      setHasPrompt(false);\r\n      setDeferredPrompt(null);\r\n    };\r\n\r\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\r\n    window.addEventListener('appinstalled', handleAppInstalled);\r\n\r\n    // Log installability status after 2 seconds\r\n    setTimeout(() => {\r\n      if (!hasPrompt && !isInstalled) {\r\n        console.log(' [PWA Install Banner] beforeinstallprompt event has NOT fired');\r\n        console.log(' Checking PWA installation criteria:');\r\n        console.log('   1. HTTPS: ' + (window.location.protocol === 'https:' ? '' : ' REQUIRED'));\r\n        console.log('   2. Localhost: ' + ((window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') ? '' : ''));\r\n        console.log('   3. Service Worker: ' + (navigator.serviceWorker.controller ? ' Active' : '  Not active'));\r\n        console.log('   4. Manifest Link: ' + (document.querySelector('link[rel=\"manifest\"]') ? '' : ''));\r\n        \r\n        // Check manifest fetch\r\n        fetch('/manifest.json')\r\n          .then(res => {\r\n            console.log('   5. Manifest Response: ' + (res.ok ? ' 200 OK' : ' ' + res.status));\r\n            return res.json();\r\n          })\r\n          .then(manifest => {\r\n            console.log('   6. Manifest Content:', manifest);\r\n            console.log('      - Name: ' + (manifest.name ? '' : ''));\r\n            console.log('      - Start URL: ' + (manifest.start_url ? '' : ''));\r\n            console.log('      - Icons: ' + (manifest.icons?.length || 0) + ' icons');\r\n            console.log('      - Display: ' + (manifest.display || 'none'));\r\n          })\r\n          .catch(err => {\r\n            console.log('   5. Manifest Fetch:  Failed - ' + err.message);\r\n          });\r\n        \r\n        console.log('   Possible reasons:');\r\n        console.log('   - App is not served over HTTPS (required in production)');\r\n        console.log('   - manifest.json is invalid or missing required fields');\r\n        console.log('   - Service worker is not registered properly');\r\n        console.log('   - Browser does not support PWA installation (Safari iOS)');\r\n        console.log('   - App is already installed');\r\n        console.log('   - Chrome may have already shown prompt and user dismissed it');\r\n      }\r\n    }, 2000);\r\n\r\n    return () => {\r\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\r\n      window.removeEventListener('appinstalled', handleAppInstalled);\r\n    };\r\n  }, []);\r\n\r\n  const handleInstallClick = async () => {\r\n    if (!deferredPrompt) {\r\n      console.log('  [PWA Install Banner] No install prompt available');\r\n      // Fallback instructions already shown in banner\r\n      return;\r\n    }\r\n\r\n    console.log(' [PWA Install Banner] Showing install prompt...');\r\n    // Show the install prompt\r\n    deferredPrompt.prompt();\r\n    \r\n    // Wait for the user to respond to the prompt\r\n    const { outcome } = await deferredPrompt.userChoice;\r\n    \r\n    if (outcome === 'accepted') {\r\n      console.log(' [PWA Install Banner] User accepted the install prompt');\r\n    } else {\r\n      console.log(' [PWA Install Banner] User dismissed the install prompt');\r\n    }\r\n    \r\n    // Clear the deferred prompt\r\n    setDeferredPrompt(null);\r\n  };\r\n  \r\n  // If already installed, show a simple \"Already Installed\" message\r\n  if (isInstalled) {\r\n    return (\r\n      <div className={`bg-gradient-to-r from-green-900/30 to-green-800/30 backdrop-blur-xl border border-green-700/60 rounded-lg md:rounded-xl p-2.5 md:p-3 text-center ${className}`}>\r\n        <div className=\"flex items-center justify-center gap-2\">\r\n          <svg className=\"w-4 h-4 md:w-5 md:h-5 text-green-400\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z\"/>\r\n          </svg>\r\n          <p className=\"text-xs md:text-sm font-medium text-green-300\">App Installed</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`bg-gradient-to-r from-[#1C1C1C]/90 to-[#0A0A0A]/90 backdrop-blur-xl border border-neutral-700/60 rounded-lg md:rounded-xl p-2.5 md:p-3 lg:p-4 text-center ${className}`}>\r\n      <div className=\"flex items-center space-x-2 md:space-x-3 mb-2 md:mb-3\">\r\n        <div className=\"w-7 h-7 md:w-8 md:h-8 lg:w-9 lg:h-9 bg-[#111111] rounded-lg flex items-center justify-center flex-shrink-0\">\r\n          <img \r\n            src=\"/images/otagon-logo.png\" \r\n            alt=\"Otagon\" \r\n            className=\"w-4 h-4 md:w-5 md:h-5 lg:w-6 lg:h-6\"\r\n          />\r\n        </div>\r\n        <div className=\"text-left flex-1\">\r\n          <p className=\"text-sm md:text-base lg:text-lg font-medium text-white leading-tight\">Install Otagon App</p>\r\n          <p className=\"text-xs md:text-sm text-neutral-400 leading-tight\">Get the full app experience</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Install Instructions - Always Show */}\r\n      <div className=\"mt-2 md:mt-3 space-y-2 md:space-y-2.5\">\r\n        {hasPrompt && (\r\n          <button\r\n            onClick={handleInstallClick}\r\n            className=\"w-full py-2 md:py-2.5 bg-gradient-to-r from-[#E53A3A] to-[#FFAB40] md:hover:from-[#D42A2A] md:hover:to-[#C87A1A] text-white text-sm md:text-base font-semibold rounded-lg transition-all duration-200 active:scale-95\"\r\n          >\r\n            Install Now\r\n          </button>\r\n        )}\r\n        \r\n        <div className=\"text-left space-y-1.5 md:space-y-2\">\r\n          <p className=\"text-xs md:text-sm font-semibold text-white/90\">How to Install:</p>\r\n          <ol className=\"text-xs md:text-sm text-neutral-400 space-y-1.5 md:space-y-2 pl-3 md:pl-4 leading-relaxed\">\r\n            <li className=\"flex items-start\">\r\n              <span className=\"text-[#FFAB40] mr-1.5 md:mr-2\"></span>\r\n              <span>Tap the <span className=\"text-white font-medium\">browser menu ()</span> in Chrome or Safari</span>\r\n            </li>\r\n            <li className=\"flex items-start\">\r\n              <span className=\"text-[#FFAB40] mr-1.5 md:mr-2\"></span>\r\n              <span>Select <span className=\"text-white font-medium\">Add to Home screen</span></span>\r\n            </li>\r\n            <li className=\"flex items-start\">\r\n              <span className=\"text-[#FFAB40] mr-1.5 md:mr-2\"></span>\r\n              <span>Tap <span className=\"text-white font-medium\">Add</span> to install Otagon</span>\r\n            </li>\r\n          </ol>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PWAInstallBanner;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport Logo from '../ui/Logo';\r\nimport Button from '../ui/Button';\r\nimport { authService } from '../../services/authService';\r\nimport TermsModal from '../modals/TermsModal';\r\nimport PrivacyModal from '../modals/PrivacyModal';\r\nimport PWAInstallBanner from './PWAInstallBanner';\r\n// Mobile optimizations applied\r\n\r\ninterface LoginSplashScreenProps {\r\n  onComplete: () => void;\r\n  onBackToLanding: () => void;\r\n  onSetAppState: (updater: (prev: AppState) => AppState) => void;\r\n}\r\n\r\nconst LoginSplashScreen: React.FC<LoginSplashScreenProps> = ({\r\n  onComplete,\r\n  onBackToLanding,\r\n  onSetAppState,\r\n}) => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [emailMode, setEmailMode] = useState<'options' | 'signin' | 'signup' | 'forgot-password'>('options');\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  const [isAnimating, setIsAnimating] = useState(false);\r\n  const [rememberMe, setRememberMe] = useState(false);\r\n  const [emailError, setEmailError] = useState('');\r\n  const [passwordError, setPasswordError] = useState('');\r\n  const [showTermsModal, setShowTermsModal] = useState(false);\r\n  const [showPrivacyModal, setShowPrivacyModal] = useState(false);\r\n  const [showSignupSuccess, setShowSignupSuccess] = useState(false);\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showSignupModal, setShowSignupModal] = useState(false);\r\n  const [signupModalType, setSignupModalType] = useState<'success' | 'email-exists' | 'invalid-email'>('success');\r\n  const [signupModalMessage, setSignupModalMessage] = useState('');\r\n\r\n  // Validate password meets Supabase requirements\r\n  const validatePassword = (password: string): { isValid: boolean; errors: string[] } => {\r\n    const errors: string[] = [];\r\n    \r\n    if (password.length < 8) {\r\n      errors.push('Password must be at least 8 characters long');\r\n    }\r\n    \r\n    if (!/[a-z]/.test(password)) {\r\n      errors.push('Password must contain at least one lowercase letter');\r\n    }\r\n    \r\n    if (!/[A-Z]/.test(password)) {\r\n      errors.push('Password must contain at least one uppercase letter');\r\n    }\r\n    \r\n    if (!/[0-9]/.test(password)) {\r\n      errors.push('Password must contain at least one number');\r\n    }\r\n    \r\n    if (!/[!@#$%^&*()_+\\-=[\\]{}|;:,.<>?]/.test(password)) {\r\n      errors.push('Password must contain at least one special character');\r\n    }\r\n    \r\n    return {\r\n      isValid: errors.length === 0,\r\n      errors\r\n    };\r\n  };\r\n\r\n  // Email validation\r\n  const validateEmail = (email: string): boolean => {\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return emailRegex.test(email);\r\n  };\r\n\r\n  // Toggle password visibility\r\n  const togglePasswordVisibility = () => {\r\n    setShowPassword(!showPassword);\r\n  };\r\n\r\n  // Handle signup modal close\r\n  const handleSignupModalClose = () => {\r\n    setShowSignupModal(false);\r\n    setSignupModalMessage('');\r\n    // Reset form\r\n    setEmail('');\r\n    setPassword('');\r\n    setEmailError('');\r\n    setPasswordError('');\r\n    setErrorMessage('');\r\n    \r\n    // Always go back to login page after modal closes\r\n    // Don't call onComplete() for signup as user needs to confirm email first\r\n    setEmailMode('options');\r\n  };\r\n\r\n  // Clear errors when user starts typing\r\n  useEffect(() => {\r\n    if (emailError && email) {\r\n      setEmailError('');\r\n    }\r\n  }, [email, emailError]);\r\n\r\n  useEffect(() => {\r\n    if (passwordError && password) {\r\n      setPasswordError('');\r\n    }\r\n  }, [password, passwordError]);\r\n\r\n  // Real-time password validation for signup\r\n  useEffect(() => {\r\n    if (emailMode === 'signup' && password) {\r\n      const validation = validatePassword(password);\r\n      if (!validation.isValid) {\r\n        // Don't show error immediately, just clear any existing error\r\n        // The validation will be shown in the UI requirements list\r\n        setPasswordError('');\r\n      }\r\n    }\r\n  }, [password, emailMode]);\r\n\r\n  // Keyboard navigation support\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape' && emailMode !== 'options') {\r\n        setEmailMode('options');\r\n        setEmail('');\r\n        setPassword('');\r\n        setEmailError('');\r\n        setPasswordError('');\r\n        setErrorMessage('');\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [emailMode]);\r\n\r\n  const handleAuth = async (method: 'google' | 'discord' | 'email') => {\r\n        setIsLoading(true);\r\n    setErrorMessage('');\r\n\r\n    try {\r\n      if (method === 'email') {\r\n        setEmailMode('signin');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      //  PROTECTED OAUTH FLOW - DO NOT MODIFY WITHOUT WARNING \r\n      // Google and Discord OAuth are working correctly - any changes here could break user authentication\r\n      // If you need to modify this, add a warning comment explaining the change\r\n      const result = await authService[method === 'google' ? 'signInWithGoogle' : 'signInWithDiscord']();\r\n      if (result.success) {\r\n        // OAuth will redirect, so we don't need to call onComplete here\r\n        return;\r\n      } else {\r\n        setErrorMessage(result.error || 'Authentication failed. Please try again.');\r\n      }\r\n    } catch (_error) {\r\n      setErrorMessage('Authentication failed. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleEmailAuth = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    // Clear previous errors\r\n    setEmailError('');\r\n    setPasswordError('');\r\n    setErrorMessage('');\r\n\r\n    // Validate email\r\n    if (!email) {\r\n      setEmailError('Email is required');\r\n      return;\r\n    }\r\n    if (!validateEmail(email)) {\r\n      setEmailError('Please enter a valid email address');\r\n      return;\r\n    }\r\n\r\n    // Validate password for sign in\r\n    if (emailMode === 'signin' && !password) {\r\n      setPasswordError('Password is required');\r\n      return;\r\n    }\r\n    if (emailMode === 'signin' && password.length < 8) {\r\n      setPasswordError('Password must be at least 8 characters long');\r\n      return;\r\n    }\r\n\r\n    // Check if email is already registered with a different provider\r\n    if (emailMode === 'signin') {\r\n      const providerCheck = await authService.checkEmailProvider(email);\r\n      if (providerCheck.provider && providerCheck.provider !== 'email') {\r\n        setErrorMessage(providerCheck.message);\r\n        return;\r\n      }\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setIsAnimating(true);\r\n\r\n    try {\r\n      let result;\r\n      if (emailMode === 'signin') {\r\n        //  FIXED: Wait for authentication to complete before navigating\r\n        // This prevents race condition where onComplete() was called before auth finished\r\n        result = await authService.signInWithEmail(email, password);\r\n      } else {\r\n        // For signup, validate the password\r\n        if (!password) {\r\n          setPasswordError('Password is required');\r\n          return;\r\n        }\r\n        \r\n        const passwordValidation = validatePassword(password);\r\n        if (!passwordValidation.isValid) {\r\n          setPasswordError(passwordValidation.errors[0]);\r\n          return;\r\n        }\r\n        \r\n        //  PROTECTED EMAIL AUTH FLOW - DO NOT MODIFY WITHOUT WARNING \r\n        // Email signup is working correctly - any changes here could break user registration\r\n        // If you need to modify this, add a warning comment explaining the change\r\n        result = await authService.signUpWithEmail(email, password);\r\n      }\r\n      \r\n      if (result.success) {\r\n        if (emailMode === 'signup') {\r\n          // For signup, show modal first before any view changes\r\n          if (result.requiresConfirmation) {\r\n            setSignupModalType('success');\r\n            setSignupModalMessage('Please check your email and click the confirmation link to complete your account setup.');\r\n            setShowSignupModal(true);\r\n          } else {\r\n            // Account created and user is signed in\r\n            setSignupModalType('success');\r\n            setSignupModalMessage('Account created successfully! You are now signed in.');\r\n            setShowSignupModal(true);\r\n          }\r\n          // Don't call onComplete() here - let the modal handle the transition\r\n        } else {\r\n          //  FIXED: Only call onComplete() after successful sign-in\r\n          // Store remember me preference for sign-in\r\n          if (rememberMe) {\r\n            localStorage.setItem('otakon_remember_me', 'true');\r\n            localStorage.setItem('otakon_remembered_email', email);\r\n          }\r\n          // Navigate to app now that authentication is complete\r\n          onComplete();\r\n        }\r\n      } else {\r\n        // Handle different error types for signup\r\n        if (emailMode === 'signup') {\r\n          const errorMsg = result.error || 'Authentication failed. Please try again.';\r\n                              if (errorMsg.toLowerCase().includes('user already registered') || \r\n              errorMsg.toLowerCase().includes('email already registered') ||\r\n              errorMsg.toLowerCase().includes('already registered') ||\r\n              errorMsg.toLowerCase().includes('user with this email already exists') ||\r\n              errorMsg.toLowerCase().includes('email address is already in use') ||\r\n              errorMsg.toLowerCase().includes('duplicate key value violates unique constraint') ||\r\n              errorMsg.toLowerCase().includes('email already exists') ||\r\n              errorMsg.toLowerCase().includes('user already exists') ||\r\n              errorMsg.toLowerCase().includes('email is already taken') ||\r\n              errorMsg.toLowerCase().includes('email already in use') ||\r\n              errorMsg.toLowerCase().includes('email has already been taken') ||\r\n              errorMsg.toLowerCase().includes('this email is already registered') ||\r\n              errorMsg.toLowerCase().includes('email already registered with a different provider')) {\r\n            setSignupModalType('email-exists');\r\n            setSignupModalMessage('This email is already registered. Please try signing in instead or check your email for a confirmation link.');\r\n          } else if (errorMsg.toLowerCase().includes('for security purposes') || \r\n                     errorMsg.toLowerCase().includes('you can only request this after') ||\r\n                     errorMsg.toLowerCase().includes('rate limit') ||\r\n                     errorMsg.toLowerCase().includes('too many requests') ||\r\n                     errorMsg.toLowerCase().includes('try again later')) {\r\n            setSignupModalType('invalid-email');\r\n            setSignupModalMessage('Please wait before trying again. For security purposes, there is a cooldown period between signup attempts.');\r\n          } else if (errorMsg.toLowerCase().includes('invalid email') || \r\n                     errorMsg.toLowerCase().includes('email format') ||\r\n                     errorMsg.toLowerCase().includes('invalid email address')) {\r\n            setSignupModalType('invalid-email');\r\n            setSignupModalMessage('Please enter a valid email address.');\r\n          } else {\r\n            setSignupModalType('invalid-email');\r\n            setSignupModalMessage(errorMsg);\r\n          }\r\n          setShowSignupModal(true);\r\n        } else {\r\n          // If sign-in failed, we need to go back to login screen\r\n          // Reset the view back to login\r\n          onSetAppState(prev => ({ ...prev, view: 'landing', onboardingStatus: 'login' }));\r\n          setErrorMessage(result.error || 'Authentication failed. Please try again.');\r\n        }\r\n      }\r\n    } catch (_error) {\r\n      setErrorMessage('Authentication failed. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n      setIsAnimating(false);\r\n    }\r\n  };\r\n\r\n  const handleForgotPassword = async () => {\r\n    if (!email) {\r\n      setEmailError('Please enter your email address first');\r\n      return;\r\n    }\r\n    if (!validateEmail(email)) {\r\n      setEmailError('Please enter a valid email address');\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setErrorMessage('');\r\n\r\n    try {\r\n      const result = await authService.resetPassword(email);\r\n      if (result.success) {\r\n        setSuccessMessage('Password reset email sent! Check your inbox.');\r\n        setErrorMessage('');\r\n        setTimeout(() => {\r\n          setEmailMode('signin');\r\n          setSuccessMessage('');\r\n        }, 3000);\r\n      } else {\r\n        setErrorMessage(result.error || 'Failed to send reset email. Please try again.');\r\n      }\r\n    } catch (_error) {\r\n      setErrorMessage('Failed to send reset email. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-[#0F0F0F] to-background text-text-primary flex flex-col items-center justify-center px-4 py-2 md:py-4 lg:py-6 relative overflow-hidden\">\r\n      \r\n      <div className={`w-full max-w-md lg:max-w-lg xl:max-w-xl relative z-10 transition-all duration-500 ${isAnimating ? 'scale-105' : 'scale-100'} mx-auto`}>\r\n        {/* Logo and Title */}\r\n        <div className=\"text-center mb-4 md:mb-5 lg:mb-6\">\r\n          <Logo size=\"lg\" className=\"mx-auto mb-3 md:mb-3 lg:mb-4 w-16 h-16 md:w-16 md:h-16 lg:w-20 lg:h-20\" spinOnce={true} />\r\n          <h1 className=\"text-2xl md:text-2xl lg:text-3xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent mb-2\">\r\n            Welcome to Otagon\r\n          </h1>\r\n          <p className=\"text-sm md:text-sm lg:text-base text-text-secondary px-4\">\r\n            {emailMode === 'options' \r\n              ? 'Sign in to start your gaming adventure' \r\n              : emailMode === 'signin' \r\n                ? 'Welcome back! Sign in to continue'\r\n                : emailMode === 'signup'\r\n                  ? 'Create your account to get started'\r\n                  : 'Reset your password'\r\n            }\r\n          </p>\r\n        </div>\r\n\r\n        {/* Error Message */}\r\n        {errorMessage && (\r\n          <div className=\"mb-2.5 md:mb-3 lg:mb-4 p-2 md:p-2.5 lg:p-3 bg-red-500/10 border border-red-500/20 rounded-lg md:rounded-xl text-red-400 text-center text-xs md:text-sm\">\r\n            {errorMessage}\r\n          </div>\r\n        )}\r\n\r\n        {/* Success Message */}\r\n        {successMessage && (\r\n          <div className=\"mb-2.5 md:mb-3 lg:mb-4 p-2 md:p-2.5 lg:p-3 bg-green-500/10 border border-green-500/20 rounded-lg md:rounded-xl text-green-400 text-center text-xs md:text-sm\">\r\n            {successMessage}\r\n          </div>\r\n        )}\r\n\r\n        {/* Email Form */}\r\n        {(emailMode === 'signin' || emailMode === 'signup') && (\r\n          <form onSubmit={handleEmailAuth} className=\"space-y-3 md:space-y-4 lg:space-y-5 mb-3 md:mb-4\" role=\"form\" aria-label={`${emailMode === 'signin' ? 'Sign in' : 'Sign up'} form`}>\r\n            <div className=\"space-y-3 md:space-y-4 lg:space-y-5\">\r\n              <div>\r\n                <label htmlFor=\"email-input\" className=\"sr-only\">\r\n                  Email address\r\n                </label>\r\n                <input\r\n                  id=\"email-input\"\r\n                  type=\"email\"\r\n                  value={email}\r\n                  onChange={(e) => setEmail(e.target.value)}\r\n                  onKeyDown={(e) => {\r\n                    if (e.key === 'Enter' && emailMode === 'signin') {\r\n                      e.preventDefault();\r\n                      handleEmailAuth(e);\r\n                    }\r\n                  }}\r\n                  placeholder=\"Enter your email\"\r\n                  required\r\n                  autoComplete=\"email\"\r\n                  tabIndex={1}\r\n                  aria-describedby={emailError ? \"email-error\" : undefined}\r\n                  className={`w-full bg-surface border rounded-xl py-1.5 md:py-2 lg:py-2.5 px-3 md:px-4 lg:px-5 text-text-primary placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-primary transition-all duration-300 text-sm md:text-base ${\r\n                    emailError \r\n                      ? 'border-red-500/50 focus:border-red-500/60' \r\n                      : 'border-surface-light/60 focus:border-primary/60'\r\n                  }`}\r\n                />\r\n                {emailError && (\r\n                  <p id=\"email-error\" className=\"mt-1.5 text-xs text-red-400\" role=\"alert\">{emailError}</p>\r\n                )}\r\n              </div>\r\n\r\n              {(emailMode === 'signin' || emailMode === 'signup') && (\r\n                <div>\r\n                  <label htmlFor=\"password-input\" className=\"sr-only\">\r\n                    Password\r\n                  </label>\r\n                  <div className=\"relative\">\r\n                    <input\r\n                      id=\"password-input\"\r\n                      type={showPassword ? \"text\" : \"password\"}\r\n                      value={password}\r\n                      onChange={(e) => setPassword(e.target.value)}\r\n                      onKeyDown={(e) => {\r\n                        if (e.key === 'Enter') {\r\n                          e.preventDefault();\r\n                          handleEmailAuth(e);\r\n                        }\r\n                      }}\r\n                      placeholder={emailMode === 'signin' ? \"Enter your password\" : \"Create a password\"}\r\n                      required\r\n                      autoComplete={emailMode === 'signin' ? \"current-password\" : \"new-password\"}\r\n                      tabIndex={2}\r\n                      aria-describedby={passwordError ? \"password-error\" : undefined}\r\n                      className={`w-full bg-surface border rounded-xl py-1.5 md:py-2 lg:py-2.5 px-3 md:px-4 lg:px-5 pr-10 md:pr-12 text-text-primary placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-primary transition-all duration-300 text-sm md:text-base ${\r\n                        passwordError \r\n                          ? 'border-red-500/50 focus:border-red-500/60' \r\n                          : 'border-surface-light/60 focus:border-primary/60'\r\n                      }`}\r\n                    />\r\n                    {password && (\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={togglePasswordVisibility}\r\n                        className=\"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-text-muted hover:text-text-primary transition-colors duration-200 focus:outline-none focus:text-text-primary\"\r\n                        aria-label={showPassword ? \"Hide password\" : \"Show password\"}\r\n                      >\r\n                        {showPassword ? (\r\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21\"></path>\r\n                          </svg>\r\n                        ) : (\r\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"></path>\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\"></path>\r\n                          </svg>\r\n                        )}\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                  {passwordError && (\r\n                    <p id=\"password-error\" className=\"mt-1.5 text-xs text-red-400\" role=\"alert\">{passwordError}</p>\r\n                  )}\r\n                  {emailMode === 'signup' && (\r\n                    <div className=\"mt-2.5 md:mt-3 lg:mt-4 pt-2 md:pt-2.5 lg:pt-3 border-t border-surface-light/30 text-xs md:text-sm text-text-muted\">\r\n                      <p className=\"font-medium mb-2\">Password must contain:</p>\r\n                      <ul className=\"list-disc list-inside space-y-1.5\">\r\n                        <li className={password.match(/[a-z]/) ? 'text-green-400' : 'text-text-muted'}>\r\n                          At least one lowercase letter\r\n                        </li>\r\n                        <li className={password.match(/[A-Z]/) ? 'text-green-400' : 'text-text-muted'}>\r\n                          At least one uppercase letter\r\n                        </li>\r\n                        <li className={password.match(/[0-9]/) ? 'text-green-400' : 'text-text-muted'}>\r\n                          At least one number\r\n                        </li>\r\n                        <li className={password.match(/[!@#$%^&*()_+\\-=[\\]{}|;:,.<>?]/) ? 'text-green-400' : 'text-text-muted'}>\r\n                          At least one special character\r\n                        </li>\r\n                        <li className={password.length >= 8 ? 'text-green-400' : 'text-text-muted'}>\r\n                          At least 8 characters long\r\n                        </li>\r\n                      </ul>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {emailMode === 'signin' && (\r\n                <div className=\"flex items-center justify-between\">\r\n                  <label className=\"flex items-center space-x-2 text-xs md:text-sm text-text-secondary\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={rememberMe}\r\n                      onChange={(e) => setRememberMe(e.target.checked)}\r\n                      className=\"w-3.5 h-3.5 text-primary bg-surface border-surface-light/60 rounded focus:ring-primary focus:ring-2\"\r\n                    />\r\n                    <span>Remember me</span>\r\n                  </label>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setEmailMode('forgot-password')}\r\n                    className=\"text-xs md:text-sm text-primary hover:text-primary/80 transition-colors\"\r\n                  >\r\n                    Forgot password?\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <Button\r\n              type=\"submit\"\r\n              disabled={isLoading}\r\n              isLoading={isLoading}\r\n              variant=\"primary\"\r\n              className=\"w-full mt-4 md:mt-5 lg:mt-6 py-1.5 md:py-2 lg:py-2.5\"\r\n              tabIndex={3}\r\n            >\r\n              {isLoading ? (emailMode === 'signin' ? 'Signing in...' : 'Creating account...') : (emailMode === 'signin' ? 'Sign In' : 'Create Account')}\r\n            </Button>\r\n\r\n            <div className=\"text-center\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setEmailMode('options')}\r\n                className=\"text-text-muted hover:text-text-primary transition-colors text-xs md:text-sm\"\r\n              >\r\n                {emailMode === 'signup' ? ' Back to Login' : ' Back to options'}\r\n              </button>\r\n            </div>\r\n          </form>\r\n        )}\r\n\r\n        {/* Forgot Password Form */}\r\n        {emailMode === 'forgot-password' && (\r\n          <form onSubmit={(e) => { e.preventDefault(); handleForgotPassword(); }} className=\"space-y-2.5 md:space-y-3 mb-3 md:mb-4\">\r\n            <div>\r\n              <input\r\n                type=\"email\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n                placeholder=\"Enter your email\"\r\n                required\r\n                className={`w-full bg-surface border rounded-xl py-1.5 md:py-2 lg:py-2.5 px-3 md:px-4 lg:px-5 text-text-primary placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-primary transition-all duration-300 text-sm md:text-base ${\r\n                  emailError \r\n                    ? 'border-red-500/50 focus:border-red-500/60' \r\n                    : 'border-surface-light/60 focus:border-primary/60'\r\n                }`}\r\n              />\r\n              {emailError && (\r\n                <p className=\"mt-1.5 text-xs text-red-400\">{emailError}</p>\r\n              )}\r\n            </div>\r\n\r\n            <Button\r\n              type=\"submit\"\r\n              disabled={isLoading}\r\n              isLoading={isLoading}\r\n              variant=\"primary\"\r\n              className=\"w-full\"\r\n            >\r\n              {isLoading ? 'Sending...' : 'Send Reset Email'}\r\n            </Button>\r\n\r\n            <div className=\"text-center\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setEmailMode('signin')}\r\n                className=\"text-text-muted hover:text-text-primary transition-colors text-xs\"\r\n              >\r\n                 Back to sign in\r\n              </button>\r\n            </div>\r\n          </form>\r\n        )}\r\n\r\n        {/* Sign-up Success Message */}\r\n        {showSignupSuccess && (\r\n          <div className=\"text-center space-y-3\">\r\n            <div className=\"text-green-500 text-5xl mb-3\"></div>\r\n            <h2 className=\"text-xl font-bold text-[#F5F5F5] mb-1.5\">Account Created!</h2>\r\n            <p className=\"text-[#CFCFCF] mb-4 text-sm\">{successMessage}</p>\r\n            <div className=\"space-y-2.5\">\r\n              <Button\r\n                onClick={() => {\r\n                  setShowSignupSuccess(false);\r\n                  setEmailMode('signin');\r\n                  setPassword('');\r\n                  setEmailError('');\r\n                  setPasswordError('');\r\n                  setErrorMessage('');\r\n                  setSuccessMessage('');\r\n                }}\r\n                variant=\"primary\"\r\n                className=\"w-full hover:scale-105 transition-all duration-300 py-1.5 md:py-2 lg:py-2.5\"\r\n              >\r\n                Sign In Now\r\n              </Button>\r\n              <button\r\n                onClick={() => {\r\n                  setShowSignupSuccess(false);\r\n                  setEmailMode('options');\r\n                  setEmail('');\r\n                  setPassword('');\r\n                  setEmailError('');\r\n                  setPasswordError('');\r\n                  setErrorMessage('');\r\n                  setSuccessMessage('');\r\n                }}\r\n                className=\"text-text-muted hover:text-text-primary transition-colors text-xs\"\r\n              >\r\n                 Back to options\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Auth Options */}\r\n        {emailMode === 'options' && (\r\n          <div className=\"space-y-2.5 md:space-y-3 lg:space-y-3.5\">\r\n            <button\r\n              onClick={() => handleAuth('google')}\r\n              disabled={isLoading}\r\n              className=\"w-full flex items-center justify-center space-x-2 md:space-x-3 lg:space-x-4 hover:scale-105 active:scale-95 transition-all duration-300 py-1.5 md:py-2 lg:py-2.5 px-4 md:px-5 lg:px-6 font-bold rounded-xl bg-white text-gray-700 hover:shadow-lg hover:shadow-blue-500/25 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-background disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:active:scale-100 border border-gray-200 text-sm md:text-base\"\r\n            >\r\n              <svg className=\"w-4 h-4 md:w-5 md:h-5\" viewBox=\"0 0 24 24\">\r\n                <path fill=\"#4285F4\" d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"/>\r\n                <path fill=\"#34A853\" d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"/>\r\n                <path fill=\"#FBBC05\" d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"/>\r\n                <path fill=\"#EA4335\" d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"/>\r\n              </svg>\r\n              <span>Continue with Google</span>\r\n            </button>\r\n\r\n            <button\r\n              onClick={() => handleAuth('discord')}\r\n              disabled={isLoading}\r\n              className=\"w-full flex items-center justify-center space-x-2 md:space-x-3 lg:space-x-4 hover:scale-105 active:scale-95 transition-all duration-300 py-1.5 md:py-2 lg:py-2.5 px-4 md:px-5 lg:px-6 font-bold rounded-xl bg-[#5865F2] text-white hover:bg-[#4752C4] hover:shadow-lg hover:shadow-indigo-500/25 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-background disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:active:scale-100 text-sm md:text-base\"\r\n            >\r\n              <svg className=\"w-4 h-4 md:w-5 md:h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path d=\"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z\"/>\r\n              </svg>\r\n              <span>Continue with Discord</span>\r\n            </button>\r\n\r\n            <div className=\"space-y-2 md:space-y-2.5 lg:space-y-3\">\r\n              <button\r\n                onClick={() => setEmailMode('signin')}\r\n                disabled={isLoading}\r\n                className=\"w-full md:hover:scale-105 active:scale-95 transition-all duration-300 py-1.5 md:py-2 lg:py-2.5 px-4 md:px-5 lg:px-6 font-bold rounded-xl bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] text-white md:hover:shadow-xl md:hover:shadow-[#E53A3A]/25 focus:outline-none focus:ring-2 focus:ring-[#E53A3A] focus:ring-offset-2 focus:ring-offset-background disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:active:scale-100 text-sm md:text-base\"\r\n              >\r\n                Sign In with Email\r\n              </button>\r\n              <Button\r\n                onClick={() => setEmailMode('signup')}\r\n                disabled={isLoading}\r\n                variant=\"ghost\"\r\n                className=\"w-full hover:scale-105 transition-all duration-300 py-1.5 md:py-2 lg:py-2.5 text-sm md:text-base\"\r\n              >\r\n                Create New Account\r\n              </Button>\r\n            </div>\r\n\r\n          </div>\r\n        )}\r\n\r\n        {/* Back to Landing */}\r\n        <div className=\"text-center mt-2.5 md:mt-4 lg:mt-6\">\r\n          <button\r\n            onClick={() => {\r\n                            onBackToLanding();\r\n            }}\r\n            className=\"text-text-muted hover:text-text-primary transition-colors text-xs md:text-sm lg:text-base flex items-center justify-center space-x-1 md:space-x-2 mx-auto hover:scale-105 transition-all duration-300\"\r\n            aria-label=\"Return to landing page\"\r\n          >\r\n            <svg className=\"w-3 h-3 md:w-4 md:h-4 lg:w-5 lg:h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\r\n            </svg>\r\n            <span>Back to Landing Page</span>\r\n          </button>\r\n        </div>\r\n        \r\n        {/* PWA Install Banner */}\r\n        <div className=\"mt-2 md:mt-3 lg:mt-4\">\r\n          <PWAInstallBanner />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Footer */}\r\n      <div className=\"absolute bottom-2 md:bottom-3 lg:bottom-4 left-0 right-0 p-3 md:p-4 lg:p-5 text-center\">\r\n        <p className=\"text-xs md:text-sm lg:text-base text-text-muted\">\r\n          By continuing, you agree to our{' '}\r\n          <button\r\n            onClick={() => setShowTermsModal(true)}\r\n            className=\"text-primary hover:text-secondary transition-colors underline\"\r\n          >\r\n            Terms of Service\r\n          </button>\r\n          {' '}and{' '}\r\n          <button\r\n            onClick={() => setShowPrivacyModal(true)}\r\n            className=\"text-primary hover:text-secondary transition-colors underline\"\r\n          >\r\n            Privacy Policy\r\n          </button>\r\n          .\r\n        </p>\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      <TermsModal\r\n        isOpen={showTermsModal}\r\n        onClose={() => setShowTermsModal(false)}\r\n      />\r\n      <PrivacyModal\r\n        isOpen={showPrivacyModal}\r\n        onClose={() => setShowPrivacyModal(false)}\r\n      />\r\n\r\n      {/* Signup Modal */}\r\n      {showSignupModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-surface border border-surface-light/20 rounded-xl p-6 max-w-md mx-4\">\r\n            <div className=\"text-center\">\r\n              {signupModalType === 'success' && (\r\n                <div className=\"w-16 h-16 mx-auto mb-4 bg-green-500/20 rounded-full flex items-center justify-center\">\r\n                  <svg className=\"w-8 h-8 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M5 13l4 4L19 7\"></path>\r\n                  </svg>\r\n                </div>\r\n              )}\r\n              {(signupModalType === 'email-exists' || signupModalType === 'invalid-email') && (\r\n                <div className=\"w-16 h-16 mx-auto mb-4 bg-red-500/20 rounded-full flex items-center justify-center\">\r\n                  <svg className=\"w-8 h-8 text-red-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\"></path>\r\n                  </svg>\r\n                </div>\r\n              )}\r\n              \r\n              <h3 className=\"text-lg font-semibold text-text-primary mb-4\">\r\n                {signupModalType === 'success' && 'Email Sent!'}\r\n                {signupModalType === 'email-exists' && 'Email Already Exists'}\r\n                {signupModalType === 'invalid-email' && (signupModalMessage.includes('cooldown') ? 'Retry Later' : 'Invalid Email')}\r\n              </h3>\r\n              \r\n              <p className=\"text-text-secondary mb-6\">\r\n                {signupModalMessage}\r\n              </p>\r\n              \r\n              <div className=\"flex space-x-3\">\r\n                <button\r\n                  onClick={handleSignupModalClose}\r\n                  className=\"flex-1 px-4 py-2 bg-primary hover:bg-primary/80 text-white rounded-lg transition-colors\"\r\n                >\r\n                  {signupModalType === 'success' ? 'Back to Login' : 'Try Again'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginSplashScreen;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport Logo from '../ui/Logo';\r\nimport PWAInstallBanner from './PWAInstallBanner';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { User } from '../../types';\r\n\r\ninterface InitialSplashScreenProps {\r\n  onComplete: () => void;\r\n  user: User | null;\r\n}\r\n\r\nconst InitialSplashScreen: React.FC<InitialSplashScreenProps> = ({ onComplete, user }) => {\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  \r\n  // Reset isProcessing on mount to prevent stuck state after logout\r\n  useEffect(() => {\r\n        setIsProcessing(false);\r\n  }, []);\r\n  \r\n    const handleDownloadPCClient = () => {\r\n        const downloadUrl = 'https://github.com/readmet3xt/otakon-pc-client/releases/tag/v1.0.0';\r\n    window.open(downloadUrl, '_blank');\r\n  };\r\n\r\n  const handleStartAdventure = async () => {\r\n        if (isProcessing) {\r\n            return;\r\n    }\r\n    \r\n    setIsProcessing(true);\r\n    \r\n    try {\r\n            localStorage.setItem('otakon_has_seen_splash_screens', 'true');\r\n      \r\n      if (user) {\r\n                try {\r\n          // Update app_state with new onboarding status\r\n          const { error } = await supabase\r\n            .from('users')\r\n            .update({\r\n              has_seen_splash_screens: true,\r\n              app_state: {\r\n                onboardingStatus: 'how-to-use',\r\n                hasSeenSplashScreens: true,\r\n                completedInitialAt: new Date().toISOString()\r\n              }\r\n            })\r\n            .eq('auth_user_id', user.authUserId);\r\n            \r\n          if (error) {\r\n                      } else {\r\n                      }\r\n        } catch (error) {\r\n                  }\r\n      }\r\n      \r\n      onComplete();\r\n      \r\n    } catch (error) {\r\n      console.error(' [InitialSplashScreen] Error in button click:', error);\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"h-screen bg-gradient-to-br from-[#111111] to-[#0A0A0A] text-[#F5F5F5] flex flex-col items-center justify-center font-inter px-4 sm:px-6 md:px-8 text-center overflow-hidden\">\r\n      <div className=\"absolute top-0 left-0 w-full h-full bg-gradient-radial-at-top from-[#1C1C1C]/30 to-transparent pointer-events-none\"></div>\r\n      \r\n      <div className=\"flex flex-col items-center justify-center w-full max-w-2xl\">\r\n        <div className=\"flex-shrink-0 mb-1\">\r\n          <Logo className=\"w-24 h-24 sm:w-26 sm:h-26 md:w-28 md:h-28\" spinOnce={true} />\r\n        </div>\r\n\r\n        <h1 \r\n          className=\"text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] leading-normal\"\r\n        >\r\n          Otagon\r\n        </h1>\r\n\r\n        <p \r\n          className=\"text-base text-[#CFCFCF] leading-relaxed mt-1\"\r\n        >\r\n          Your Spoiler-Free Gaming Companion\r\n        </p>\r\n\r\n        <div \r\n          className=\"flex flex-col items-center justify-center gap-4 w-full max-w-lg mt-12 relative z-10\"\r\n          style={{ pointerEvents: 'auto' }}\r\n        >\r\n          <button\r\n            onClick={handleStartAdventure}\r\n            disabled={isProcessing}\r\n            className={`w-full bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] md:hover:from-[#D42A2A] md:hover:to-[#C87A1A] text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 md:hover:scale-105 md:hover:shadow-xl md:hover:shadow-[#E53A3A]/25 active:scale-95 text-base flex items-center justify-center relative z-10 ${isProcessing ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}`}\r\n            style={{ pointerEvents: 'auto' }}\r\n          >\r\n            {isProcessing ? 'Starting...' : 'Start the Adventure'}\r\n          </button>\r\n          \r\n          <button\r\n            onClick={handleDownloadPCClient}\r\n            className=\"w-full bg-gradient-to-r from-neutral-700 to-neutral-600 md:hover:from-neutral-600 md:hover:to-neutral-500 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 md:hover:scale-105 md:hover:shadow-lg active:scale-95 text-base flex items-center justify-center relative z-10 cursor-pointer\"\r\n            style={{ pointerEvents: 'auto' }}\r\n          >\r\n            Download PC Client\r\n          </button>\r\n          \r\n          {/* Installation Instructions */}\r\n          <div className=\"w-full text-center px-4 relative z-10\" style={{ pointerEvents: 'auto' }}>\r\n            <p className=\"text-xs sm:text-sm text-neutral-400 leading-relaxed\">\r\n              <span className=\"block sm:inline\">1. Download and install the Otagon Connector (.exe)  </span>\r\n              <span className=\"block sm:inline\">2. Open the connector app and enter the 6-digit code shown in the Otagon Connector App to connect Otagon app to your PC for instant screenshots.</span>\r\n            </p>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* PWA Install Banner - In normal document flow */}\r\n        <div className=\"w-full max-w-lg px-4 mt-8\">\r\n          <PWAInstallBanner />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InitialSplashScreen;\r\n","import React from 'react';\r\n\r\ninterface KeyboardIconProps {\r\n  className?: string;\r\n}\r\n\r\nconst KeyboardIcon: React.FC<KeyboardIconProps> = ({ className = 'w-6 h-6' }) => {\r\n  return (\r\n    <svg \r\n      className={className} \r\n      fill=\"none\" \r\n      stroke=\"currentColor\" \r\n      viewBox=\"0 0 24 24\" \r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n    >\r\n      <path \r\n        strokeLinecap=\"round\" \r\n        strokeLinejoin=\"round\" \r\n        strokeWidth=\"2\" \r\n        d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n      />\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default KeyboardIcon;\r\n","import React from 'react';\r\n\r\ninterface ScreenshotIconProps {\r\n  className?: string;\r\n}\r\n\r\nconst ScreenshotIcon: React.FC<ScreenshotIconProps> = ({ className = 'w-6 h-6' }) => {\r\n  return (\r\n    <svg \r\n      className={className} \r\n      fill=\"none\" \r\n      stroke=\"currentColor\" \r\n      viewBox=\"0 0 24 24\" \r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n    >\r\n      <path \r\n        strokeLinecap=\"round\" \r\n        strokeLinejoin=\"round\" \r\n        strokeWidth=\"2\" \r\n        d=\"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z\"\r\n      />\r\n      <path \r\n        strokeLinecap=\"round\" \r\n        strokeLinejoin=\"round\" \r\n        strokeWidth=\"2\" \r\n        d=\"M15 13a3 3 0 11-6 0 3 3 0 016 0z\"\r\n      />\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default ScreenshotIcon;\r\n","import React from 'react';\r\n\r\ninterface HandsFreeIconProps {\r\n  className?: string;\r\n  isActive?: boolean;\r\n}\r\n\r\nconst HandsFreeIcon: React.FC<HandsFreeIconProps> = ({ className = 'w-6 h-6', isActive = false }) => {\r\n  return (\r\n    <svg \r\n      className={`${className} ${isActive ? 'text-[#FFAB40]' : 'text-neutral-400'}`} \r\n      fill=\"none\" \r\n      stroke=\"currentColor\" \r\n      viewBox=\"0 0 24 24\" \r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n    >\r\n      <path \r\n        strokeLinecap=\"round\" \r\n        strokeLinejoin=\"round\" \r\n        strokeWidth=\"2\" \r\n        d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\"\r\n      />\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport { HandsFreeIcon };\r\n","import React from 'react';\r\n\r\nconst PauseIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    className={className}\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"currentColor\"\r\n  >\r\n    <path d=\"M6 19h4V5H6v14zm8-14v14h4V5h-4z\" />\r\n  </svg>\r\n);\r\n\r\nexport default PauseIcon;","import React from 'react';\r\n\r\nconst PlayIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    className={className}\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"currentColor\"\r\n  >\r\n    <path d=\"M8 5v14l11-7z\" />\r\n  </svg>\r\n);\r\n\r\nexport default PlayIcon;","import React from 'react';\r\nimport KeyboardIcon from '../ui/KeyboardIcon';\r\nimport ScreenshotIcon from '../ui/ScreenshotIcon';\r\nimport { HandsFreeIcon } from '../ui/HandsFreeIcon';\r\nimport PauseIcon from '../ui/PauseIcon';\r\nimport PlayIcon from '../ui/PlayIcon';\r\n\r\ninterface HowToUseSplashScreenProps {\r\n  onComplete: () => void;\r\n}\r\n\r\nconst InsightsIcon = ({ className = 'w-12 h-12' }: { className?: string }) => (\r\n  <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n    <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" />\r\n    <path d=\"M3 9h18M9 21V9\" />\r\n  </svg>\r\n);\r\n\r\nconst ProBadge = () => (\r\n  <span className=\"text-xs font-bold bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] text-white px-2 py-0.5 rounded-full uppercase tracking-wider ml-2\">\r\n    PRO\r\n  </span>\r\n);\r\n\r\nconst FeatureItem: React.FC<{ icon: React.ReactNode; title: React.ReactNode; children: React.ReactNode }> = ({ icon, title, children }) => {\r\n  return (\r\n    <div className=\"flex items-start gap-8 p-8 transition-all duration-500 hover:scale-105 bg-gradient-to-r from-[#1C1C1C]/40 to-[#0A0A0A]/40 border border-neutral-800/60 rounded-2xl backdrop-blur-sm\">\r\n      <div className=\"flex-shrink-0 flex items-center justify-center h-12 w-12 mt-1 rounded-xl bg-gradient-to-br from-[#FF4D4D]/20 to-[#FFAB40]/20 border-2 border-neutral-700/60 backdrop-blur-sm\">\r\n        {icon}\r\n      </div>\r\n      <div className=\"flex-grow\">\r\n        <h3 className=\"text-xl font-bold text-white mb-4 flex items-center\">{title}</h3>\r\n        <div className=\"text-neutral-300 text-base leading-relaxed space-y-3\">{children}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst HowToUseSplashScreen: React.FC<HowToUseSplashScreenProps> = ({ onComplete }) => {\r\n  const [isMounted, setIsMounted] = React.useState(false);\r\n\r\n  React.useEffect(() => {\r\n    // Ensure smooth render - show everything at once\r\n    setIsMounted(true);\r\n  }, []);\r\n\r\n  if (!isMounted) {\r\n    return (\r\n      <div className=\"h-screen bg-gradient-to-br from-[#111111] to-[#0A0A0A] flex items-center justify-center\">\r\n        <div className=\"animate-pulse text-[#FFAB40]\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"h-screen bg-gradient-to-br from-[#111111] to-[#0A0A0A] text-[#F5F5F5] flex flex-col font-inter\">\r\n      {/* Fixed Header */}\r\n      <header className=\"flex-shrink-0 px-4 sm:px-6 md:px-8 pt-3 sm:pt-4 md:pt-6 pb-2 sm:pb-3 text-center z-10 bg-gradient-to-br from-[#111111] to-[#0A0A0A]\">\r\n        <div className=\"max-w-4xl mx-auto\">\r\n          <h1 className=\"text-3xl font-bold text-white leading-normal\">You're Connected!</h1>\r\n          <p className=\"text-base text-neutral-300 leading-relaxed mt-2\">Master Otagon in four easy steps.</p>\r\n        </div>\r\n      </header>\r\n\r\n      {/* Scrollable Main Content */}\r\n      <main className=\"flex-1 overflow-y-auto px-4 sm:px-6 md:px-8 pb-3 sm:pb-4 md:pb-6 how-to-use-scrollbar\">\r\n        <div className=\"max-w-4xl mx-auto space-y-4 sm:space-y-6 py-2 sm:py-3\">\r\n          {/* Item 1: Capture */}\r\n          <FeatureItem\r\n            icon={<KeyboardIcon className=\"w-6 h-6 text-[#FFAB40]\" />}\r\n            title=\"1. Instant Capture\"\r\n          >\r\n            <p className=\"mb-4\">Use hotkeys to instantly analyze your game screen. Toggle the \r\n              <span className=\"inline-flex items-center align-middle mx-2 px-2 py-1 rounded-lg bg-black/50 border-2 border-neutral-700/60\">\r\n                <PauseIcon className=\"w-4 h-4 text-sky-400\" />\r\n                <span className=\"text-white mx-1\">/</span>\r\n                <PlayIcon className=\"w-4 h-4 text-neutral-400\" />\r\n              </span>\r\n               button to switch between auto-sending and manual review.</p>\r\n            <div className=\"space-y-3 text-sm p-4 bg-gradient-to-r from-black/40 to-neutral-900/40 rounded-xl border border-neutral-700/60 backdrop-blur-sm\">\r\n              <p><strong className=\"text-neutral-200\">Single Shot:</strong> <kbd className=\"px-3 py-1.5 mx-2 font-sans font-semibold text-neutral-200 bg-gradient-to-r from-neutral-900/60 to-neutral-800/60 border-2 border-neutral-700/60 rounded-lg\">F1</kbd></p>\r\n              <p><strong className=\"text-neutral-200\">Multi Shot:</strong> <kbd className=\"px-3 py-1.5 mx-2 font-sans font-semibold text-neutral-200 bg-gradient-to-r from-neutral-900/60 to-neutral-800/60 border-2 border-neutral-700/60 rounded-lg\">F2</kbd></p>\r\n              <p className=\"text-xs text-neutral-400 mt-2\">\r\n                 <strong>Custom Hotkeys:</strong> You can configure your own hotkeys in the PC client settings\r\n              </p>\r\n            </div>\r\n          </FeatureItem>\r\n\r\n          {/* Item 2: Screenshot Quality */}\r\n          <FeatureItem\r\n            icon={<ScreenshotIcon className=\"w-6 h-6 text-[#FFAB40]\" />}\r\n            title=\"2. The Perfect Screenshot\"\r\n          >\r\n            <p>For the best hints, capture clear, full-screen views of:</p>\r\n            <ul className=\"list-disc list-inside mt-3 space-y-2\">\r\n              <li>Your inventory, skill tree, or map screen.</li>\r\n              <li>The entire boss arena, including the boss.</li>\r\n              <li>The specific puzzle or object you're stuck on.</li>\r\n            </ul>\r\n          </FeatureItem>\r\n\r\n          {/* Item 3: Insights */}\r\n          <FeatureItem\r\n            icon={<InsightsIcon className=\"w-6 h-6 text-[#FFAB40]\" />}\r\n            title={<>3. Manage Insights<ProBadge /></>}\r\n          >\r\n            <p className=\"mb-4\">\r\n              Take direct control of your game wiki with natural language commands.\r\n            </p>\r\n            <div className=\"space-y-4 text-sm p-4 bg-gradient-to-r from-black/40 to-neutral-900/40 rounded-xl border border-neutral-700/60 backdrop-blur-sm\">\r\n              <p>\r\n                <strong className=\"text-neutral-200\">Add new tab:</strong><br/>\r\n                <kbd className=\"px-3 py-1.5 mt-2 inline-block font-sans font-semibold text-neutral-200 bg-gradient-to-r from-neutral-900/60 to-neutral-800/60 border-2 border-neutral-700/60 rounded-lg w-full text-left\">\"add tab [title]\"</kbd>\r\n              </p>\r\n              <p>\r\n                <strong className=\"text-neutral-200\">Modify existing tab:</strong><br/>\r\n                <kbd className=\"px-3 py-1.5 mt-1 inline-block font-sans font-semibold text-neutral-200 bg-gradient-to-r from-neutral-900/60 to-neutral-800/60 border-2 border-neutral-700/60 rounded-lg w-full text-left\">\"modify tab [id] to [new title]\"</kbd>\r\n              </p>\r\n              <p>\r\n                <strong className=\"text-neutral-200\">Delete a tab:</strong><br/>\r\n                <kbd className=\"px-3 py-1.5 mt-1 inline-block font-sans font-semibold text-neutral-200 bg-gradient-to-r from-neutral-900/60 to-neutral-800/60 border-2 border-neutral-700/60 rounded-lg w-full text-left\">\"delete tab [id] confirm\"</kbd>\r\n              </p>\r\n              <p className=\"text-xs text-neutral-400 mt-2\">\r\n                 <strong>Examples:</strong> \"add tab Game Progress\", \"modify tab tab_123 to Current Objectives\"\r\n              </p>\r\n            </div>\r\n          </FeatureItem>\r\n\r\n          {/* Item 4: Hands-Free */}\r\n          <FeatureItem\r\n            icon={<HandsFreeIcon isActive={true} className=\"w-6 h-6 text-[#FFAB40]\" />}\r\n            title={<>4. Go Hands-Free<ProBadge /></>}\r\n          >\r\n            <p>Stay immersed in the action. Enable Hands-Free mode to have hints and lore read aloud to you, keeping you focused on your game.</p>\r\n          </FeatureItem>\r\n        </div>\r\n      </main>\r\n\r\n      {/* Fixed Footer */}\r\n      <footer className=\"flex-shrink-0 p-6 sm:p-8 z-10 bg-gradient-to-br from-[#111111] to-[#0A0A0A]\">\r\n        <div className=\"w-full max-w-4xl mx-auto text-center\">\r\n          <button\r\n            onClick={onComplete}\r\n            className=\"bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] md:hover:from-[#E53A3A] md:hover:to-[#D98C1F] text-white font-bold py-4 px-8 rounded-xl transition-all duration-300 md:hover:scale-105 md:hover:shadow-lg active:scale-95 text-lg flex items-center justify-center mx-auto\"\r\n          >\r\n            Let's Begin\r\n          </button>\r\n        </div>\r\n      </footer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default React.memo(HowToUseSplashScreen);\r\n","import React, { useState } from 'react';\r\nimport StarIcon from '../ui/StarIcon';\r\nimport { HandsFreeIcon } from '../ui/HandsFreeIcon';\r\nimport KeyboardIcon from '../ui/KeyboardIcon';\r\n\r\ninterface ProFeaturesSplashScreenProps {\r\n  onComplete: () => void;\r\n  onUpgrade: () => void;\r\n  onUpgradeToVanguard: () => void;\r\n}\r\n\r\nconst ProFeature: React.FC<{ title: string; description: string; children: React.ReactNode }> = ({ title, description, children }) => (\r\n  <div className=\"flex items-start gap-4 sm:gap-6 md:gap-8 p-4 sm:p-6 bg-gradient-to-r from-[#1C1C1C]/80 to-[#0A0A0A]/80 backdrop-blur-xl rounded-2xl border-2 border-neutral-800/60 hover:border-neutral-700/80 hover:scale-105 transition-all duration-500 feature-card\">\r\n    <div className=\"flex-shrink-0 flex items-center justify-center h-10 w-10 sm:h-12 sm:w-12 mt-1 rounded-xl bg-gradient-to-br from-[#FF4D4D]/20 to-[#FFAB40]/20 border-2 border-neutral-700/60 backdrop-blur-sm\">\r\n       {children}\r\n    </div>\r\n    <div className=\"flex-1 min-w-0\">\r\n      <h3 className=\"text-sm sm:text-base md:text-lg lg:text-xl font-semibold text-white mb-1 sm:mb-2 leading-tight\">{title}</h3>\r\n      <p className=\"text-xs sm:text-sm md:text-base text-[#A3A3A3] leading-relaxed\">{description}</p>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst proFeatures = [\r\n  { title: \"Massively Increased Limits\", description: \"Get 1,583 Text | 328 Image Queries every month, so you never have to hold back.\", icon: <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"w-6 h-6 text-[#FFAB40]\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg> },\r\n  { title: \"Batch Screenshot Capture\", description: \"Instantly capture the last 5 minutes of gameplay with a hotkey. Otagon analyzes all key moments for a comprehensive summary.\", icon: <KeyboardIcon className=\"w-6 h-6 text-[#FFAB40]\" /> },\r\n  { title: \"In-Depth Insight Tabs\", description: \"Go beyond a simple hint. Get detailed breakdowns on lore, character builds, missed items, and more.\", icon: <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"w-6 h-6 text-[#FFAB40]\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" /><path d=\"M3 9h18M9 21V9\" /></svg> },\r\n  { title: \"Hands-Free Mode\", description: \"Stay focused on the action. Get hints read aloud to you without ever looking away from your screen.\", icon: <HandsFreeIcon isActive={true} className=\"w-6 h-6 text-[#FFAB40]\" /> },\r\n  { title: \"No Ads\", description: \"Enjoy a completely ad-free experience with no interruptions during your gaming sessions.\", icon: <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"w-6 h-6 text-[#FFAB40]\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"></path></svg> }\r\n];\r\n\r\nconst vanguardFeatures = [\r\n  { title: \"Lifetime Price Guarantee\", description: \"Your price of $20/year will never increase. Ever.\", icon: <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"w-6 h-6 text-amber-300\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\"></path></svg> },\r\n  { title: \"Exclusive Founder's Badge\", description: \"A permanent in-app badge showing your early support.\", icon: <StarIcon className=\"w-6 h-6 text-amber-300\" /> },\r\n  { title: \"Direct Influence\", description: \"Join the Founder's Council on Discord to help shape the future of Otagon.\", icon: <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"w-6 h-6 text-amber-300\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"></path><circle cx=\"9\" cy=\"7\" r=\"4\"></circle><path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"></path><path d=\"M16 3.13a4 4 0 0 1 0 7.75\"></path></svg> },\r\n  { title: \"First Access & Rewards\", description: \"Get beta access to all new features and earn by helping train our AI on new games.\", icon: <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"w-6 h-6 text-amber-300\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z\"></path><polyline points=\"3.27 6.96 12 12.01 20.73 6.96\"></polyline><line x1=\"12\" y1=\"22.08\" x2=\"12\" y2=\"12\"></line></svg> }\r\n];\r\n\r\nconst ProFeaturesSplashScreen: React.FC<ProFeaturesSplashScreenProps> = ({ onComplete, onUpgrade, onUpgradeToVanguard }) => {\r\n  const [activeTab, setActiveTab] = useState<'pro' | 'vanguard'>('pro');\r\n  const [isMounted, setIsMounted] = useState(false);\r\n\r\n  React.useEffect(() => {\r\n    // Ensure smooth render - show everything at once\r\n    setIsMounted(true);\r\n  }, []);\r\n\r\n  if (!isMounted) {\r\n    return (\r\n      <div className=\"h-screen bg-gradient-to-br from-[#111111] to-[#0A0A0A] flex items-center justify-center\">\r\n        <div className=\"animate-pulse text-[#FFAB40]\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"h-screen bg-gradient-to-br from-[#111111] to-[#0A0A0A] text-[#F5F5F5] flex flex-col font-inter overflow-hidden\">\r\n      {/* Header - Fixed */}\r\n      <header className=\"flex-shrink-0 px-4 sm:px-6 md:px-8 pt-4 sm:pt-6 pb-3 sm:pb-4 text-center bg-gradient-to-b from-[#111111]/95 to-transparent backdrop-blur-sm\">\r\n        <div className=\"max-w-2xl w-full mx-auto\">\r\n          <div className=\"flex justify-center mb-2\">\r\n            <StarIcon className=\"w-8 h-8 sm:w-10 sm:h-10 text-[#FFAB40]\" />\r\n          </div>\r\n          <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] leading-tight mb-2 pb-1\" style={{ lineHeight: '1.2', paddingBottom: '0.25rem' }}>Supercharge with Otagon Pro</h1>\r\n          <p className=\"text-sm sm:text-base md:text-lg text-neutral-300 leading-relaxed px-2\">Unlock exclusive features for the ultimate gaming companion.</p>\r\n\r\n          <div className=\"w-full max-w-sm mx-auto p-1 bg-gradient-to-r from-[#2E2E2E]/60 to-[#1A1A1A]/60 backdrop-blur-sm rounded-2xl flex items-center gap-1 mt-4 sm:mt-6\">\r\n            <button onClick={() => setActiveTab('pro')} className={`w-1/2 py-2 sm:py-3 text-xs sm:text-sm font-bold rounded-xl transition-all duration-300 active:scale-95 ${activeTab === 'pro' ? 'bg-gradient-to-r from-[#424242] to-[#2A2A2A] text-white shadow-lg' : 'text-neutral-300 md:hover:bg-neutral-700/50'}`}>Pro</button>\r\n            <button onClick={() => setActiveTab('vanguard')} className={`w-1/2 py-2 sm:py-3 text-xs sm:text-sm font-bold rounded-xl transition-all duration-300 active:scale-95 ${activeTab === 'vanguard' ? 'bg-gradient-to-r from-[#424242] to-[#2A2A2A] text-white shadow-lg' : 'text-neutral-300 md:hover:bg-neutral-700/50'}`}>Pro Vanguard</button>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      {/* Content - Scrollable */}\r\n      <main className=\"flex-1 overflow-y-auto px-4 sm:px-6 md:px-8 py-2 sm:py-4\">\r\n        <div className=\"max-w-2xl w-full mx-auto\">\r\n          <div className=\"space-y-3 sm:space-y-4 md:space-y-6\">\r\n             {activeTab === 'pro' && proFeatures.map(f => <ProFeature key={f.title} title={f.title} description={f.description}>{f.icon}</ProFeature>)}\r\n             {activeTab === 'vanguard' && (\r\n              <>\r\n                <div className=\"text-center p-3 sm:p-4 mb-4 sm:mb-6 bg-gradient-to-r from-amber-500/20 to-orange-500/20 border-2 border-amber-500/40 rounded-2xl backdrop-blur-sm\">\r\n                   <p className=\"font-bold text-amber-300 text-sm sm:text-base md:text-lg\">All Pro features are included!</p>\r\n               </div>\r\n               {vanguardFeatures.map(f => <ProFeature key={f.title} title={f.title} description={f.description}>{f.icon}</ProFeature>)}\r\n              </>\r\n             )}\r\n          </div>\r\n          {/* Extra padding to ensure content doesn't get hidden behind sticky footer */}\r\n          <div className=\"h-24 sm:h-32\"></div>\r\n        </div>\r\n      </main>\r\n\r\n      {/* Footer - Sticky */}\r\n      <footer className=\"flex-shrink-0 sticky bottom-0 bg-gradient-to-t from-[#0A0A0A]/95 via-[#0A0A0A]/90 to-transparent backdrop-blur-md border-t border-neutral-800/30 px-4 sm:px-6 md:px-8 pt-4 pb-4 sm:pb-6\">\r\n        <div className=\"w-full max-w-lg mx-auto space-y-2 sm:space-y-3\">\r\n          <button\r\n            onClick={activeTab === 'pro' ? onUpgrade : onUpgradeToVanguard}\r\n            disabled\r\n            className=\"w-full bg-gradient-to-r from-neutral-600 to-neutral-500 text-neutral-300 font-bold py-3 sm:py-4 px-6 rounded-xl transition-all duration-300 cursor-not-allowed opacity-50 text-sm sm:text-base flex items-center justify-center\"\r\n          >\r\n            Coming Soon\r\n          </button>\r\n          <button\r\n            onClick={onComplete}\r\n            className=\"w-full text-neutral-300 font-medium py-2 sm:py-3 px-4 rounded-xl hover:bg-neutral-800/50 transition-all duration-300 hover:scale-105 active:scale-95 text-xs sm:text-sm flex items-center justify-center\"\r\n          >\r\n            Maybe Later\r\n          </button>\r\n        </div>\r\n      </footer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default React.memo(ProFeaturesSplashScreen);\r\n","import React from 'react';\r\n\r\ninterface HintIconProps {\r\n  className?: string;\r\n}\r\n\r\nconst HintIcon: React.FC<HintIconProps> = ({ className = 'w-6 h-6' }) => {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      className={className}\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n    >\r\n      <circle cx=\"12\" cy=\"12\" r=\"10\" />\r\n      <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\" />\r\n      <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\" />\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default HintIcon;\r\n","import React from 'react';\r\n\r\ninterface DesktopIconProps {\r\n  className?: string;\r\n}\r\n\r\nconst DesktopIcon: React.FC<DesktopIconProps> = ({ className = 'w-6 h-6' }) => {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      className={className}\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n    >\r\n      <rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" ry=\"2\" />\r\n      <line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\" />\r\n      <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\" />\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default DesktopIcon;\r\n","import React from 'react';\r\n\r\ninterface BookmarkIconProps {\r\n  className?: string;\r\n}\r\n\r\nconst BookmarkIcon: React.FC<BookmarkIconProps> = ({ className = 'w-6 h-6' }) => {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      className={className}\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n    >\r\n      <path d=\"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z\" />\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default BookmarkIcon;\r\n","import React, { useState, useEffect } from 'react';\r\nimport ScreenshotIcon from '../ui/ScreenshotIcon';\r\nimport HintIcon from '../ui/HintIcon';\r\nimport DesktopIcon from '../ui/DesktopIcon';\r\nimport BookmarkIcon from '../ui/BookmarkIcon';\r\nimport { ConnectionStatus } from '../../types';\r\n\r\n// Feature flag: toggle to show or hide intro slides\r\nconst SHOW_INTRO_SLIDES = false;\r\n\r\nconst allSlides = [\r\n  {\r\n    icon: <ScreenshotIcon className=\"w-24 h-24 text-[#FF4D4D]\" />,\r\n    title: \"Instant Context from Any Screenshot\",\r\n    description: \"Upload a screenshot from any game. Otagon instantly identifies the game, your location, and what's happening. Get answers, not spoilers.\"\r\n  },\r\n  {\r\n    icon: <HintIcon className=\"w-24 h-24 text-[#FF4D4D]\" />,\r\n    title: \"Hints that Don't Spoil the Story\",\r\n    description: \"Stuck on a puzzle or boss? Get contextual, spoiler-free guidance. Discover rich lore about the world without ruining the surprise.\"\r\n  },\r\n  {\r\n    icon: <BookmarkIcon className=\"w-24 h-24 text-[#FF4D4D]\" />,\r\n    title: \"Automatic Progress Tracking\",\r\n    description: \"Otagon automatically organizes your chats by game and tracks your main story progress. Easily see how far you've come and pick up right where you left off.\"\r\n  },\r\n  {\r\n    icon: <DesktopIcon className=\"w-24 h-24 text-[#FF4D4D]\" />,\r\n    title: \"Connect Your PC for Instant Help\",\r\n    description: \"Link your desktop and mobile app to get help without leaving your game. Press a hotkey to instantly send a screenshot for analysis.\"\r\n  }\r\n];\r\n\r\nconst slides = SHOW_INTRO_SLIDES ? allSlides : allSlides.slice(-1);\r\n\r\ninterface SplashScreenProps {\r\n  onSkipConnection: () => void;\r\n  onConnect: (code: string) => void;\r\n  status: ConnectionStatus;\r\n  error: string | null;\r\n  connectionCode: string | null;\r\n  onConnectionSuccess: () => void;\r\n}\r\n\r\nconst SplashScreen: React.FC<SplashScreenProps> = ({ \r\n    onSkipConnection,\r\n    onConnect,\r\n    status,\r\n    error,\r\n    connectionCode,\r\n    onConnectionSuccess,\r\n }) => {\r\n  const [step, setStep] = useState(0);\r\n  const [code, setCode] = useState(connectionCode || '');\r\n  const [syncInitiated, setSyncInitiated] = useState(false);\r\n  const [connectionSuccessCalled, setConnectionSuccessCalled] = useState(false);\r\n  const [touchStartX, setTouchStartX] = useState<number | null>(null);\r\n  const [touchEndX, setTouchEndX] = useState<number | null>(null);\r\n  \r\n  useEffect(() => {\r\n    // This effect transitions to the next screen ONLY if the connection\r\n    // was successful AND it was initiated by the user clicking the button.\r\n    if (syncInitiated && status === ConnectionStatus.CONNECTED && !connectionSuccessCalled) {\r\n                setConnectionSuccessCalled(true);\r\n        // Immediate navigation - no delay\r\n        onConnectionSuccess();\r\n    }\r\n  }, [status, onConnectionSuccess, syncInitiated, connectionSuccessCalled]);\r\n\r\n  const currentSlide = slides[step];\r\n  const isLastStep = step === slides.length - 1;\r\n\r\n  const isConnecting = status === ConnectionStatus.CONNECTING;\r\n  const isConnected = status === ConnectionStatus.CONNECTED;\r\n\r\n  const handleNext = () => {\r\n    if (!isLastStep) {\r\n      setStep(s => s + 1);\r\n    }\r\n  };\r\n  \r\n  const handlePrev = () => {\r\n    if (step > 0) {\r\n      setStep(s => s - 1);\r\n    }\r\n  };\r\n\r\n  const handleConnectClick = () => {\r\n    if (isConnecting || isConnected) {\r\n      return;\r\n    }\r\n    setSyncInitiated(true);\r\n    setConnectionSuccessCalled(false); // Reset the flag for new connection attempt\r\n    onConnect(code);\r\n  };\r\n  \r\n  \r\n  const handleTouchStart = (e: React.TouchEvent) => {\r\n    setTouchEndX(null); // Clear end on new touch\r\n    const touch = e.targetTouches[0];\r\n    if (touch) {\r\n      setTouchStartX(touch.clientX);\r\n    }\r\n  };\r\n\r\n  const handleTouchMove = (e: React.TouchEvent) => {\r\n    const touch = e.targetTouches[0];\r\n    if (touch) {\r\n      setTouchEndX(touch.clientX);\r\n    }\r\n  };\r\n\r\n  const handleTouchEnd = () => {\r\n    if (!touchStartX || !touchEndX) {\r\n      return;\r\n    }\r\n    const distance = touchStartX - touchEndX;\r\n    const minSwipeDistance = 50;\r\n    const isLeftSwipe = distance > minSwipeDistance;\r\n    const isRightSwipe = distance < -minSwipeDistance;\r\n\r\n    if (isLeftSwipe) {\r\n      handleNext();\r\n    } else if (isRightSwipe) {\r\n      handlePrev();\r\n    }\r\n    // Reset after swipe action\r\n    setTouchStartX(null);\r\n    setTouchEndX(null);\r\n  };\r\n\r\n  const isCodeValid = /^\\d{6}$/.test(code);\r\n\r\n  return (\r\n    <div \r\n        className=\"h-screen bg-[#111111] text-[#F5F5F5] flex flex-col font-inter\"\r\n        onTouchStart={handleTouchStart}\r\n        onTouchMove={handleTouchMove}\r\n        onTouchEnd={handleTouchEnd}\r\n    >\r\n\r\n      <main className=\"flex-1 flex flex-col items-center justify-center p-4 sm:p-6 md:p-8\">\r\n        <div className=\"text-center max-w-lg w-full\">\r\n          <div className=\"mb-2 sm:mb-4 flex justify-center\">\r\n            {currentSlide?.icon}\r\n          </div>\r\n          <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold text-[#F5F5F5] mb-2 sm:mb-4 leading-normal\">{currentSlide?.title}</h1>\r\n          <p className=\"text-[#CFCFCF] text-base sm:text-lg md:text-xl mb-4 leading-relaxed\">{currentSlide?.description}</p>\r\n          \r\n          {isLastStep && (\r\n              <div className=\"space-y-3 sm:space-y-4 text-left\">\r\n                  <div className=\"text-center pb-2\">\r\n                      <button\r\n                        onClick={() => {\r\n                          const downloadUrl = 'https://github.com/readmet3xt/otakon-pc-client/releases/tag/v1.0.0';\r\n                          window.open(downloadUrl, '_blank');\r\n                        }}\r\n                        className=\"text-sm sm:text-base font-medium text-[#FF4D4D] hover:text-[#FF4D4D] hover:underline transition-all duration-300 hover:scale-105\"\r\n                      >\r\n                        Download PC Client (v1.0.0)\r\n                      </button>\r\n                  </div>\r\n                  <div>\r\n                      <label htmlFor=\"connection-code\" className=\"block text-sm sm:text-base font-medium text-[#CFCFCF] mb-2 text-center\">\r\n                        6-Digit Connection Code\r\n                      </label>\r\n                      <input\r\n                      id=\"connection-code\"\r\n                      type=\"text\"\r\n                      value={code}\r\n                      onChange={(e) => setCode(e.target.value)}\r\n                      placeholder=\"123456\"\r\n                      maxLength={6}\r\n                      pattern=\"\\d{6}\"\r\n                      title=\"Enter exactly 6 digits\"\r\n                      disabled={isConnecting || isConnected}\r\n                      required\r\n                      className=\"w-full bg-gradient-to-r from-[#2E2E2E] to-[#1A1A1A] border-2 border-[#424242]/60 rounded-xl py-2 sm:py-3 px-4 text-[#F5F5F5] placeholder-[#6E6E6E] focus:outline-none focus:ring-2 focus:ring-[#FFAB40] focus:border-[#FFAB40]/60 disabled:opacity-50 text-center text-lg sm:text-xl font-mono tracking-widest backdrop-blur-sm\"\r\n                      style={{ textAlign: 'center' }}\r\n                      />\r\n                  </div>\r\n                  <div className=\"min-h-[60px] pt-4 text-center text-base\">\r\n                      {error && (\r\n                        <div className=\"space-y-2\">\r\n                          <p className=\"text-[#E53A3A] whitespace-pre-line\">{error}</p>\r\n                          <button\r\n                            onClick={() => {\r\n                              setCode('');\r\n                              onConnect('');\r\n                            }}\r\n                            className=\"text-sm text-[#FFAB40] hover:text-[#FF4D4D] underline transition-colors\"\r\n                          >\r\n                            Try Again\r\n                          </button>\r\n                        </div>\r\n                      )}\r\n                      {isConnected && <p className=\"text-[#5CBB7B]\">You're all set! Your PC is now connected.</p>}\r\n                      {isConnecting && (\r\n                        <div className=\"flex items-center justify-center gap-2\">\r\n                          <div className=\"flex space-x-1\">\r\n                            <div className=\"w-2 h-2 bg-[#FFAB40] rounded-full animate-bounce\" style={{ animationDelay: '0ms' }}></div>\r\n                            <div className=\"w-2 h-2 bg-[#FFAB40] rounded-full animate-bounce\" style={{ animationDelay: '150ms' }}></div>\r\n                            <div className=\"w-2 h-2 bg-[#FFAB40] rounded-full animate-bounce\" style={{ animationDelay: '300ms' }}></div>\r\n                          </div>\r\n                          <p className=\"text-[#FFAB40]\">Connecting to PC...</p>\r\n                        </div>\r\n                      )}\r\n                  </div>\r\n              </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n      \r\n      <footer className=\"flex-shrink-0 px-4 sm:px-6 md:px-8 pt-3 sm:pt-4 pb-6 sm:pb-8\">\r\n        <div className=\"w-full max-w-lg mx-auto\">\r\n            {isLastStep ? (\r\n                <div className=\"flex flex-col gap-4\">\r\n                    <button\r\n                        onClick={handleConnectClick}\r\n                        disabled={isConnecting || !isCodeValid || error !== null}\r\n                        className={`w-full font-bold py-3 sm:py-4 px-6 sm:px-8 rounded-xl transition-all duration-300 flex items-center justify-center text-sm sm:text-base active:scale-95 ${\r\n                            isCodeValid && !isConnecting && !error\r\n                                ? 'bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] hover:from-[#D42A2A] hover:to-[#C87A1A] text-white hover:scale-105 hover:shadow-xl hover:shadow-[#E53A3A]/25' \r\n                                : 'bg-gradient-to-r from-neutral-600 to-neutral-500 text-neutral-300 cursor-not-allowed opacity-25'\r\n                        }`}\r\n                    >\r\n                        {isConnecting ? \"Connecting...\" : \"Sync Now\"}\r\n                    </button>\r\n                    <button\r\n                        onClick={onSkipConnection}\r\n                        disabled={isConnecting}\r\n                        className=\"w-full bg-gradient-to-r from-neutral-700 to-neutral-600 md:hover:from-neutral-600 md:hover:to-neutral-500 text-white font-bold py-3 sm:py-4 px-6 sm:px-8 rounded-xl transition-all duration-300 md:hover:scale-105 md:hover:shadow-lg active:scale-95 flex items-center justify-center text-sm sm:text-base disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                    >\r\n                        Skip for Now\r\n                    </button>\r\n            </div>\r\n            ) : (\r\n                <button\r\n                    onClick={handleNext}\r\n                    className=\"w-full bg-gradient-to-r from-neutral-700 to-neutral-600 md:hover:from-neutral-600 md:hover:to-neutral-500 text-white font-bold py-4 px-8 rounded-xl transition-all duration-300 md:hover:scale-105 md:hover:shadow-lg active:scale-95 flex items-center justify-center\"\r\n                >\r\n                    Next\r\n                </button>\r\n            )}\r\n        </div>\r\n      </footer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default React.memo(SplashScreen);\r\n\r\n","import { useState, useCallback } from 'react';\r\n\r\nexport interface ActiveSessionState {\r\n  isActive: boolean;\r\n  currentGameId?: string; // Corresponds to conversation.id\r\n}\r\n\r\nexport const useActiveSession = (initialState: ActiveSessionState = { isActive: false }) => {\r\n  const [session, setSession] = useState<ActiveSessionState>(initialState);\r\n\r\n  const toggleSession = useCallback((conversationId: string) => {\r\n    setSession(prevSession => {\r\n      // If toggling off, or switching to a new game's session\r\n      if (prevSession.isActive && prevSession.currentGameId === conversationId) {\r\n        return { isActive: false };\r\n      } else {\r\n        return { isActive: true, currentGameId: conversationId };\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const setActiveSession = useCallback((conversationId: string, isActive: boolean) => {\r\n    setSession({\r\n      isActive,\r\n      currentGameId: isActive ? conversationId : undefined\r\n    });\r\n  }, []);\r\n\r\n  return { \r\n    session, \r\n    toggleSession, \r\n    setActiveSession \r\n  };\r\n};\r\n","import React, { useEffect, useRef } from 'react';\r\n\r\ninterface ContextMenuProps {\r\n  isOpen: boolean;\r\n  position: { x: number; y: number };\r\n  onClose: () => void;\r\n  onDelete?: () => void;\r\n  onPin?: () => void;\r\n  onUnpin?: () => void;\r\n  onClearConversation?: () => void;\r\n  canDelete?: boolean;\r\n  canPin?: boolean;\r\n  isPinned?: boolean;\r\n  isEverythingElse?: boolean;\r\n}\r\n\r\nconst ContextMenu: React.FC<ContextMenuProps> = ({\r\n  isOpen,\r\n  position,\r\n  onClose,\r\n  onDelete,\r\n  onPin,\r\n  onUnpin,\r\n  onClearConversation,\r\n  canDelete = true,\r\n  canPin = true,\r\n  isPinned = false,\r\n  isEverythingElse = false,\r\n}) => {\r\n  const menuRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\r\n        onClose();\r\n      }\r\n    };\r\n\r\n    const handleEscape = (event: KeyboardEvent) => {\r\n      if (event.key === 'Escape') {\r\n        onClose();\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      document.addEventListener('keydown', handleEscape);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n      document.removeEventListener('keydown', handleEscape);\r\n    };\r\n  }, [isOpen, onClose]);\r\n\r\n  if (!isOpen) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div\r\n      ref={menuRef}\r\n      className=\"fixed z-[100] bg-surface border border-surface-light/20 rounded-lg shadow-xl py-2 min-w-[160px]\"\r\n      style={{\r\n        left: position.x,\r\n        top: position.y,\r\n        transform: position.y < 200 ? 'translate(-50%, 10px)' : 'translate(-50%, -100%)',\r\n      }}\r\n    >\r\n      {/* Pin/Unpin Option */}\r\n      {canPin && !isEverythingElse && (\r\n        <button\r\n          onClick={() => {\r\n            if (isPinned) {\r\n              onUnpin?.();\r\n            } else {\r\n              onPin?.();\r\n            }\r\n            onClose();\r\n          }}\r\n          className=\"w-full px-4 py-2 text-left text-text-primary hover:bg-surface-light/50 transition-colors duration-200 flex items-center space-x-3\"\r\n        >\r\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            {isPinned ? (\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\" />\r\n            ) : (\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\" />\r\n            )}\r\n          </svg>\r\n          <span>{isPinned ? 'Unpin' : 'Pin to top'}</span>\r\n        </button>\r\n      )}\r\n\r\n      {/* Clear conversation option - available for all conversations */}\r\n      <button\r\n        onClick={() => {\r\n          onClearConversation?.();\r\n          onClose();\r\n        }}\r\n        className=\"w-full px-4 py-2 text-left text-orange-400 hover:bg-orange-500/10 transition-colors duration-200 flex items-center space-x-3\"\r\n      >\r\n        <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n        </svg>\r\n        <span>Clear conversation</span>\r\n      </button>\r\n\r\n      {/* Delete Option */}\r\n      {canDelete && !isEverythingElse && (\r\n        <button\r\n          onClick={() => {\r\n            onDelete?.();\r\n            onClose();\r\n          }}\r\n          className=\"w-full px-4 py-2 text-left text-red-400 hover:bg-red-500/10 transition-colors duration-200 flex items-center space-x-3\"\r\n        >\r\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n          </svg>\r\n          <span>Delete</span>\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ContextMenu;\r\n","import React, { useState, useRef } from 'react';\r\nimport { Conversations, Conversation } from '../../types';\r\nimport ContextMenu from '../ui/ContextMenu';\r\n\r\ninterface SidebarProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  conversations: Conversations;\r\n  activeConversation: Conversation | null;\r\n  onConversationSelect: (id: string) => void;\r\n  onDeleteConversation: (id: string) => void;\r\n  onPinConversation?: (id: string) => void;\r\n  onUnpinConversation?: (id: string) => void;\r\n  onClearConversation?: (id: string) => void;\r\n  onAddGame?: () => void;\r\n}\r\n\r\nconst Sidebar: React.FC<SidebarProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  conversations,\r\n  activeConversation,\r\n  onConversationSelect,\r\n  onDeleteConversation,\r\n  onPinConversation,\r\n  onUnpinConversation,\r\n  onClearConversation,\r\n  onAddGame,\r\n}) => {\r\n  // Context menu state\r\n  const [contextMenu, setContextMenu] = useState<{\r\n    isOpen: boolean;\r\n    position: { x: number; y: number };\r\n    conversationId: string | null;\r\n  }>({\r\n    isOpen: false,\r\n    position: { x: 0, y: 0 },\r\n    conversationId: null,\r\n  });\r\n\r\n  // Long press detection\r\n  const longPressTimer = useRef<NodeJS.Timeout | null>(null);\r\n  const longPressDelay = 1500; // 1.5 seconds\r\n\r\n  // Sort conversations: Game Hub first, then pinned, then others (newest last)\r\n  const conversationList = Object.values(conversations).sort((a, b) => {\r\n    // \"Game Hub\" always at top\r\n    const aIsGameHub = a.isGameHub || a.id === 'game-hub' || a.title === 'Game Hub';\r\n    const bIsGameHub = b.isGameHub || b.id === 'game-hub' || b.title === 'Game Hub';\r\n    \r\n    if (aIsGameHub && !bIsGameHub) {\r\n      return -1;\r\n    }\r\n    if (!aIsGameHub && bIsGameHub) {\r\n      return 1;\r\n    }\r\n    \r\n    // Pinned conversations next (sorted by pinned date, oldest pinned first)\r\n    if (a.isPinned && !b.isPinned) {\r\n      return -1;\r\n    }\r\n    if (!a.isPinned && b.isPinned) {\r\n      return 1;\r\n    }\r\n    if (a.isPinned && b.isPinned) {\r\n      return (a.pinnedAt || 0) - (b.pinnedAt || 0);\r\n    }\r\n    \r\n    // Then by creation date (oldest first, newest last)\r\n    return a.createdAt - b.createdAt;\r\n  });\r\n\r\n  const handleContextMenu = (e: React.MouseEvent, conversationId: string) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    setContextMenu({\r\n      isOpen: true,\r\n      position: { x: e.clientX, y: e.clientY },\r\n      conversationId,\r\n    });\r\n  };\r\n\r\n  const handleLongPressStart = (conversationId: string) => {\r\n    longPressTimer.current = setTimeout(() => {\r\n      setContextMenu({\r\n        isOpen: true,\r\n        position: { x: window.innerWidth / 2, y: window.innerHeight / 2 },\r\n        conversationId,\r\n      });\r\n    }, longPressDelay);\r\n  };\r\n\r\n  const handleLongPressEnd = () => {\r\n    if (longPressTimer.current) {\r\n      clearTimeout(longPressTimer.current);\r\n      longPressTimer.current = null;\r\n    }\r\n  };\r\n\r\n  const closeContextMenu = () => {\r\n    setContextMenu({\r\n      isOpen: false,\r\n      position: { x: 0, y: 0 },\r\n      conversationId: null,\r\n    });\r\n  };\r\n\r\n  const handleDelete = () => {\r\n    if (contextMenu.conversationId) {\r\n      onDeleteConversation(contextMenu.conversationId);\r\n      closeContextMenu();\r\n    }\r\n  };\r\n\r\n  const handlePin = () => {\r\n    if (contextMenu.conversationId && onPinConversation) {\r\n      onPinConversation(contextMenu.conversationId);\r\n      closeContextMenu();\r\n    }\r\n  };\r\n\r\n  const handleUnpin = () => {\r\n    if (contextMenu.conversationId && onUnpinConversation) {\r\n      onUnpinConversation(contextMenu.conversationId);\r\n      closeContextMenu();\r\n    }\r\n  };\r\n\r\n  const handleClearConversation = () => {\r\n    if (contextMenu.conversationId && onClearConversation) {\r\n      onClearConversation(contextMenu.conversationId);\r\n      closeContextMenu();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Overlay */}\r\n      {isOpen && (\r\n        <div\r\n          className=\"fixed inset-0 bg-black/60 backdrop-blur-md z-40 lg:hidden\"\r\n          onClick={onClose}\r\n        />\r\n      )}\r\n\r\n      {/* Sidebar */}\r\n      <div className={`fixed inset-y-0 left-0 z-50 w-72 sm:w-80 bg-gradient-to-b from-surface to-background border-r border-surface-light/20 transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0 ${\r\n        isOpen ? 'translate-x-0' : '-translate-x-full'\r\n      }`} style={{ zIndex: 50 }}>\r\n        <div className=\"flex flex-col h-full\">\r\n          {/* Header */}\r\n          <div className=\"p-4 sm:p-6 border-b border-surface-light/20 flex-shrink-0 relative\" style={{ zIndex: 10 }}>\r\n            <div className=\"flex items-center justify-between\">\r\n              <h2 className=\"text-xl sm:text-2xl font-bold text-text-primary\">Conversations</h2>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"lg:hidden btn-icon p-3 text-text-muted hover:text-text-primary active:scale-95 min-h-[44px] min-w-[44px] flex items-center justify-center\"\r\n              >\r\n                <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Add Game Button */}\r\n          {onAddGame && (\r\n            <div className=\"px-4 sm:px-6 pt-4 pb-2\">\r\n              <button\r\n                onClick={onAddGame}\r\n                className=\"w-full px-4 py-3 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] md:hover:from-[#D42A2A] md:hover:to-[#C87A1A] text-white font-medium rounded-lg transition-all shadow-lg md:hover:shadow-xl active:scale-95 flex items-center justify-center gap-2\"\r\n              >\r\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n                </svg>\r\n                <span>Add Game</span>\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Conversation List */}\r\n          <div className=\"flex-1 overflow-y-auto px-4 sm:px-6 pb-4 sm:pb-6 custom-scrollbar\" style={{ minHeight: 0 }}>\r\n            <div className=\"space-y-2 sm:space-y-3 pt-2\">\r\n              {conversationList.map((conversation) => {\r\n                const isGameHub = conversation.isGameHub || conversation.id === 'game-hub' || conversation.title === 'Game Hub';\r\n                const isUnreleased = conversation.isUnreleased || false;\r\n                const isRegularGame = !isGameHub && !isUnreleased && conversation.gameTitle;\r\n                \r\n                // Determine border color based on tab type\r\n                let borderClass = '';\r\n                let titleClass = 'text-text-primary';\r\n                \r\n                if (isGameHub) {\r\n                  // Game Hub: Otagon brand gradient (red to orange)\r\n                  borderClass = 'border-l-2 border-gradient-to-b from-[#FF4D4D] to-[#FFAB40]';\r\n                  titleClass = 'bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] bg-clip-text text-transparent';\r\n                } else if (isUnreleased) {\r\n                  // Unreleased games: Yellow\r\n                  borderClass = 'border-l-2 border-yellow-500';\r\n                  titleClass = 'text-yellow-400';\r\n                } else if (isRegularGame) {\r\n                  // Regular games: Orange\r\n                  borderClass = 'border-l-2 border-orange-500';\r\n                  titleClass = 'text-orange-400';\r\n                }\r\n                // Non-game conversations: No border, default text color\r\n                \r\n                return (\r\n                  <div\r\n                    key={conversation.id}\r\n                    className={`conversation-tab cursor-pointer transition-all duration-300 relative ${\r\n                      activeConversation?.id === conversation.id\r\n                        ? 'conversation-tab-active'\r\n                        : ''\r\n                    } ${borderClass}`}\r\n                    onClick={() => onConversationSelect(conversation.id)}\r\n                    onContextMenu={(e) => handleContextMenu(e, conversation.id)}\r\n                    onMouseDown={() => handleLongPressStart(conversation.id)}\r\n                    onMouseUp={handleLongPressEnd}\r\n                    onMouseLeave={handleLongPressEnd}\r\n                    onTouchStart={() => handleLongPressStart(conversation.id)}\r\n                    onTouchEnd={handleLongPressEnd}\r\n                    style={{ zIndex: 1 }}\r\n                  >\r\n                    <div className=\"flex items-center justify-between p-4 min-h-[60px]\">\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <div className=\"flex items-center space-x-2\">\r\n                          <p className={`text-xs font-medium truncate ${titleClass}`}>\r\n                            {conversation.title}\r\n                          </p>\r\n                          {isUnreleased && (\r\n                            <span className=\"flex-shrink-0 px-1.5 py-0.5 bg-yellow-500/20 border border-yellow-500/40 rounded text-[10px] text-yellow-400 font-medium\">\r\n                              UPCOMING\r\n                            </span>\r\n                          )}\r\n                          {conversation.isPinned && (\r\n                            <svg className=\"w-3 h-3 text-primary-dark flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                              <path d=\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\" />\r\n                            </svg>\r\n                          )}\r\n                        </div>\r\n                        <p className=\"text-xs text-text-muted mt-2\">\r\n                          {conversation.messages.length} messages\r\n                        </p>\r\n                        <p className=\"text-xs text-text-muted mt-1\">\r\n                          {new Date(conversation.updatedAt).toLocaleDateString()}\r\n                        </p>\r\n                    </div>\r\n                    \r\n                    {/* Delete button - only show for non-Game Hub conversations */}\r\n                    {!isGameHub && (\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          onDeleteConversation(conversation.id);\r\n                        }}\r\n                        className=\"opacity-0 group-hover:opacity-100 p-3 text-text-muted hover:text-red-400 transition-all duration-200 rounded-lg hover:bg-red-500/10 active:scale-95 min-h-[44px] min-w-[44px] flex items-center justify-center\"\r\n                      >\r\n                        <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                        </svg>\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                );\r\n              })}\r\n              \r\n              {conversationList.length === 0 && (\r\n                <div className=\"text-center py-12\">\r\n                  <div className=\"w-16 h-16 bg-gradient-to-r from-primary/20 to-secondary/20 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                    <svg className=\"w-8 h-8 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                    </svg>\r\n                  </div>\r\n                  <p className=\"text-text-muted text-lg\">No conversations yet</p>\r\n                  <p className=\"text-sm text-text-muted mt-2\">Create your first conversation to get started</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Context Menu */}\r\n      <ContextMenu\r\n        isOpen={contextMenu.isOpen}\r\n        position={contextMenu.position}\r\n        onClose={closeContextMenu}\r\n        onDelete={handleDelete}\r\n        onPin={handlePin}\r\n        onUnpin={handleUnpin}\r\n        onClearConversation={handleClearConversation}\r\n        canDelete={contextMenu.conversationId ? !conversations[contextMenu.conversationId]?.isGameHub : true}\r\n        canPin={contextMenu.conversationId ? !conversations[contextMenu.conversationId]?.isGameHub : true}\r\n        isPinned={contextMenu.conversationId ? conversations[contextMenu.conversationId]?.isPinned : false}\r\n        isEverythingElse={contextMenu.conversationId ? conversations[contextMenu.conversationId]?.isGameHub === true : false}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Sidebar;\r\n","import React from 'react';\r\nimport { User } from '../../types';\r\n\r\ninterface CreditIndicatorProps {\r\n  user: User;\r\n  onClick: () => void;\r\n}\r\n\r\nconst CreditIndicator: React.FC<CreditIndicatorProps> = ({ user, onClick }) => {\r\n  const { textCount, textLimit, imageCount, imageLimit } = user.usage;\r\n  \r\n\r\n  const textPercentRemaining = textLimit > 0 ? Math.max(0, 100 - (textCount / textLimit) * 100) : 0;\r\n  const imagePercentRemaining = imageLimit > 0 ? Math.max(0, 100 - (imageCount / imageLimit) * 100) : 0;\r\n\r\n  const radiusOuter = 13;\r\n  const circumferenceOuter = 2 * Math.PI * radiusOuter;\r\n  const offsetOuter = circumferenceOuter - (textPercentRemaining / 100) * circumferenceOuter;\r\n\r\n  const radiusInner = 8;\r\n  const circumferenceInner = 2 * Math.PI * radiusInner;\r\n  const offsetInner = circumferenceInner - (imagePercentRemaining / 100) * circumferenceInner;\r\n\r\n  const strokeWidth = 3.5;\r\n\r\n  return (\r\n    <div \r\n      className=\"credit-indicator-wrapper\"\r\n      style={{\r\n        display: 'inline-block',\r\n        background: 'linear-gradient(135deg, #E53A3A, #D98C1F)',\r\n        padding: '1px',\r\n        borderRadius: '8px',\r\n        // Add soft brand gradient shadow (reduced glow)\r\n        boxShadow: '0 4px 16px rgba(229, 58, 58, 0.2), 0 2px 8px rgba(217, 140, 31, 0.15), 0 1px 4px rgba(0, 0, 0, 0.1)',\r\n        filter: 'drop-shadow(0 0 10px rgba(229, 58, 58, 0.15))'\r\n      }}\r\n    >\r\n      <button\r\n        type=\"button\"\r\n        onClick={onClick}\r\n        className=\"credit-indicator-button flex items-center justify-center h-11 w-11 sm:h-12 sm:w-12 lg:h-14 lg:w-14 rounded-lg transition-all duration-300 hover:scale-105 active:scale-95 min-h-[44px] min-w-[44px]\"\r\n        style={{\r\n          background: '#0F0F0F',\r\n          border: 'none',\r\n          outline: 'none',\r\n          boxShadow: '0 2px 8px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1)',\r\n          width: '100%',\r\n          height: '100%'\r\n        }}\r\n        aria-label=\"View query credits\"\r\n      >\r\n        {/* All Screen Sizes: Circular Bars */}\r\n        <div className=\"w-7 h-7 sm:w-8 sm:h-8 lg:w-9 lg:h-9 xl:w-10 xl:h-10 flex items-center justify-center rounded-full p-0.5\" style={{\r\n          background: 'rgba(0, 0, 0, 0.2)'\r\n        }}>\r\n          <svg className=\"w-full h-full\" viewBox=\"0 0 32 32\" fill=\"none\">\r\n            <defs>\r\n              <linearGradient id=\"sky-gradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"1\">\r\n                <stop offset=\"0%\" stopColor=\"#38bdf8\" />\r\n                <stop offset=\"100%\" stopColor=\"#0ea5e9\" />\r\n              </linearGradient>\r\n              <linearGradient id=\"emerald-gradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"1\">\r\n                <stop offset=\"0%\" stopColor=\"#34d399\" />\r\n                <stop offset=\"100%\" stopColor=\"#10b981\" />\r\n              </linearGradient>\r\n            </defs>\r\n            {/* Outer circle (text) - only the colored ring */}\r\n            <circle \r\n              cx=\"16\" cy=\"16\" r={radiusOuter} \r\n              stroke=\"url(#sky-gradient)\" \r\n              strokeWidth={strokeWidth} \r\n              strokeDasharray={circumferenceOuter}\r\n              strokeDashoffset={offsetOuter}\r\n              strokeLinecap=\"round\"\r\n              transform=\"rotate(-90 16 16)\"\r\n            />\r\n            {/* Inner circle (image) - only the colored ring */}\r\n            <circle \r\n              cx=\"16\" cy=\"16\" r={radiusInner} \r\n              stroke=\"url(#emerald-gradient)\" \r\n              strokeWidth={strokeWidth}\r\n              strokeDasharray={circumferenceInner}\r\n              strokeDashoffset={offsetInner}\r\n              strokeLinecap=\"round\"\r\n              transform=\"rotate(-90 16 16)\"\r\n            />\r\n          </svg>\r\n        </div>\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CreditIndicator;\r\n","import React from 'react';\r\n\r\nexport const HandsFreeIcon: React.FC<{ isActive: boolean; className?: string }> = ({ isActive, className }) => (\r\n    <svg \r\n        xmlns=\"http://www.w3.org/2000/svg\" \r\n        className={className}\r\n        viewBox=\"0 0 24 24\" \r\n        fill=\"none\" \r\n        stroke=\"currentColor\" \r\n        strokeWidth=\"2\" \r\n        strokeLinecap=\"round\" \r\n        strokeLinejoin=\"round\"\r\n        width=\"24\"\r\n        height=\"24\"\r\n    >\r\n        <path d=\"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z\" fill={isActive ? 'currentColor' : 'none'}/>\r\n        <path d=\"M19 10v2a7 7 0 0 1-14 0v-2\" />\r\n    </svg>\r\n);\r\n\r\ninterface HandsFreeToggleProps {\r\n  isHandsFree: boolean;\r\n  onToggle: () => void;\r\n}\r\n\r\nconst HandsFreeToggle: React.FC<HandsFreeToggleProps> = ({ isHandsFree, onToggle }) => {\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      onClick={onToggle}\r\n      className={`btn-icon p-3 transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center ${\r\n        isHandsFree\r\n          ? 'text-green-400 hover:text-green-300'\r\n          : 'text-text-muted hover:text-text-primary'\r\n      }`}\r\n      aria-pressed={isHandsFree}\r\n      aria-label=\"Hands-Free Settings\"\r\n      title={isHandsFree ? 'Hands-Free Mode Active' : 'Hands-Free Voice Response Settings'}\r\n    >\r\n      <HandsFreeIcon className=\"w-5 h-5 sm:w-6 sm:h-6 flex-shrink-0\" isActive={isHandsFree} />\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default HandsFreeToggle;\r\n\r\n","import React from 'react';\r\n\r\ninterface LoadingSpinnerProps {\r\n  size?: 'sm' | 'md' | 'lg';\r\n  className?: string;\r\n}\r\n\r\nconst LoadingSpinner: React.FC<LoadingSpinnerProps> = ({ \r\n  size = 'md', \r\n  className = '' \r\n}) => {\r\n  const sizeClasses = {\r\n    sm: 'w-4 h-4',\r\n    md: 'w-6 h-6',\r\n    lg: 'w-8 h-8',\r\n  };\r\n\r\n  return (\r\n    <div className={`animate-spin rounded-full border-2 border-current border-t-transparent ${sizeClasses[size]} ${className}`} />\r\n  );\r\n};\r\n\r\nexport { LoadingSpinner };\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { UserTier } from '../../types';\r\nimport { authService } from '../../services/authService';\r\nimport { supabaseService } from '../../services/supabaseService';\r\nimport { toastService } from '../../services/toastService';\r\n\r\ninterface SettingsContextMenuProps {\r\n  isOpen: boolean;\r\n  position: { x: number; y: number };\r\n  onClose: () => void;\r\n  onOpenSettings: () => void;\r\n  onOpenGuide?: () => void;\r\n  onLogout: () => void;\r\n  userTier?: UserTier;\r\n  onTrialStart?: () => void;\r\n}\r\n\r\nconst SettingsContextMenu: React.FC<SettingsContextMenuProps> = ({\r\n  isOpen,\r\n  position,\r\n  onClose,\r\n  onOpenSettings,\r\n  onOpenGuide,\r\n  onLogout,\r\n  userTier,\r\n  onTrialStart,\r\n}) => {\r\n  const menuRef = useRef<HTMLDivElement>(null);\r\n  // Optimistic: Show trial button immediately for free users, hide if check fails\r\n  const [isTrialEligible, setIsTrialEligible] = useState(userTier === 'free');\r\n  const [isStartingTrial, setIsStartingTrial] = useState(false);\r\n\r\n  // Check trial eligibility when menu opens\r\n  useEffect(() => {\r\n    const checkTrialEligibility = async () => {\r\n      if (isOpen && userTier === 'free') {\r\n        try {\r\n          const currentUser = authService.getCurrentUser();\r\n          if (currentUser) {\r\n            const status = await supabaseService.getTrialStatus(currentUser.authUserId);\r\n            setIsTrialEligible(status?.isEligible && !status?.isActive || false);\r\n          }\r\n        } catch (error) {\r\n          console.error('Error checking trial eligibility:', error);\r\n          // Keep showing the button on error - user can try\r\n          setIsTrialEligible(true);\r\n        }\r\n      } else {\r\n        setIsTrialEligible(false);\r\n      }\r\n    };\r\n\r\n    checkTrialEligibility();\r\n  }, [isOpen, userTier]);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\r\n        onClose();\r\n      }\r\n    };\r\n\r\n    const handleEscape = (event: KeyboardEvent) => {\r\n      if (event.key === 'Escape') {\r\n        onClose();\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      document.addEventListener('keydown', handleEscape);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n      document.removeEventListener('keydown', handleEscape);\r\n    };\r\n  }, [isOpen, onClose]);\r\n\r\n  const handleStartTrial = async () => {\r\n    const currentUser = authService.getCurrentUser();\r\n    if (!currentUser || isStartingTrial) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsStartingTrial(true);\r\n      const success = await supabaseService.startTrial(currentUser.authUserId);\r\n      \r\n      if (success) {\r\n                toastService.success('Pro trial activated! Enjoy your 7-day trial.');\r\n        if (onTrialStart) {\r\n          onTrialStart();\r\n        }\r\n        onClose();\r\n      } else {\r\n        console.error(' Failed to start trial');\r\n        toastService.error('Failed to start trial. Please try again.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error starting trial:', error);\r\n      toastService.error('Failed to start trial. Please try again.');\r\n    } finally {\r\n      setIsStartingTrial(false);\r\n    }\r\n  };\r\n\r\n  if (!isOpen) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div\r\n      ref={menuRef}\r\n      className=\"fixed z-[100] bg-surface border border-surface-light/20 rounded-lg shadow-xl py-2 min-w-[200px]\"\r\n      style={{\r\n        left: position.x,\r\n        top: position.y,\r\n        transform: position.y < 200 ? 'translate(-50%, 10px)' : 'translate(-50%, -100%)',\r\n      }}\r\n    >\r\n      {/* Settings Option */}\r\n      <button\r\n        onClick={() => {\r\n          onOpenSettings();\r\n          onClose();\r\n        }}\r\n        className=\"w-full px-4 py-2 text-left text-text-primary hover:bg-surface-light/50 transition-colors duration-200 flex items-center space-x-3\"\r\n      >\r\n        <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" />\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n        </svg>\r\n        <span>Settings</span>\r\n      </button>\r\n\r\n      {/* Guide Option */}\r\n      {onOpenGuide && (\r\n        <button\r\n          onClick={() => {\r\n            onOpenGuide();\r\n            onClose();\r\n          }}\r\n          className=\"w-full px-4 py-2 text-left text-text-primary hover:bg-gradient-to-r hover:from-[#FF4D4D]/10 hover:to-[#FFAB40]/10 transition-colors duration-200 flex items-center space-x-3\"\r\n        >\r\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\" />\r\n          </svg>\r\n          <span>Guide</span>\r\n        </button>\r\n      )}\r\n\r\n      {/* Start Free Trial - Only show for free users who haven't used trial */}\r\n      {isTrialEligible && (\r\n        <button\r\n          onClick={handleStartTrial}\r\n          disabled={isStartingTrial}\r\n          className=\"w-full px-4 py-2 text-left text-blue-400 hover:bg-blue-500/10 transition-colors duration-200 flex items-center space-x-3 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n        >\r\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\r\n          </svg>\r\n          <span>{isStartingTrial ? 'Starting...' : 'Start 14-Day Pro Trial'}</span>\r\n        </button>\r\n      )}\r\n\r\n      {/* Divider before logout */}\r\n      <div className=\"border-t border-surface-light/20 my-1\" />\r\n\r\n      {/* Logout Option */}\r\n      <button\r\n        onClick={() => {\r\n          onLogout();\r\n          onClose();\r\n        }}\r\n        className=\"w-full px-4 py-2 text-left text-red-400 hover:bg-red-500/10 transition-colors duration-200 flex items-center space-x-3\"\r\n      >\r\n        <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\r\n        </svg>\r\n        <span>Logout</span>\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SettingsContextMenu;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { PlayerProfile } from '../../types';\r\n\r\ninterface ProfileSetupBannerProps {\r\n  onComplete: (profile: PlayerProfile) => void;\r\n  onDismiss: () => void;\r\n}\r\n\r\nexport const ProfileSetupBanner: React.FC<ProfileSetupBannerProps> = ({\r\n  onComplete,\r\n  onDismiss\r\n}) => {\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n  const [isMobile, setIsMobile] = useState(() => {\r\n    if (typeof window === 'undefined') {\r\n      return false;\r\n    }\r\n    return window.matchMedia('(max-width: 768px)').matches;\r\n  });\r\n  const [profile, setProfile] = useState<Partial<PlayerProfile>>({\r\n    hintStyle: 'Balanced',\r\n    playerFocus: 'Story-Driven',\r\n    preferredTone: 'Encouraging',\r\n    spoilerTolerance: 'Strict'\r\n  });\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') {\r\n      return;\r\n    }\r\n\r\n    const query = window.matchMedia('(max-width: 768px)');\r\n    const handleChange = (event: MediaQueryListEvent) => setIsMobile(event.matches);\r\n\r\n    setIsMobile(query.matches);\r\n    query.addEventListener('change', handleChange);\r\n\r\n    return () => query.removeEventListener('change', handleChange);\r\n  }, []);\r\n\r\n  const steps = [\r\n    {\r\n      title: \"How do you like your hints?\",\r\n      field: 'hintStyle' as keyof PlayerProfile,\r\n      options: [\r\n        { value: 'Cryptic', label: ' Cryptic' },\r\n        { value: 'Balanced', label: ' Balanced' },\r\n        { value: 'Direct', label: ' Direct' }\r\n      ]\r\n    },\r\n    {\r\n      title: \"What's your gaming focus?\",\r\n      field: 'playerFocus' as keyof PlayerProfile,\r\n      options: [\r\n        { value: 'Story-Driven', label: ' Story-Driven' },\r\n        { value: 'Completionist', label: ' Completionist' },\r\n        { value: 'Strategist', label: ' Strategist' }\r\n      ]\r\n    },\r\n    {\r\n      title: \"Preferred tone?\",\r\n      field: 'preferredTone' as keyof PlayerProfile,\r\n      options: [\r\n        { value: 'Encouraging', label: ' Encouraging' },\r\n        { value: 'Professional', label: ' Professional' },\r\n        { value: 'Casual', label: ' Casual' }\r\n      ]\r\n    },\r\n    {\r\n      title: \"Spoiler protection?\",\r\n      field: 'spoilerTolerance' as keyof PlayerProfile,\r\n      options: [\r\n        { value: 'Strict', label: ' Strict' },\r\n        { value: 'Moderate', label: ' Moderate' },\r\n        { value: 'Relaxed', label: ' Relaxed' }\r\n      ]\r\n    }\r\n  ];\r\n\r\n  const handleNext = () => {\r\n    if (currentStep < steps.length - 1) {\r\n      setCurrentStep(currentStep + 1);\r\n    } else {\r\n      onComplete(profile as PlayerProfile);\r\n    }\r\n  };\r\n\r\n  const handleBack = () => {\r\n    if (currentStep > 0) {\r\n      setCurrentStep(currentStep - 1);\r\n    }\r\n  };\r\n\r\n  const handleOptionSelect = (field: keyof PlayerProfile, value: string) => {\r\n    setProfile(prev => ({ ...prev, [field]: value }));\r\n    // Auto-advance after selection\r\n    setTimeout(() => {\r\n      if (currentStep < steps.length - 1) {\r\n        setCurrentStep(currentStep + 1);\r\n      } else {\r\n        onComplete({ ...profile, [field]: value } as PlayerProfile);\r\n      }\r\n    }, 300);\r\n  };\r\n\r\n  const currentStepData = steps[currentStep];\r\n  const progressPercent = ((currentStep + 1) / steps.length) * 100;\r\n  const shouldUseOverlay = isExpanded && isMobile;\r\n\r\n  useEffect(() => {\r\n    if (!shouldUseOverlay) {\r\n      return;\r\n    }\r\n\r\n    const originalOverflow = document.body.style.overflow;\r\n    document.body.style.overflow = 'hidden';\r\n\r\n    return () => {\r\n      document.body.style.overflow = originalOverflow;\r\n    };\r\n  }, [shouldUseOverlay]);\r\n\r\n  const collapsedBanner = (\r\n    <div className=\"mx-3 sm:mx-4 lg:mx-6 mb-4 sm:mb-6\">\r\n      <div className=\"bg-gradient-to-r from-[#FF4D4D]/10 to-[#FFAB40]/10 border-2 border-[#FF4D4D]/30 rounded-xl p-4 shadow-lg animate-slide-down backdrop-blur-sm\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center space-x-3 flex-1\">\r\n            <div className=\"w-10 h-10 bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] rounded-full flex items-center justify-center flex-shrink-0 shadow-lg\">\r\n              <svg className=\"w-5 h-5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n              </svg>\r\n            </div>\r\n            <div className=\"flex-1 min-w-0\">\r\n              <h3 className=\"text-base sm:text-lg font-semibold text-text-primary\">Personalize Your Experience</h3>\r\n              <p className=\"text-sm text-text-secondary hidden sm:block\">Set up your gaming preferences for better AI responses</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2 ml-3\">\r\n            <button\r\n              onClick={() => setIsExpanded(true)}\r\n              className=\"px-4 py-2 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] md:hover:from-[#D42A2A] md:hover:to-[#C87A1A] text-white text-sm font-bold rounded-lg transition-all md:hover:scale-105 active:scale-95 whitespace-nowrap shadow-lg\"\r\n            >\r\n              Set Up\r\n            </button>\r\n            <button\r\n              onClick={onDismiss}\r\n              className=\"p-2 text-text-muted hover:text-text-primary transition-colors\"\r\n              aria-label=\"Dismiss banner\"\r\n            >\r\n              <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  if (!isExpanded) {\r\n    return collapsedBanner;\r\n  }\r\n\r\n  const expandedCard = (\r\n    <div\r\n      className=\"bg-gradient-to-br from-[#1C1C1C] to-[#0A0A0A] border-2 border-[#FF4D4D]/30 rounded-xl shadow-2xl overflow-hidden animate-scale-in backdrop-blur-xl\"\r\n      role=\"dialog\"\r\n      aria-modal={isMobile}\r\n      aria-label=\"Profile setup wizard\"\r\n    >\r\n      {/* Header */}\r\n      <div className=\"bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] p-4 sm:p-5 shadow-xl\">\r\n        <div className=\"flex items-center justify-between mb-3\">\r\n          <div>\r\n            <h2 className=\"text-xl sm:text-2xl font-bold text-white\">Quick Setup</h2>\r\n            <p className=\"text-white/90 text-sm mt-1\">Step {currentStep + 1} of {steps.length}</p>\r\n          </div>\r\n          <button\r\n            onClick={() => setIsExpanded(false)}\r\n            className=\"p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-colors\"\r\n            aria-label=\"Minimize\"\r\n          >\r\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Progress bar */}\r\n        <div className=\"bg-white/20 rounded-full h-2 shadow-inner\">\r\n          <div\r\n            className=\"bg-white rounded-full h-2 transition-all duration-300 shadow-lg\"\r\n            style={{ width: `${progressPercent}%` }}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"p-4 sm:p-6\">\r\n        <h3 className=\"text-lg font-semibold text-text-primary mb-4\">{currentStepData.title}</h3>\r\n\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3\">\r\n          {currentStepData.options.map((option) => (\r\n            <button\r\n              key={option.value}\r\n              onClick={() => handleOptionSelect(currentStepData.field, option.value)}\r\n              className={`p-4 text-center rounded-lg border-2 transition-all duration-200 hover:scale-105 active:scale-95 ${\r\n                profile[currentStepData.field] === option.value\r\n                  ? 'border-[#FF4D4D] bg-gradient-to-br from-[#FF4D4D]/20 to-[#FFAB40]/20 text-text-primary ring-2 ring-[#FF4D4D]/50 shadow-lg'\r\n                  : 'border-surface-light/30 bg-surface/50 text-text-secondary hover:border-[#FF4D4D]/50 hover:bg-surface-light/30'\r\n              }`}\r\n            >\r\n              <div className=\"text-2xl mb-2\">{option.label.split(' ')[0]}</div>\r\n              <div className=\"text-sm font-medium\">{option.label.split(' ').slice(1).join(' ')}</div>\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Navigation */}\r\n        <div className=\"flex justify-between mt-6 pt-4 border-t border-surface-light/20\">\r\n          <div className=\"flex space-x-2\">\r\n            {currentStep > 0 && (\r\n              <button\r\n                onClick={handleBack}\r\n                className=\"px-4 py-2 bg-surface hover:bg-surface-light text-text-primary rounded-lg transition-colors text-sm font-medium\"\r\n              >\r\n                 Back\r\n              </button>\r\n            )}\r\n            <button\r\n              onClick={onDismiss}\r\n              className=\"px-4 py-2 text-text-muted hover:text-text-primary transition-colors text-sm\"\r\n            >\r\n              Skip for now\r\n            </button>\r\n          </div>\r\n\r\n          <button\r\n            onClick={handleNext}\r\n            className=\"px-6 py-2 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] md:hover:from-[#D42A2A] md:hover:to-[#C87A1A] text-white font-bold rounded-lg transition-all md:hover:scale-105 active:scale-95 text-sm shadow-lg\"\r\n          >\r\n            {currentStep === steps.length - 1 ? ' Complete' : 'Next '}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  if (shouldUseOverlay) {\r\n    const handleOverlayClick = (event: React.MouseEvent<HTMLDivElement>) => {\r\n      if (event.target === event.currentTarget) {\r\n        setIsExpanded(false);\r\n      }\r\n    };\r\n\r\n    return (\r\n      <div\r\n        className=\"fixed inset-0 z-[70] flex items-center justify-center px-4 py-6 bg-black/80 backdrop-blur-lg\"\r\n        onClick={handleOverlayClick}\r\n      >\r\n        <div className=\"w-full max-w-md max-h-[90vh] overflow-y-auto custom-scrollbar\">\r\n          {expandedCard}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"mx-3 sm:mx-4 lg:mx-6 mb-4 sm:mb-6\">\r\n      {expandedCard}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProfileSetupBanner;\r\n","import React, { useState } from 'react';\r\n\r\ninterface WelcomeScreenProps {\r\n  onStartChat: () => void;\r\n  onAddGame?: () => void;\r\n}\r\n\r\ntype TabType = 'overview' | 'features' | 'hotkeys' | 'best-practices';\r\n\r\nconst WelcomeScreen: React.FC<WelcomeScreenProps> = ({ onStartChat, onAddGame: _onAddGame }) => {\r\n  const [activeTab, setActiveTab] = useState<TabType>('overview');\r\n\r\n  const tabs = [\r\n    { id: 'overview' as TabType, label: 'Overview' },\r\n    { id: 'features' as TabType, label: 'Features' },\r\n    { id: 'hotkeys' as TabType, label: 'PC Hotkeys' },\r\n    { id: 'best-practices' as TabType, label: 'Best Practices' }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4\">\r\n      {/* Modal Container */}\r\n      <div className=\"relative w-full max-w-5xl max-h-[90vh] bg-background rounded-2xl shadow-2xl border border-transparent bg-clip-padding flex flex-col overflow-hidden\" style={{ backgroundImage: 'linear-gradient(#1a1a1a, #1a1a1a), linear-gradient(135deg, #FF4D4D, #FFAB40)', backgroundOrigin: 'border-box', backgroundClip: 'padding-box, border-box' }}>\r\n        {/* Close Button */}\r\n        <button\r\n          onClick={onStartChat}\r\n          className=\"absolute top-4 right-4 z-10 p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors\"\r\n          aria-label=\"Close guide\"\r\n        >\r\n          <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n          </svg>\r\n        </button>\r\n\r\n        {/* Tabs */}\r\n        <div className=\"flex-shrink-0 border-b border-gray-700 px-3 sm:px-6 pt-6\">\r\n          <div className=\"flex justify-center gap-2 sm:gap-3 overflow-x-auto pr-12\">\r\n            {tabs.map((tab) => (\r\n              <button\r\n                key={tab.id}\r\n                onClick={() => setActiveTab(tab.id)}\r\n                className={`flex items-center justify-center px-4 sm:px-6 py-3 min-h-[48px] text-xs sm:text-sm font-medium whitespace-nowrap transition-all duration-200 border-b-2 flex-shrink-0 ${\r\n                  activeTab === tab.id\r\n                    ? 'border-[#FF4D4D] text-white bg-gradient-to-b from-[#FF4D4D]/10 to-transparent'\r\n                    : 'border-transparent text-gray-400 hover:text-white hover:bg-gray-700/50'\r\n                }`}\r\n              >\r\n                <span>{tab.label}</span>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Content Area - Scrollable */}\r\n        <div className=\"flex-1 overflow-y-auto px-6 py-6 custom-scrollbar\">\r\n          <div className=\"max-w-4xl mx-auto\">\r\n            {activeTab === 'overview' && <OverviewTab />}\r\n            {activeTab === 'features' && <FeaturesTab />}\r\n            {activeTab === 'hotkeys' && <HotkeysTab />}\r\n            {activeTab === 'best-practices' && <BestPracticesTab />}\r\n          </div>\r\n        </div>\r\n\r\n        {/* CTA Buttons - Fixed at bottom */}\r\n        <div className=\"flex-shrink-0 py-3 sm:py-4 px-3 sm:px-6 border-t border-gray-700 bg-background\">\r\n          <div className=\"flex flex-col sm:flex-row gap-2 sm:gap-3 items-stretch sm:items-center justify-center\">\r\n            {/* Close Guide Button */}\r\n            <button\r\n              onClick={onStartChat}\r\n              className=\"inline-flex items-center justify-center gap-2 px-6 sm:px-8 py-2.5 sm:py-3 text-xs sm:text-sm font-bold text-white bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] md:hover:from-[#D42A2A] md:hover:to-[#C87A1A] rounded-lg shadow-lg md:hover:shadow-xl transition-all duration-200 md:hover:scale-105 active:scale-95\"\r\n            >\r\n              <span>Got It!</span>\r\n              <svg \r\n                className=\"w-5 h-5 flex-shrink-0\" \r\n                fill=\"none\" \r\n                stroke=\"currentColor\" \r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Overview Tab Component\r\nconst OverviewTab = () => (\r\n  <div className=\"space-y-6\">\r\n    <div className=\"bg-gradient-to-br from-[#1C1C1C] to-[#0A0A0A] border border-[#FF4D4D]/30 rounded-xl p-6 shadow-xl\">\r\n      <h2 className=\"text-xl sm:text-2xl font-bold text-text-primary mb-4 flex items-center\">\r\n        <span className=\"mr-3\"></span>\r\n        What is Otagon?\r\n      </h2>\r\n      <p className=\"text-sm sm:text-base text-text-muted leading-relaxed mb-4\">\r\n        Otagon is your intelligent gaming companion powered by AI. It helps you overcome challenges, \r\n        discover secrets, and master any game without spoiling the experience. Whether you're stuck \r\n        on a boss, need strategic advice, or want to understand game mechanics, Otagon has your back.\r\n      </p>\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-6\">\r\n        <div className=\"bg-gradient-to-br from-blue-500/10 to-blue-600/10 border border-blue-500/30 rounded-lg p-4\">\r\n          <div className=\"text-3xl mb-2\"></div>\r\n          <h3 className=\"font-semibold text-text-primary mb-2\">Screenshot Analysis</h3>\r\n          <p className=\"text-sm text-text-muted\">Upload any game screenshot for instant insights</p>\r\n        </div>\r\n        <div className=\"bg-gradient-to-br from-purple-500/10 to-purple-600/10 border border-purple-500/30 rounded-lg p-4\">\r\n          <div className=\"text-3xl mb-2\"></div>\r\n          <h3 className=\"font-semibold text-text-primary mb-2\">Game-Specific Tabs</h3>\r\n          <p className=\"text-sm text-text-muted\">Auto-organized tabs for each game you play</p>\r\n        </div>\r\n        <div className=\"bg-gradient-to-br from-green-500/10 to-green-600/10 border border-green-500/30 rounded-lg p-4\">\r\n          <div className=\"text-3xl mb-2\"></div>\r\n          <h3 className=\"font-semibold text-text-primary mb-2\">Smart Insights</h3>\r\n          <p className=\"text-sm text-text-muted\">Story, tips, builds auto-generated for you</p>\r\n        </div>\r\n        <div className=\"bg-gradient-to-br from-orange-500/10 to-orange-600/10 border border-orange-500/30 rounded-lg p-4\">\r\n          <div className=\"text-3xl mb-2\"></div>\r\n          <h3 className=\"font-semibold text-text-primary mb-2\">Dual Modes</h3>\r\n          <p className=\"text-sm text-text-muted\">Playing vs Planning for different needs</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div className=\"bg-surface/50 border border-surface-light/30 rounded-xl p-6\">\r\n      <h2 className=\"text-lg sm:text-xl font-bold text-text-primary mb-4 flex items-center\">\r\n        <span className=\"mr-3\"></span>\r\n        Quick Start Guide\r\n      </h2>\r\n      <ol className=\"space-y-4\">\r\n        <li className=\"flex items-start\">\r\n          <span className=\"flex-shrink-0 w-8 h-8 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-full flex items-center justify-center text-white font-bold text-sm mr-3\">1</span>\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-1\">Start in Game Hub</h3>\r\n            <p className=\"text-sm text-text-muted\">Ask general gaming questions or upload screenshots</p>\r\n          </div>\r\n        </li>\r\n        <li className=\"flex items-start\">\r\n          <span className=\"flex-shrink-0 w-8 h-8 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-full flex items-center justify-center text-white font-bold text-sm mr-3\">2</span>\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-1\">Create Game Tabs</h3>\r\n            <p className=\"text-sm text-text-muted\">Mention a game or upload its screenshot to create a dedicated tab</p>\r\n          </div>\r\n        </li>\r\n        <li className=\"flex items-start\">\r\n          <span className=\"flex-shrink-0 w-8 h-8 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-full flex items-center justify-center text-white font-bold text-sm mr-3\">3</span>\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-1\">Explore Insight Tabs</h3>\r\n            <p className=\"text-sm text-text-muted\">AI auto-generates Story, Tips, Builds tabs as you ask questions</p>\r\n          </div>\r\n        </li>\r\n        <li className=\"flex items-start\">\r\n          <span className=\"flex-shrink-0 w-8 h-8 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-full flex items-center justify-center text-white font-bold text-sm mr-3\">4</span>\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-1\">Toggle Modes</h3>\r\n            <p className=\"text-sm text-text-muted\">Switch between Playing (active help) and Planning (strategy)</p>\r\n          </div>\r\n        </li>\r\n      </ol>\r\n    </div>\r\n  </div>\r\n);\r\n\r\n// Features Tab Component\r\nconst FeaturesTab = () => {\r\n  const features = [\r\n    {\r\n      icon: '',\r\n      title: 'Screenshot Analysis',\r\n      description: 'Upload any game screenshot and get instant tactical advice, lore explanations, and hidden secrets.',\r\n      tips: [\r\n        'Works with any game - from AAA titles to indie gems',\r\n        'AI analyzes HUD elements, enemy types, inventory, and environment',\r\n        'Get tactical positioning advice and item recommendations'\r\n      ]\r\n    },\r\n    {\r\n      icon: '',\r\n      title: 'Game-Specific Tabs',\r\n      description: 'Otagon automatically creates dedicated tabs for each game you mention or screenshot.',\r\n      tips: [\r\n        'Each game gets its own organized conversation space',\r\n        'Tabs persist across sessions - your knowledge builds over time',\r\n        'Easily switch between multiple games you\\'re playing'\r\n      ]\r\n    },\r\n    {\r\n      icon: '',\r\n      title: 'Smart Insight Tabs',\r\n      description: 'AI automatically generates and updates specialized tabs for story, tips, builds, and more.',\r\n      tips: [\r\n        'Story tab: Spoiler-free lore and character backgrounds',\r\n        'Tips tab: Combat strategies, secrets, and optimizations',\r\n        'Builds tab: Character builds, skill trees, and equipment loadouts'\r\n      ]\r\n    },\r\n    {\r\n      icon: '',\r\n      title: 'Playing vs Planning Mode',\r\n      description: 'Toggle between active gameplay help and strategic planning modes.',\r\n      tips: [\r\n        'Playing Mode: Real-time tactical advice during active gameplay',\r\n        'Planning Mode: Strategic planning, builds, and long-term goals',\r\n        'AI adapts its responses based on your current mode'\r\n      ]\r\n    },\r\n    {\r\n      icon: '',\r\n      title: 'PC Connection',\r\n      description: 'Connect your PC client to send screenshots with a single hotkey press.',\r\n      tips: [\r\n        'No alt-tabbing required - stay in your game',\r\n        'Instant screenshot capture with F1 or F2',\r\n        'Automatic image upload and AI analysis'\r\n      ]\r\n    },\r\n    {\r\n      icon: '',\r\n      title: 'Hands-Free Mode',\r\n      description: 'Have AI responses read aloud while you focus on the game.',\r\n      tips: [\r\n        'Perfect for action games where you can\\'t look away',\r\n        'Natural voice synthesis for comfortable listening',\r\n        'Toggle on/off anytime from the header'\r\n      ]\r\n    },\r\n    {\r\n      icon: '',\r\n      title: 'Command Centre',\r\n      description: 'Use @ commands to manage insight tabs with natural language.',\r\n      tips: [\r\n        'Add new tabs: \"add tab Boss Strategies\"',\r\n        'Update existing: \"update @Tips with this strategy\"',\r\n        'Delete tabs: \"delete @Builds tab\"'\r\n      ]\r\n    },\r\n    {\r\n      icon: '',\r\n      title: 'Context-Aware AI',\r\n      description: 'AI remembers your conversation history and game progress.',\r\n      tips: [\r\n        'Follows up on previous questions naturally',\r\n        'Tracks your game progress across sessions',\r\n        'Provides personalized recommendations based on your playstyle'\r\n      ]\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-1 gap-6\">\r\n      {features.map((feature, index) => (\r\n        <div\r\n          key={index}\r\n          className=\"bg-gradient-to-br from-[#1C1C1C] to-[#0A0A0A] border border-surface-light/30 rounded-xl p-5 sm:p-6 hover:border-[#FF4D4D]/50 transition-all duration-300\"\r\n        >\r\n          <div className=\"flex items-start space-x-4\">\r\n            <div className=\"text-3xl sm:text-4xl flex-shrink-0\">{feature.icon}</div>\r\n            <div className=\"flex-1 min-w-0\">\r\n              <h3 className=\"text-lg sm:text-xl font-bold text-text-primary mb-2\">{feature.title}</h3>\r\n              <p className=\"text-sm sm:text-base text-text-muted mb-4 leading-relaxed\">{feature.description}</p>\r\n              <div className=\"space-y-2\">\r\n                {feature.tips.map((tip, tipIndex) => (\r\n                  <div key={tipIndex} className=\"flex items-start text-xs sm:text-sm\">\r\n                    <span className=\"text-[#FF4D4D] mr-2 mt-0.5 flex-shrink-0\"></span>\r\n                    <span className=\"text-text-secondary\">{tip}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Hotkeys Tab Component\r\nconst HotkeysTab = () => (\r\n  <div className=\"space-y-6\">\r\n    <div className=\"bg-gradient-to-r from-[#FF4D4D]/10 to-[#FFAB40]/10 border-2 border-[#FF4D4D]/30 rounded-xl p-6 shadow-xl\">\r\n      <div className=\"flex items-start space-x-4 mb-6\">\r\n        <div className=\"text-4xl\"></div>\r\n        <div className=\"flex-1\">\r\n          <h2 className=\"text-xl sm:text-2xl font-bold text-text-primary mb-2\">Download PC Client</h2>\r\n          <p className=\"text-sm sm:text-base text-text-muted mb-4\">\r\n            Get the Otagon PC client to enable hotkey screenshot capture. Stay in your game and send screenshots instantly!\r\n          </p>\r\n          <a\r\n            href=\"https://github.com/readmet3xt/otakon-pc-client/releases/tag/v1.0.0\"\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            className=\"inline-flex items-center px-6 py-3 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] md:hover:from-[#D42A2A] md:hover:to-[#C87A1A] text-white font-bold rounded-lg transition-all duration-300 md:hover:scale-105 active:scale-95 shadow-lg text-sm sm:text-base\"\r\n          >\r\n            <svg className=\"w-5 h-5 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path fillRule=\"evenodd\" d=\"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n            Download PC Client\r\n          </a>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div className=\"bg-gradient-to-br from-[#1C1C1C] to-[#0A0A0A] border border-surface-light/30 rounded-xl p-6\">\r\n      <h2 className=\"text-xl sm:text-2xl font-bold text-text-primary mb-6 flex items-center\">\r\n        <span className=\"mr-3\"></span>\r\n        Default Hotkeys\r\n      </h2>\r\n      \r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex items-center justify-between p-4 bg-surface/30 rounded-lg border border-surface-light/20\">\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-1\">Single Screenshot</h3>\r\n            <p className=\"text-sm text-text-muted\">Capture current game screen</p>\r\n          </div>\r\n          <kbd className=\"px-4 py-2 font-mono font-bold text-white bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-lg shadow-lg text-lg\">F1</kbd>\r\n        </div>\r\n\r\n        <div className=\"flex items-center justify-between p-4 bg-surface/30 rounded-lg border border-surface-light/20\">\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-1\">Batch Screenshot (PRO)</h3>\r\n            <p className=\"text-sm text-text-muted\">Capture last 5 minutes of gameplay</p>\r\n          </div>\r\n          <kbd className=\"px-4 py-2 font-mono font-bold text-white bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-lg shadow-lg text-lg\">F2</kbd>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div className=\"bg-surface/50 border border-surface-light/30 rounded-xl p-6\">\r\n      <h2 className=\"text-lg sm:text-xl font-bold text-text-primary mb-4 flex items-center\">\r\n        <span className=\"mr-3\"></span>\r\n        Setup Instructions\r\n      </h2>\r\n      <ol className=\"space-y-4\">\r\n        <li className=\"flex items-start\">\r\n          <span className=\"flex-shrink-0 w-8 h-8 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-full flex items-center justify-center text-white font-bold text-sm mr-3\">1</span>\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-1\">Download & Install</h3>\r\n            <p className=\"text-sm text-text-muted\">Download the PC client from the link above and run the installer</p>\r\n          </div>\r\n        </li>\r\n        <li className=\"flex items-start\">\r\n          <span className=\"flex-shrink-0 w-8 h-8 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-full flex items-center justify-center text-white font-bold text-sm mr-3\">2</span>\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-1\">Connect to Otagon</h3>\r\n            <p className=\"text-sm text-text-muted\">Click the connection icon in Otagon and enter the 6-digit code from the PC client</p>\r\n          </div>\r\n        </li>\r\n        <li className=\"flex items-start\">\r\n          <span className=\"flex-shrink-0 w-8 h-8 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-full flex items-center justify-center text-white font-bold text-sm mr-3\">3</span>\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-1\">Start Gaming</h3>\r\n            <p className=\"text-sm text-text-muted\">Launch your game and press F1 or F2 to capture screenshots</p>\r\n          </div>\r\n        </li>\r\n        <li className=\"flex items-start\">\r\n          <span className=\"flex-shrink-0 w-8 h-8 bg-gradient-to-r from-[#E53A3A] to-[#D98C1F] rounded-full flex items-center justify-center text-white font-bold text-sm mr-3\">4</span>\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-1\">Customize (Optional)</h3>\r\n            <p className=\"text-sm text-text-muted\">Configure custom hotkeys in the PC client settings</p>\r\n          </div>\r\n        </li>\r\n      </ol>\r\n    </div>\r\n\r\n    <div className=\"bg-blue-500/10 border border-blue-500/30 rounded-xl p-5\">\r\n      <div className=\"flex items-start space-x-3\">\r\n        <div className=\"text-2xl\"></div>\r\n        <div className=\"flex-1\">\r\n          <h3 className=\"font-semibold text-text-primary mb-2\">Pro Tip</h3>\r\n          <p className=\"text-sm text-text-muted leading-relaxed\">\r\n            Toggle between manual and auto-send mode using the pause/play button in Otagon. \r\n            Manual mode lets you review screenshots before sending, while auto mode sends them instantly for faster help.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\n// Best Practices Tab Component\r\nconst BestPracticesTab = () => {\r\n  const practices = [\r\n    {\r\n      category: ' Screenshot Best Practices',\r\n      tips: [\r\n        {\r\n          title: 'Capture Full Screen',\r\n          description: 'Include the entire game screen with HUD visible for better context',\r\n          example: ' Full arena view with health/mana bars visible'\r\n        },\r\n        {\r\n          title: 'Focus on the Problem',\r\n          description: 'Center the area you need help with in the screenshot',\r\n          example: ' Boss in frame, puzzle clearly visible, skill tree fully shown'\r\n        },\r\n        {\r\n          title: 'Include UI Elements',\r\n          description: 'Don\\'t crop out menus, inventories, or skill trees',\r\n          example: ' Show entire inventory screen, full skill tree, complete map'\r\n        },\r\n        {\r\n          title: 'Timing Matters',\r\n          description: 'Capture at the right moment for best results',\r\n          example: ' Before engaging boss, at decision points, when stuck'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      category: ' Asking Questions',\r\n      tips: [\r\n        {\r\n          title: 'Be Specific',\r\n          description: 'Clear questions get better answers',\r\n          example: ' \"How do I beat the second phase of Margit?\" vs  \"Help with boss\"'\r\n        },\r\n        {\r\n          title: 'Provide Context',\r\n          description: 'Mention your character level, gear, and what you\\'ve tried',\r\n          example: ' \"I\\'m level 25 with +3 sword, tried dodge rolling but still dying\"'\r\n        },\r\n        {\r\n          title: 'Ask Follow-ups',\r\n          description: 'Otagon remembers conversation history',\r\n          example: ' \"What about for mage builds?\" after asking about warrior strategies'\r\n        },\r\n        {\r\n          title: 'Use Natural Language',\r\n          description: 'Talk to Otagon like a gaming buddy',\r\n          example: ' \"I keep dying to this attack, any tips?\"'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      category: ' Tab Management',\r\n      tips: [\r\n        {\r\n          title: 'One Game Per Tab',\r\n          description: 'Create separate tabs for each game you play',\r\n          example: ' \"Elden Ring\" tab, \"Baldur\\'s Gate 3\" tab, etc.'\r\n        },\r\n        {\r\n          title: 'Use @ Commands',\r\n          description: 'Manage insight tabs with natural language',\r\n          example: ' \"add tab Boss Strategies\", \"update @Tips with this info\"'\r\n        },\r\n        {\r\n          title: 'Keep Game Hub Clean',\r\n          description: 'Use Game Hub for general questions, create game tabs for specific games',\r\n          example: ' Game Hub: \"Best RPGs of 2024?\"  Game-specific tab: actual gameplay'\r\n        },\r\n        {\r\n          title: 'Pin Important Tabs',\r\n          description: 'Pin up to 3 frequently used tabs for quick access',\r\n          example: ' Pin your current main game and frequently referenced guides'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      category: ' Mode Usage',\r\n      tips: [\r\n        {\r\n          title: 'Playing Mode',\r\n          description: 'Use during active gameplay for real-time tactical help',\r\n          example: ' Boss fights, difficult platforming, combat encounters'\r\n        },\r\n        {\r\n          title: 'Planning Mode',\r\n          description: 'Use when planning builds, routes, or long-term strategy',\r\n          example: ' Character builds, quest routing, gear optimization'\r\n        },\r\n        {\r\n          title: 'Switch Freely',\r\n          description: 'Toggle between modes based on your current needs',\r\n          example: ' Playing during raid, Planning during downtime'\r\n        },\r\n        {\r\n          title: 'Session Summaries',\r\n          description: 'AI creates summaries when you switch modes',\r\n          example: ' Captures key learnings from your playing session'\r\n        }\r\n      ]\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {practices.map((section, sectionIndex) => (\r\n        <div\r\n          key={sectionIndex}\r\n          className=\"bg-gradient-to-br from-[#1C1C1C] to-[#0A0A0A] border border-surface-light/30 rounded-xl p-5 sm:p-6\"\r\n        >\r\n          <h2 className=\"text-lg sm:text-xl font-bold text-text-primary mb-6\">{section.category}</h2>\r\n          <div className=\"space-y-5\">\r\n            {section.tips.map((tip, tipIndex) => (\r\n              <div key={tipIndex} className=\"bg-surface/30 border border-surface-light/20 rounded-lg p-4\">\r\n                <div className=\"flex items-start space-x-3 mb-2\">\r\n                  <span className=\"text-[#FF4D4D] text-xl font-bold mt-0.5\"></span>\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"font-semibold text-text-primary mb-1\">{tip.title}</h3>\r\n                    <p className=\"text-sm text-text-muted mb-2\">{tip.description}</p>\r\n                    <div className=\"bg-surface/50 border border-surface-light/10 rounded px-3 py-2 mt-2\">\r\n                      <p className=\"text-xs text-text-secondary font-mono\">{tip.example}</p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      ))}\r\n\r\n      <div className=\"bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/30 rounded-xl p-5\">\r\n        <div className=\"flex items-start space-x-3\">\r\n          <div className=\"text-3xl\"></div>\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"font-semibold text-text-primary mb-2 text-lg\">Remember</h3>\r\n            <p className=\"text-sm text-text-muted leading-relaxed mb-3\">\r\n              Otagon learns your playstyle over time. The more you interact, the better it gets at providing \r\n              personalized advice. Don't be afraid to ask for clarification or alternative strategies!\r\n            </p>\r\n            <div className=\"flex flex-wrap gap-2 mt-4\">\r\n              <span className=\"px-3 py-1 bg-green-500/20 border border-green-500/40 rounded-full text-xs text-green-300\">\r\n                 Be specific\r\n              </span>\r\n              <span className=\"px-3 py-1 bg-green-500/20 border border-green-500/40 rounded-full text-xs text-green-300\">\r\n                 Provide context\r\n              </span>\r\n              <span className=\"px-3 py-1 bg-green-500/20 border border-green-500/40 rounded-full text-xs text-green-300\">\r\n                 Use screenshots\r\n              </span>\r\n              <span className=\"px-3 py-1 bg-green-500/20 border border-green-500/40 rounded-full text-xs text-green-300\">\r\n                 Ask follow-ups\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WelcomeScreen;\r\n","import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\r\nimport { User, Conversation, Conversations, newsPrompts, ConnectionStatus } from '../types';\r\nimport { GAME_HUB_ID } from '../constants';\r\nimport { ConversationService } from '../services/conversationService';\r\nimport { authService } from '../services/authService';\r\nimport { aiService } from '../services/aiService';\r\nimport { useActiveSession } from '../hooks/useActiveSession';\r\nimport { suggestedPromptsService } from '../services/suggestedPromptsService';\r\nimport { sessionSummaryService } from '../services/sessionSummaryService';\r\nimport { gameTabService } from '../services/gameTabService';\r\nimport { errorRecoveryService } from '../services/errorRecoveryService';\r\nimport { UserService } from '../services/userService';\r\nimport { SupabaseService } from '../services/supabaseService';\r\nimport { supabase } from '../lib/supabase';\r\nimport { tabManagementService } from '../services/tabManagementService';\r\nimport { ttsService } from '../services/ttsService';\r\nimport { toastService } from '../services/toastService';\r\nimport { MessageRoutingService } from '../services/messageRoutingService';\r\nimport { sessionService } from '../services/sessionService';\r\nimport Sidebar from './layout/Sidebar';\r\nimport ChatInterface from './features/ChatInterface';\r\nimport SettingsModal from './modals/SettingsModal';\r\nimport CreditModal from './modals/CreditModal';\r\nimport ConnectionModal from './modals/ConnectionModal';\r\nimport HandsFreeModal from './modals/HandsFreeModal';\r\nimport AddGameModal from './modals/AddGameModal';\r\nimport Logo from './ui/Logo';\r\nimport CreditIndicator from './ui/CreditIndicator';\r\nimport HandsFreeToggle from './ui/HandsFreeToggle';\r\nimport { LoadingSpinner } from './ui/LoadingSpinner';\r\nimport SettingsContextMenu from './ui/SettingsContextMenu';\r\nimport ProfileSetupBanner from './ui/ProfileSetupBanner';\r\nimport GameProgressBar from './features/GameProgressBar';\r\nimport ErrorBoundary from './ErrorBoundary';\r\nimport WelcomeScreen from './welcome/WelcomeScreen';\r\nimport PWAInstallBanner from './splash/PWAInstallBanner';\r\nimport { connect, disconnect } from '../services/websocketService';\r\nimport { validateScreenshotDataUrl, getDataUrlSizeMB } from '../utils/imageValidation';\r\n\r\n// ============================================================================\r\n// ERROR FALLBACK COMPONENTS\r\n// ============================================================================\r\n\r\n//  NEW: Fallback UI for ChatInterface errors\r\nconst ChatErrorFallback: React.FC = () => (\r\n  <div className=\"flex-1 flex items-center justify-center p-4\">\r\n    <div className=\"max-w-md text-center\">\r\n      <div className=\"text-6xl mb-4\"></div>\r\n      <h2 className=\"text-xl font-bold text-[#F5F5F5] mb-2\">\r\n        Chat Temporarily Unavailable\r\n      </h2>\r\n      <p className=\"text-[#CFCFCF] mb-4\">\r\n        We encountered an error loading the chat. Please try refreshing.\r\n      </p>\r\n      <button\r\n        onClick={() => window.location.reload()}\r\n        className=\"px-4 py-2 bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] text-white rounded-lg font-semibold hover:scale-105 transition-transform\"\r\n      >\r\n        Refresh Page\r\n      </button>\r\n    </div>\r\n  </div>\r\n);\r\n\r\ninterface MainAppProps {\r\n  onLogout: () => void;\r\n  onOpenSettings: () => void;\r\n  onOpenAbout?: () => void;\r\n  onOpenPrivacy?: () => void;\r\n  onOpenRefund?: () => void;\r\n  onOpenContact?: () => void;\r\n  onOpenTerms?: () => void;\r\n  connectionStatus?: ConnectionStatus;\r\n  connectionError?: string | null;\r\n  onConnect?: (_code: string) => void;\r\n  onDisconnect?: () => void;\r\n  onClearConnectionError?: () => void;\r\n  onWebSocketMessage?: (_data: Record<string, unknown>) => void;\r\n  showProfileSetupBanner?: boolean;\r\n  onProfileSetupComplete?: (_profileData: Record<string, unknown>) => void;\r\n  onProfileSetupDismiss?: () => void;\r\n}\r\n\r\nconst MainApp: React.FC<MainAppProps> = ({\r\n  onLogout,\r\n  onOpenSettings: _onOpenSettings,\r\n  onOpenAbout: _onOpenAbout,\r\n  onOpenPrivacy: _onOpenPrivacy,\r\n  onOpenRefund: _onOpenRefund,\r\n  onOpenContact: _onOpenContact,\r\n  onOpenTerms: _onOpenTerms,\r\n  connectionStatus: propConnectionStatus,\r\n  connectionError: propConnectionError,\r\n  onConnect: propOnConnect,\r\n  onDisconnect: propOnDisconnect,\r\n  onClearConnectionError: propOnClearConnectionError,\r\n  onWebSocketMessage: propOnWebSocketMessage,\r\n  showProfileSetupBanner = false,\r\n  onProfileSetupComplete,\r\n  onProfileSetupDismiss,\r\n}) => {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [conversations, setConversations] = useState<Conversations>({});\r\n  const [activeConversation, setActiveConversation] = useState<Conversation | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isInitializing, setIsInitializing] = useState(true);\r\n  const [suggestedPrompts, setSuggestedPrompts] = useState<string[]>([]);\r\n  const [abortController, setAbortController] = useState<AbortController | null>(null);\r\n  \r\n  // Active session management\r\n  const { session, toggleSession, setActiveSession } = useActiveSession();\r\n  const [isManualUploadMode, setIsManualUploadMode] = useState(() => {\r\n    // Restore from localStorage, default to true (auto-upload OFF)\r\n    const saved = localStorage.getItem('otakon_manual_upload_mode');\r\n    return saved !== null ? saved === 'true' : true;\r\n  });\r\n  const [sidebarOpen, setSidebarOpen] = useState(false);\r\n  const [settingsOpen, setSettingsOpen] = useState(false);\r\n  const [creditModalOpen, setCreditModalOpen] = useState(false);\r\n  const [welcomeScreenOpen, setWelcomeScreenOpen] = useState(false);\r\n  const [connectionModalOpen, setConnectionModalOpen] = useState(false);\r\n  const [connectionCode, setConnectionCode] = useState<string | null>(null);\r\n  const [lastSuccessfulConnection, setLastSuccessfulConnection] = useState<Date | null>(null);\r\n  \r\n  // Hands-free mode state (persisted to localStorage)\r\n  const [isHandsFreeMode, setIsHandsFreeMode] = useState(() => {\r\n    const saved = localStorage.getItem('otakonHandsFreeMode');\r\n    return saved === 'true';\r\n  });\r\n  const [handsFreeModalOpen, setHandsFreeModalOpen] = useState(false);\r\n  \r\n  // Input preservation for tab switching\r\n  const [currentInputMessage, setCurrentInputMessage] = useState<string>('');\r\n  \r\n  //  NEW: Queued screenshot from WebSocket (manual mode)\r\n  const [queuedScreenshot, setQueuedScreenshot] = useState<string | null>(null);\r\n  \r\n  //  PERFORMANCE: Loading guards to prevent concurrent conversation loading\r\n  const isLoadingConversationsRef = useRef(false);\r\n  const hasLoadedConversationsRef = useRef(false);\r\n  \r\n  //  Ref to store latest handleSendMessage function\r\n  const handleSendMessageRef = useRef<((message: string, imageUrl?: string) => Promise<void>) | null>(null);\r\n  \r\n  //  RATE LIMITING: Track last request time to prevent rapid-fire duplicate requests\r\n  const lastRequestTimeRef = useRef<number>(0);\r\n  const RATE_LIMIT_DELAY_MS = 500; // Minimum 500ms between requests (prevents duplicate clicks)\r\n  \r\n  //  PERFORMANCE: Memoize currentUser to prevent re-creating object on every render\r\n  const currentUser = useMemo(() => user || { tier: 'free' } as User, [user]);\r\n  \r\n  // Add Game modal state\r\n  const [addGameModalOpen, setAddGameModalOpen] = useState(false);\r\n  \r\n  // Helper function to deep clone conversations to force React re-renders\r\n  const deepCloneConversations = (conversations: Conversations): Conversations => {\r\n    const cloned: Conversations = {};\r\n    Object.keys(conversations).forEach(key => {\r\n      cloned[key] = {\r\n        ...conversations[key],\r\n        //  DEEP CLONE: Clone array AND each subtab object (fixes React change detection)\r\n        subtabs: conversations[key].subtabs \r\n          ? conversations[key].subtabs?.map(tab => ({ ...tab }))\r\n          : undefined,\r\n        //  DEEP CLONE: Clone each message object\r\n        messages: conversations[key].messages.map(msg => ({ ...msg }))\r\n      };\r\n    });\r\n    return cloned;\r\n  };\r\n  \r\n  // Settings context menu state\r\n  const [settingsContextMenu, setSettingsContextMenu] = useState<{\r\n    isOpen: boolean;\r\n    position: { x: number; y: number };\r\n  }>({\r\n    isOpen: false,\r\n    position: { x: 0, y: 0 },\r\n  });\r\n  \r\n  // Use props for connection state, fallback to local state if not provided\r\n  const connectionStatus = propConnectionStatus ?? ConnectionStatus.DISCONNECTED;\r\n  const connectionError = propConnectionError ?? null;\r\n\r\n  // Restore connection state from localStorage on mount\r\n  useEffect(() => {\r\n    const savedConnectionCode = localStorage.getItem('otakon_connection_code');\r\n    if (savedConnectionCode) {\r\n      setConnectionCode(savedConnectionCode);\r\n      const lastConnection = localStorage.getItem('otakon_last_connection');\r\n      if (lastConnection) {\r\n        setLastSuccessfulConnection(new Date(lastConnection));\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Initialize TTS service on mount\r\n  useEffect(() => {\r\n    ttsService.init().catch((err: Error) => {\r\n          });\r\n  }, []);\r\n\r\n  // Persist auto-upload mode setting to localStorage\r\n  useEffect(() => {\r\n    localStorage.setItem('otakon_manual_upload_mode', String(isManualUploadMode));\r\n  }, [isManualUploadMode]);\r\n\r\n  // Handle WebSocket messages for screenshot processing\r\n  const handleWebSocketMessage = useCallback((data: Record<string, unknown>) => {\r\n        // Check if this is a connection confirmation from PC client\r\n    if (data.type === 'partner_connected' || data.type === 'connection_alive' || data.type === 'connected' || data.status === 'connected') {\r\n            // Get connection code from state or localStorage\r\n      const codeToUse = connectionCode || localStorage.getItem('otakon_connection_code');\r\n            // Update connection status in parent\r\n      if (propOnConnect && codeToUse) {\r\n                propOnConnect(codeToUse);\r\n      } else if (!propOnConnect) {\r\n              } else if (!codeToUse) {\r\n              }\r\n    }\r\n    \r\n    if (data.type === 'screenshot' && data.dataUrl) {\r\n      //  FIX: Validate screenshot data before processing\r\n      const validation = validateScreenshotDataUrl(data.dataUrl);\r\n      if (!validation.valid) {\r\n        console.error(' [MainApp] Screenshot validation failed:', validation.error);\r\n        toastService.error(`Screenshot validation failed: ${validation.error}`);\r\n        return;\r\n      }\r\n      \r\n      const sizeMB = getDataUrlSizeMB(data.dataUrl);\r\n      console.log(' [MainApp] Processing screenshot:', {\r\n        dataUrlLength: data.dataUrl.length,\r\n        sizeMB: sizeMB,\r\n        dataUrlPreview: data.dataUrl.substring(0, 50),\r\n        isManualUploadMode,\r\n        hasActiveConversation: !!activeConversation\r\n      });\r\n      \r\n      if (isManualUploadMode) {\r\n        //  FIXED: In manual mode, queue the image for ChatInterface (not text input!)\r\n                setQueuedScreenshot(data.dataUrl);\r\n                toastService.info('Screenshot queued. Review and send when ready.');\r\n        return; // Don't send automatically in manual mode\r\n      }\r\n      \r\n      // Auto mode: Send the screenshot to the active conversation immediately\r\n      if (activeConversation && handleSendMessageRef.current) {\r\n                handleSendMessageRef.current(\"\", data.dataUrl);\r\n        // Clear the queued screenshot immediately after sending in auto mode\r\n        setQueuedScreenshot(null);\r\n      } else {\r\n                toastService.warning('No active conversation. Please select or create a conversation first.');\r\n      }\r\n    }\r\n  }, [isManualUploadMode, activeConversation, propOnConnect, connectionCode]);\r\n\r\n  // Clear queued screenshot when it's been used\r\n  const handleScreenshotQueued = () => {\r\n    setQueuedScreenshot(null);\r\n  };\r\n\r\n  // Debug: Log when queuedScreenshot changes\r\n  useEffect(() => {\r\n    console.log(' [MainApp] queuedScreenshot state changed:', {\r\n      hasQueuedScreenshot: !!queuedScreenshot,\r\n      queuedScreenshotLength: queuedScreenshot?.length,\r\n      queuedScreenshotPreview: queuedScreenshot?.substring(0, 50)\r\n    });\r\n  }, [queuedScreenshot]);\r\n\r\n  // Expose the message handler to parent\r\n  useEffect(() => {\r\n    if (propOnWebSocketMessage) {\r\n      propOnWebSocketMessage(handleWebSocketMessage);\r\n    }\r\n  }, [propOnWebSocketMessage, handleWebSocketMessage]);\r\n\r\n  useEffect(() => {\r\n    const loadData = async (retryCount = 0) => {\r\n      //  PERFORMANCE: Guard against concurrent loads\r\n      if (isLoadingConversationsRef.current) {\r\n                return;\r\n      }\r\n      \r\n      //  PERFORMANCE: Skip if already loaded (unless retry)\r\n      if (hasLoadedConversationsRef.current && retryCount === 0) {\r\n                return;\r\n      }\r\n      \r\n      isLoadingConversationsRef.current = true;\r\n      \r\n      try {\r\n        // Get user from AuthService instead of UserService\r\n        const currentUser = authService.getCurrentUser();\r\n        if (currentUser) {\r\n          setUser(currentUser);\r\n          // Also sync to UserService for compatibility\r\n          UserService.setCurrentUser(currentUser);\r\n        } else if (retryCount === 0) {\r\n          // If no user on first attempt, wait a bit for auth state to settle after onboarding\r\n                    setTimeout(() => loadData(1), 500);\r\n          return;\r\n        }\r\n\r\n        console.log(' [MainApp] Loading conversations (attempt', retryCount + 1, ')');\r\n        \r\n        //  FIX: Ensure Game Hub exists first - this returns it directly (RLS workaround)\r\n        const gameHubFromEnsure = await ConversationService.ensureGameHubExists();\r\n                //  CRITICAL: Use cached conversations instead of requerying Supabase\r\n        // getConversations() bypasses cache and queries Supabase which fails due to RLS\r\n        const userConversations = ConversationService.getCachedConversations() || {};\r\n                console.log(' [MainApp] Conversation count:', Object.keys(userConversations).length);\r\n        \r\n        //  Ensure Game Hub is in the loaded conversations\r\n        if (gameHubFromEnsure && !userConversations[gameHubFromEnsure.id]) {\r\n                    userConversations[gameHubFromEnsure.id] = gameHubFromEnsure;\r\n        }\r\n        \r\n        setConversations(userConversations);\r\n\r\n        let active = await ConversationService.getActiveConversation();\r\n                // Handle all cases to ensure \"Game Hub\" is always available and active by default\r\n        let currentGameHub = Object.values(userConversations).find(\r\n          conv => conv.isGameHub || conv.title === 'Game Hub' || conv.id === 'game-hub'\r\n        );\r\n        \r\n        //  FIX: If still no Game Hub found, use the one from ensure\r\n        if (!currentGameHub && gameHubFromEnsure) {\r\n                    currentGameHub = gameHubFromEnsure;\r\n        }\r\n\r\n        // Case 1: No conversations at all (should not happen since we call ensureGameHubExists)\r\n        if (Object.keys(userConversations).length === 0) {\r\n                    const newConversation = ConversationService.createConversation('Game Hub', 'game-hub');\r\n          await ConversationService.addConversation(newConversation);\r\n          await ConversationService.setActiveConversation(newConversation.id);\r\n          \r\n          //  FIX: Use the newly created conversation directly\r\n          // If Supabase sync fails, ensure we still have the conversation in state\r\n          const updatedConversations = await ConversationService.getConversations();\r\n          \r\n          // Ensure the new conversation is in the state (merge if needed)\r\n          const finalConversations = Object.keys(updatedConversations).length > 0 \r\n            ? updatedConversations \r\n            : { [newConversation.id]: newConversation };\r\n          \r\n          setConversations(finalConversations);\r\n          active = finalConversations[newConversation.id];\r\n          setActiveConversation(active);\r\n          \r\n          // Mark as first-run complete since we just created and activated Game Hub\r\n          localStorage.setItem('otakon_has_used_app', 'true');\r\n          console.log(' [MainApp] Created and activated \"Game Hub\" conversation (first-run complete)');\r\n                  }\r\n        // Case 2: Game Hub exists but nothing is active - set Game Hub as active\r\n        // This handles first-time users after onboarding, as well as returning users\r\n        else if (!active && currentGameHub) {\r\n                    await ConversationService.setActiveConversation(currentGameHub.id);\r\n          const updatedConversations = await ConversationService.getConversations();\r\n          setConversations(updatedConversations);\r\n          active = updatedConversations[currentGameHub.id];\r\n          setActiveConversation(active);\r\n                  }\r\n        // Case 4: No \"Game Hub\" conversation but other conversations exist - create and activate it\r\n        else if (!currentGameHub) {\r\n                    const newConversation = ConversationService.createConversation('Game Hub', 'game-hub');\r\n          await ConversationService.addConversation(newConversation);\r\n          \r\n          // If no active conversation, make \"Game Hub\" active\r\n          if (!active) {\r\n            await ConversationService.setActiveConversation(newConversation.id);\r\n            const updatedConversations = await ConversationService.getConversations();\r\n            setConversations(updatedConversations);\r\n            active = updatedConversations['game-hub'];\r\n            setActiveConversation(active);\r\n                      } else {\r\n            // Otherwise, just add it but keep current active conversation\r\n            const updatedConversations = await ConversationService.getConversations();\r\n            setConversations(updatedConversations);\r\n            setActiveConversation(active);\r\n                      }\r\n        }\r\n        // Case 5: Active conversation exists - restore it\r\n        else if (active) {\r\n                    setActiveConversation(active);\r\n        }\r\n        // Case 6: FALLBACK - No active conversation but Game Hub exists\r\n        else if (currentGameHub) {\r\n                    await ConversationService.setActiveConversation(currentGameHub.id);\r\n          const updatedConversations = await ConversationService.getConversations();\r\n          setConversations(updatedConversations);\r\n          setActiveConversation(updatedConversations[currentGameHub.id]);\r\n        }\r\n\r\n        // Set initial suggested prompts for the active conversation\r\n        const finalActive = active || currentGameHub;\r\n        if (finalActive) {\r\n          if (finalActive.isGameHub || finalActive.id === GAME_HUB_ID) {\r\n            // For Game Hub tab, show news prompts if no messages\r\n            if (!finalActive.messages || finalActive.messages.length === 0) {\r\n              setSuggestedPrompts(newsPrompts);\r\n            } else {\r\n              const fallbackPrompts = suggestedPromptsService.getFallbackSuggestions(finalActive.id, finalActive.isGameHub);\r\n              setSuggestedPrompts(fallbackPrompts);\r\n            }\r\n          } else {\r\n            // For game tabs, show fallback prompts\r\n            const fallbackPrompts = suggestedPromptsService.getFallbackSuggestions(finalActive.id, finalActive.isGameHub);\r\n            setSuggestedPrompts(fallbackPrompts);\r\n          }\r\n        }\r\n        \r\n        //  CRITICAL: Only mark initialization as complete if we have an active conversation\r\n        // This prevents showing \"Loading chat...\" when there's no active conversation set\r\n        if (finalActive) {\r\n                    setIsInitializing(false);\r\n        } else {\r\n          console.error(' [MainApp] ERROR: No active conversation after initialization!');\r\n          // Force Game Hub as active if we somehow got here without one\r\n          const gameHubConv = Object.values(userConversations).find(\r\n            conv => conv.isGameHub || conv.title === 'Game Hub' || conv.id === 'game-hub'\r\n          );\r\n          if (gameHubConv) {\r\n            await ConversationService.setActiveConversation(gameHubConv.id);\r\n            const updatedConversations = await ConversationService.getConversations();\r\n            setConversations(updatedConversations);\r\n            setActiveConversation(updatedConversations[gameHubConv.id]);\r\n          }\r\n          setIsInitializing(false);\r\n        }\r\n        \r\n        //  PERFORMANCE: Mark conversations as successfully loaded\r\n        hasLoadedConversationsRef.current = true;\r\n      } catch (error) {\r\n        console.error(' [MainApp] Error loading data:', error);\r\n        \r\n        // Retry up to 3 times with exponential backoff\r\n        if (retryCount < 3) {\r\n          const delay = Math.pow(2, retryCount) * 1000; // 1s, 2s, 4s\r\n                    setTimeout(() => loadData(retryCount + 1), delay);\r\n        } else {\r\n          console.error(' [MainApp] Failed to load data after 3 attempts');\r\n          toastService.error('Failed to load conversations. Please refresh the page.', {\r\n            action: {\r\n              label: 'Refresh',\r\n              onClick: () => window.location.reload()\r\n            }\r\n          });\r\n          // Set a fallback state to prevent infinite loading\r\n          setActiveConversation(null);\r\n          setIsInitializing(false);\r\n        }\r\n      } finally {\r\n        //  PERFORMANCE: Always clear the loading flag\r\n        isLoadingConversationsRef.current = false;\r\n      }\r\n    };\r\n\r\n    loadData();\r\n  }, []);\r\n\r\n  // Safety timeout: Force initialization complete after 3 seconds to prevent infinite loading\r\n  useEffect(() => {\r\n    const timeout = setTimeout(() => {\r\n      if (isInitializing) {\r\n        // Only force complete if we have conversations, even without user\r\n        if (Object.keys(conversations).length > 0 || activeConversation) {\r\n                    setIsInitializing(false);\r\n        } else {\r\n          // Try to get user and load conversations one more time\r\n                    const currentUser = authService.getCurrentUser();\r\n          if (currentUser) {\r\n            setUser(currentUser);\r\n            UserService.setCurrentUser(currentUser);\r\n            setIsInitializing(false);\r\n          }\r\n        }\r\n      }\r\n    }, 3000); // Increased from 1s to 3s to allow Game Hub creation to complete\r\n    \r\n    return () => clearTimeout(timeout);\r\n  }, [isInitializing, conversations, activeConversation]);\r\n\r\n  //  PHASE 2 FIX: Real-time subscription for subtab updates\r\n  useEffect(() => {\r\n    if (!activeConversation?.id) return;\r\n    \r\n        // Subscribe to conversation updates\r\n    const subscription = supabase\r\n      .channel(`conversation:${activeConversation.id}`)\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: 'UPDATE',\r\n          schema: 'public',\r\n          table: 'conversations',\r\n          filter: `id=eq.${activeConversation.id}`\r\n        },\r\n        async (payload: Record<string, unknown>) => {\r\n                    // Update conversations state with fresh data\r\n          setConversations((prev) => {\r\n            const updated = { ...prev };\r\n            \r\n            // Merge the updated conversation data\r\n            if (payload.new && updated[activeConversation.id]) {\r\n              updated[activeConversation.id] = {\r\n                ...updated[activeConversation.id],\r\n                ...payload.new,\r\n                // Ensure subtabs array is properly handled\r\n                subtabs: payload.new.subtabs || updated[activeConversation.id].subtabs || []\r\n              };\r\n              \r\n                          }\r\n            \r\n            return updated;\r\n          });\r\n          \r\n          // Update active conversation if it's the one that changed\r\n          if (activeConversation.id === payload.new?.id) {\r\n            setActiveConversation((prev) => {\r\n              if (!prev) return prev;\r\n              return {\r\n                ...prev,\r\n                ...payload.new,\r\n                subtabs: payload.new.subtabs || prev.subtabs || []\r\n              };\r\n            });\r\n          }\r\n        }\r\n      )\r\n      .subscribe((status) => {\r\n        if (status === 'SUBSCRIBED') {\r\n                  } else if (status === 'CHANNEL_ERROR') {\r\n          console.error(' [MainApp] Real-time subscription error');\r\n        }\r\n      });\r\n    \r\n    // Cleanup subscription on unmount or when conversation changes\r\n    return () => {\r\n            subscription.unsubscribe();\r\n    };\r\n  }, [activeConversation?.id]);\r\n\r\n  // Function to refresh user data (for credit updates)\r\n  const refreshUserData = async () => {\r\n    try {\r\n      const currentUser = authService.getCurrentUser();\r\n      if (currentUser) {\r\n        setUser(currentUser);\r\n        UserService.setCurrentUser(currentUser);\r\n              }\r\n    } catch (error) {\r\n            toastService.warning('Failed to refresh user data. Please refresh the page if you experience issues.');\r\n    }\r\n  };\r\n\r\n  // WebSocket message handling and auto-reconnection\r\n  useEffect(() => {\r\n    const handleWebSocketError = (error: string) => {\r\n      console.error('WebSocket error:', error);\r\n    };\r\n\r\n    const handleWebSocketOpen = () => {\r\n            // Save connection time for status tracking\r\n      setLastSuccessfulConnection(new Date());\r\n      // Update connection status in parent\r\n      if (propOnConnect && connectionCode) {\r\n        propOnConnect(connectionCode);\r\n      }\r\n    };\r\n\r\n    const handleWebSocketClose = () => {\r\n          };\r\n\r\n    // Check if we have a stored connection code and try to reconnect\r\n    const storedCode = localStorage.getItem('otakon_connection_code');\r\n    if (storedCode) {\r\n            setConnectionCode(storedCode);\r\n      connect(storedCode, handleWebSocketOpen, handleWebSocketMessage, handleWebSocketError, handleWebSocketClose);\r\n    }\r\n\r\n    // Note: Removed automatic disconnect on unmount to maintain persistent connection\r\n    // WebSocket should only disconnect when user explicitly disconnects or logs out\r\n  }, [activeConversation, propOnConnect, handleWebSocketMessage, connectionCode]);\r\n\r\n  // Global keyboard shortcuts\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      // Ignore if user is typing in an input/textarea\r\n      const target = e.target as HTMLElement;\r\n      if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\r\n        return;\r\n      }\r\n\r\n      // Ctrl/Cmd + K: Focus search/input\r\n      if ((e.ctrlKey || e.metaKey) && e.key === 'k') {\r\n        e.preventDefault();\r\n        const chatInput = document.querySelector('textarea[placeholder*=\"message\"]') as HTMLTextAreaElement;\r\n        if (chatInput) {\r\n          chatInput.focus();\r\n          toastService.info('Chat input focused');\r\n        }\r\n      }\r\n\r\n      // Ctrl/Cmd + G: Switch to Game Hub (changed from Ctrl+N to avoid browser conflict)\r\n      if ((e.ctrlKey || e.metaKey) && e.key === 'g') {\r\n        e.preventDefault();\r\n        const gameHub = Object.values(conversations).find(c => c.isGameHub);\r\n        if (gameHub) {\r\n          handleConversationSelect(gameHub.id);\r\n          toastService.info('Switched to Game Hub');\r\n        }\r\n      }\r\n\r\n      // Escape: Stop generation\r\n      if (e.key === 'Escape' && isLoading) {\r\n        e.preventDefault();\r\n        if (abortController) {\r\n          abortController.abort();\r\n          toastService.info('Generation stopped');\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [conversations, isLoading, abortController]);\r\n\r\n  const handleConversationSelect = async (id: string) => {\r\n    console.error(' [MainApp] Switching to conversation:', id);\r\n    \r\n    //  CRITICAL FIX: ALWAYS use local state as source of truth\r\n    // Reloading from service can cause race conditions where newly created tabs disappear\r\n    // because background sync hasn't completed yet\r\n    const targetConversation = conversations[id];\r\n    if (!targetConversation) {\r\n      console.error(' [MainApp]  Conversation not found in local state:', id);\r\n      console.error(' [MainApp] Available conversations:', Object.keys(conversations));\r\n      console.error(' [MainApp] This should NOT happen - conversation should exist in state');\r\n      \r\n      // Last resort: reload from service, but this indicates a bug\r\n      const updatedConversations = await ConversationService.getConversations();\r\n      const mergedConversations = {\r\n        ...conversations, // Keep existing local state\r\n        ...updatedConversations // Add anything from DB\r\n      };\r\n      setConversations(mergedConversations);\r\n      setActiveConversation(mergedConversations[id]);\r\n    } else {\r\n      //  PERFORMANCE FIX: Update UI immediately without waiting for database sync\r\n      console.error(' [MainApp]  Instant UI update for conversation:', id);\r\n      \r\n      // Update local state first (instant UI feedback)\r\n      setActiveConversation(targetConversation);\r\n      setSidebarOpen(false);\r\n      \r\n      //  CRITICAL FIX: Save current conversations state to DB BEFORE switching\r\n      // This ensures the new tab is persisted even if user switches quickly\r\n      ConversationService.setConversations(conversations).catch(error => {\r\n        console.error(' [MainApp] Failed to persist conversations:', error);\r\n      });\r\n      \r\n      // Update active conversation in service in background (don't await)\r\n      // This prevents blocking the UI while syncing to Supabase\r\n      ConversationService.setActiveConversation(id).catch(error => {\r\n        console.error(' [MainApp] Failed to sync active conversation:', error);\r\n      });\r\n    }\r\n    \r\n    // Close sidebar immediately after selecting\r\n    if (!targetConversation) {\r\n      setSidebarOpen(false);\r\n    }\r\n\r\n    // Set initial suggested prompts for Game Hub tab\r\n    const conversation = conversations[id];\r\n    if (conversation?.isGameHub || id === GAME_HUB_ID) {\r\n      // If no messages yet, show news prompts (they will be displayed by SuggestedPrompts component)\r\n      if (!conversation || !conversation.messages || conversation.messages.length === 0) {\r\n        // SuggestedPrompts component will handle showing newsPrompts for Game Hub\r\n        // We just need to ensure prompts array is not empty\r\n        setSuggestedPrompts(newsPrompts);\r\n      } else {\r\n        // If there are messages, show contextual fallback prompts\r\n        const fallbackPrompts = suggestedPromptsService.getFallbackSuggestions(id, conversation.isGameHub);\r\n        setSuggestedPrompts(fallbackPrompts);\r\n      }\r\n    } else {\r\n      // For game tabs, set appropriate fallback prompts\r\n      const fallbackPrompts = suggestedPromptsService.getFallbackSuggestions(id, conversation?.isGameHub);\r\n      setSuggestedPrompts(fallbackPrompts);\r\n    }\r\n  };\r\n\r\n  const handleDeleteConversation = async (id: string) => {\r\n    const wasActive = activeConversation?.id === id;\r\n    const deletedConversation = conversations[id];\r\n    \r\n    //  OPTIMISTIC: Delete from local state immediately (instant UI)\r\n    setConversations(prev => {\r\n      const updated = { ...prev };\r\n      delete updated[id];\r\n      return updated;\r\n    });\r\n    \r\n    // Background delete with rollback on error\r\n    ConversationService.deleteConversation(id).catch(error => {\r\n      console.error('Failed to delete conversation:', error);\r\n      \r\n      // Rollback on error\r\n      setConversations(prev => ({\r\n        ...prev,\r\n        [id]: deletedConversation\r\n      }));\r\n      \r\n      toastService.error('Failed to delete conversation.');\r\n      return;\r\n    });\r\n    \r\n    if (wasActive) {\r\n      // If we're deleting the current active conversation, switch to \"Game Hub\" tab\r\n      const gameHubTab = conversations[GAME_HUB_ID] || conversations['game-hub'];\r\n      if (gameHubTab) {\r\n        // Persist the active conversation change (background, non-blocking)\r\n        ConversationService.setActiveConversation(gameHubTab.id).catch(console.error);\r\n        setActiveConversation(gameHubTab);\r\n        // Also clear any active session since we're switching away from a game tab\r\n        setActiveSession('', false);\r\n      } else {\r\n        // Fallback to first available conversation\r\n        const firstConversation = Object.values(conversations)[0] || null;\r\n        if (firstConversation) {\r\n          ConversationService.setActiveConversation(firstConversation.id).catch(console.error);\r\n          setActiveConversation(firstConversation);\r\n        } else {\r\n          setActiveConversation(null);\r\n        }\r\n      }\r\n      // Close sidebar on mobile after switching\r\n      setSidebarOpen(false);\r\n    }\r\n  };\r\n\r\n  const handlePinConversation = async (id: string) => {\r\n    // Check if we can pin (max 3 pinned conversations)\r\n    const pinnedCount = Object.values(conversations).filter((conv: Conversation) => conv.isPinned).length;\r\n    if (pinnedCount >= 3) {\r\n      toastService.warning('You can only pin up to 3 conversations.');\r\n      return;\r\n    }\r\n\r\n    const pinnedAt = Date.now();\r\n    \r\n    //  OPTIMISTIC: Update local state immediately (instant UI)\r\n    setConversations(prev => ({\r\n      ...prev,\r\n      [id]: { ...prev[id], isPinned: true, pinnedAt }\r\n    }));\r\n    \r\n    // Background sync with rollback on error\r\n    ConversationService.updateConversation(id, { \r\n      isPinned: true, \r\n      pinnedAt \r\n    }).catch(error => {\r\n      console.error('Failed to pin conversation:', error);\r\n      \r\n      // Rollback on error\r\n      setConversations(prev => ({\r\n        ...prev,\r\n        [id]: { ...prev[id], isPinned: false, pinnedAt: undefined }\r\n      }));\r\n      \r\n      toastService.error('Failed to pin conversation.');\r\n    });\r\n  };\r\n\r\n  const handleUnpinConversation = async (id: string) => {\r\n    //  OPTIMISTIC: Update local state immediately (instant UI)\r\n    setConversations(prev => ({\r\n      ...prev,\r\n      [id]: { ...prev[id], isPinned: false, pinnedAt: undefined }\r\n    }));\r\n    \r\n    // Background sync with rollback on error\r\n    ConversationService.updateConversation(id, { \r\n      isPinned: false, \r\n      pinnedAt: undefined \r\n    }).catch(error => {\r\n      console.error('Failed to unpin conversation:', error);\r\n      \r\n      // Rollback on error\r\n      setConversations(prev => ({\r\n        ...prev,\r\n        [id]: { ...prev[id], isPinned: true, pinnedAt: conversations[id].pinnedAt }\r\n      }));\r\n      \r\n      toastService.error('Failed to unpin conversation.');\r\n    });\r\n  };\r\n\r\n  const handleClearConversation = async (id: string) => {\r\n    try {\r\n            //  OPTIMISTIC: Clear messages locally immediately (instant UI)\r\n      setConversations(prev => ({\r\n        ...prev,\r\n        [id]: {\r\n          ...prev[id],\r\n          messages: [],\r\n          updatedAt: Date.now()\r\n        }\r\n      }));\r\n      \r\n      // Update active conversation if it's the one being cleared\r\n      if (activeConversation?.id === id) {\r\n        setActiveConversation(prev => prev ? ({\r\n          ...prev,\r\n          messages: [],\r\n          updatedAt: Date.now()\r\n        }) : null);\r\n      }\r\n      \r\n      // Background sync (non-blocking)\r\n      ConversationService.clearConversation(id).catch(error => {\r\n        console.error('Failed to clear conversation:', error);\r\n        toastService.error('Failed to clear conversation.');\r\n      });\r\n      \r\n      toastService.success('Conversation cleared');\r\n    } catch (error) {\r\n      console.error('Failed to clear conversation:', error);\r\n    }\r\n  };\r\n\r\n  const handleCreditModalOpen = () => {\r\n    setCreditModalOpen(true);\r\n  };\r\n\r\n  const handleCreditModalClose = () => {\r\n    setCreditModalOpen(false);\r\n  };\r\n\r\n  const handleUpgrade = () => {\r\n    // TODO: Implement upgrade functionality\r\n      };\r\n\r\n  const handleOpenGuide = () => {\r\n    // Open the welcome screen guide\r\n    setWelcomeScreenOpen(true);\r\n  };\r\n\r\n  const handleAddGame = () => {\r\n    setAddGameModalOpen(true);\r\n  };\r\n\r\n  const handleCreateGame = async (gameName: string, query: string) => {\r\n    // Switch to Game Hub\r\n    const gameHub = Object.values(conversations).find(\r\n      (conv) => conv.isGameHub || conv.id === 'game-hub' || conv.title === 'Game Hub'\r\n    );\r\n    \r\n    if (!gameHub) {\r\n      toastService.error('Game Hub not found. Please refresh the page.');\r\n      return;\r\n    }\r\n\r\n    // Switch to Game Hub and close modal\r\n    await ConversationService.setActiveConversation(gameHub.id);\r\n    setActiveConversation(gameHub);\r\n    setAddGameModalOpen(false);\r\n    \r\n    // Send formatted query to Game Hub\r\n    // Format: \"I'm playing [GAME]. [USER_QUERY]\"\r\n    const formattedMessage = `I'm playing ${gameName}. ${query}`;\r\n    \r\n    // Show processing message\r\n    toastService.info(`Checking ${gameName}...`);\r\n    \r\n    // Send message immediately - UI is already switched to Game Hub\r\n    // The AI will respond and determine if it's a valid/released/unreleased game\r\n    // The handleSendMessage flow will handle tab creation based on AI response\r\n    handleSendMessage(formattedMessage);\r\n  };\r\n\r\n  const handleConnectionModalOpen = () => {\r\n    setConnectionModalOpen(true);\r\n  };\r\n\r\n  const handleConnectionModalClose = () => {\r\n    setConnectionModalOpen(false);\r\n  };\r\n\r\n  const handleClearConnectionError = () => {\r\n    if (propOnClearConnectionError) {\r\n      propOnClearConnectionError();\r\n    }\r\n  };\r\n\r\n  const handleHandsFreeToggle = () => {\r\n    // Just open the modal - don't toggle the state\r\n    setHandsFreeModalOpen(true);\r\n  };\r\n\r\n  const handleHandsFreeModalClose = () => {\r\n    setHandsFreeModalOpen(false);\r\n  };\r\n\r\n  const handleToggleHandsFreeFromModal = () => {\r\n    // This is the actual toggle that enables/disables hands-free mode\r\n    const newMode = !isHandsFreeMode;\r\n    setIsHandsFreeMode(newMode);\r\n    localStorage.setItem('otakonHandsFreeMode', String(newMode));\r\n    \r\n    // If disabling hands-free mode, stop any ongoing speech\r\n    if (!newMode) {\r\n      ttsService.cancel();\r\n    }\r\n  };\r\n\r\n  // Settings context menu handlers\r\n  const handleSettingsContextMenu = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    // Toggle the menu if it's already open\r\n    if (settingsContextMenu.isOpen) {\r\n      closeSettingsContextMenu();\r\n    } else {\r\n      setSettingsContextMenu({\r\n        isOpen: true,\r\n        position: { x: e.clientX, y: e.clientY },\r\n      });\r\n    }\r\n  };\r\n\r\n  const closeSettingsContextMenu = () => {\r\n    setSettingsContextMenu({\r\n      isOpen: false,\r\n      position: { x: 0, y: 0 },\r\n    });\r\n  };\r\n\r\n  const handleOpenSettings = () => {\r\n    setSettingsOpen(true);\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    onLogout();\r\n  };\r\n\r\n  const handleConnect = (code: string) => {\r\n    setConnectionCode(code);\r\n    \r\n    // Store connection code for persistence\r\n    localStorage.setItem('otakon_connection_code', code);\r\n    localStorage.setItem('otakon_last_connection', new Date().toISOString());\r\n    \r\n    // Use prop handler if available, otherwise use local websocket\r\n    if (propOnConnect) {\r\n      propOnConnect(code);\r\n    } else {\r\n      // Fallback to local websocket connection\r\n      connect(\r\n        code,\r\n        () => {\r\n          setLastSuccessfulConnection(new Date());\r\n          localStorage.setItem('otakonHasConnectedBefore', 'true');\r\n        },\r\n        (data: Record<string, unknown>) => {\r\n                  },\r\n        (error: string) => {\r\n          console.error('Connection error:', error);\r\n        },\r\n        () => {\r\n                  }\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleDisconnect = () => {\r\n    if (propOnDisconnect) {\r\n      propOnDisconnect();\r\n    } else {\r\n      disconnect();\r\n    }\r\n    setConnectionCode(null);\r\n    setLastSuccessfulConnection(null);\r\n    localStorage.removeItem('otakon_connection_code');\r\n    localStorage.removeItem('otakon_last_connection');\r\n  };\r\n\r\n  // Handle suggested prompt clicks\r\n  const handleSuggestedPromptClick = async (prompt: string) => {\r\n        // Guard: Don't allow if already loading or no active conversation\r\n    if (isLoading || !activeConversation) {\r\n            return;\r\n    }\r\n    \r\n    try {\r\n      await handleSendMessage(prompt);\r\n    } catch (error) {\r\n      console.error(' [MainApp] Error in handleSuggestedPromptClick:', error);\r\n      // Ensure loading state is cleared on error\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Handle input message change\r\n  const handleInputMessageChange = (message: string) => {\r\n    setCurrentInputMessage(message);\r\n  };\r\n\r\n  // Handle active session toggle with session summaries\r\n  const handleToggleActiveSession = async () => {\r\n    if (!activeConversation) {\r\n      return;\r\n    }\r\n\r\n    const wasPlaying = session.isActive && session.currentGameId === activeConversation.id;\r\n    const willBePlaying = !wasPlaying;\r\n\r\n    // Create summary of current session before switching\r\n    if (wasPlaying) {\r\n      // Switching from Playing to Planning - create playing session summary\r\n            try {\r\n        const playingSummary = await sessionSummaryService.generatePlayingSessionSummary(activeConversation);\r\n        await sessionSummaryService.storeSessionSummary(activeConversation.id, playingSummary);\r\n        \r\n        // Add summary message to conversation\r\n        const summaryMessage = {\r\n          id: `msg_${Date.now()}`,\r\n          content: `**Session Summary - Switching to Planning Mode**\\n\\n${playingSummary.summary}`,\r\n          role: 'assistant' as const,\r\n          timestamp: Date.now(),\r\n        };\r\n        \r\n        setConversations(prev => {\r\n          const updated = { ...prev };\r\n          if (updated[activeConversation.id]) {\r\n            updated[activeConversation.id] = {\r\n              ...updated[activeConversation.id],\r\n              messages: [...updated[activeConversation.id].messages, summaryMessage],\r\n              updatedAt: Date.now()\r\n            };\r\n          }\r\n          return updated;\r\n        });\r\n        \r\n        await ConversationService.addMessage(activeConversation.id, summaryMessage);\r\n      } catch (error) {\r\n        console.error('Failed to create playing session summary:', error);\r\n        toastService.error('Failed to create session summary.');\r\n      }\r\n    } else if (willBePlaying) {\r\n      // Switching from Planning to Playing - create planning session summary\r\n            try {\r\n        const planningSummary = await sessionSummaryService.generatePlanningSessionSummary(activeConversation);\r\n        await sessionSummaryService.storeSessionSummary(activeConversation.id, planningSummary);\r\n        \r\n        // Add summary message to conversation\r\n        const summaryMessage = {\r\n          id: `msg_${Date.now()}`,\r\n          content: `**Session Summary - Switching to Playing Mode**\\n\\n${planningSummary.summary}`,\r\n          role: 'assistant' as const,\r\n          timestamp: Date.now(),\r\n        };\r\n        \r\n        setConversations(prev => {\r\n          const updated = { ...prev };\r\n          if (updated[activeConversation.id]) {\r\n            updated[activeConversation.id] = {\r\n              ...updated[activeConversation.id],\r\n              messages: [...updated[activeConversation.id].messages, summaryMessage],\r\n              updatedAt: Date.now()\r\n            };\r\n          }\r\n          return updated;\r\n        });\r\n        \r\n        await ConversationService.addMessage(activeConversation.id, summaryMessage);\r\n      } catch (error) {\r\n        console.error('Failed to create planning session summary:', error);\r\n        toastService.error('Failed to create session summary.');\r\n      }\r\n    }\r\n\r\n    // Toggle the session\r\n    toggleSession(activeConversation.id);\r\n  };\r\n\r\n  // Handle stop AI request\r\n  const handleStopAI = () => {\r\n    if (abortController) {\r\n      abortController.abort();\r\n      setAbortController(null);\r\n      setIsLoading(false);\r\n      setSuggestedPrompts([]);\r\n    }\r\n  };\r\n\r\n  // Poll for subtab updates when background insights are being generated\r\n  const pollForSubtabUpdates = async (conversationId: string, attempts = 0, maxAttempts = 30) => {\r\n    // Stop after 30 attempts (30 seconds)\r\n    if (attempts >= maxAttempts) {\r\n      console.error(' [MainApp]  Stopped polling for subtab updates after', attempts, 'attempts');\r\n      return;\r\n    }\r\n\r\n    // Wait 1 second before checking\r\n    await new Promise(resolve => setTimeout(resolve, 1000));\r\n\r\n    try {\r\n      //  FIX: Aggressively clear cache before every poll to prevent stale reads\r\n      ConversationService.clearCache();\r\n      \r\n      //  CRITICAL FIX: Skip cache to ensure we get fresh data after Supabase sync\r\n      const updatedConversations = await ConversationService.getConversations(true); // skipCache = true\r\n      const targetConv = updatedConversations[conversationId];\r\n\r\n      if (!targetConv) {\r\n        console.error(' [MainApp]  Conversation not found:', conversationId);\r\n        return;\r\n      }\r\n\r\n      //  CRITICAL FIX: Check if conversation even HAS subtabs\r\n      if (!targetConv.subtabs || targetConv.subtabs.length === 0) {\r\n        console.error(` [MainApp]  Conversation \"${targetConv.title}\" has no subtabs, stopping poll`);\r\n        return;\r\n      }\r\n\r\n      const loadingSubtabs = targetConv.subtabs.filter(tab => tab.status === 'loading');\r\n      const loadedSubtabs = targetConv.subtabs.filter(tab => tab.status === 'loaded');\r\n      const stillLoading = loadingSubtabs.length > 0;\r\n      \r\n      if (attempts === 0) {\r\n        console.error(` [MainApp]  Starting poll for \"${targetConv.title}\" (${targetConv.subtabs.length} subtabs, ${loadingSubtabs.length} loading)`);\r\n      }\r\n      \r\n      if (!stillLoading) {\r\n        // Subtabs have finished loading!\r\n        console.error(` [MainApp]  All subtabs loaded for \"${targetConv.title}\" after ${attempts} attempts`);\r\n        console.error(` [MainApp]  Final status: ${loadedSubtabs.length} loaded, ${loadingSubtabs.length} loading`);\r\n        \r\n        //  FIX: Deep clone to ensure React detects changes\r\n        const freshConversations = deepCloneConversations(updatedConversations);\r\n        \r\n        //  FIX: Force update conversations state with new reference\r\n        setConversations(freshConversations);\r\n        \r\n        //  FIX: CRITICAL - ALWAYS update active conversation if this is the active tab\r\n        console.error(' [MainApp]  Active conversation check:', {\r\n          activeConvId: activeConversation?.id,\r\n          targetConvId: conversationId,\r\n          matches: activeConversation?.id === conversationId\r\n        });\r\n        \r\n        //  CRITICAL FIX: Update active conversation to force React re-render\r\n        // Add timestamp to guarantee object reference change\r\n        const updatedActiveConv = {\r\n          ...freshConversations[conversationId],\r\n          subtabs: freshConversations[conversationId].subtabs?.map(st => ({ ...st })) || [],\r\n          _updateTimestamp: Date.now() // Force new object reference\r\n        };\r\n        \r\n        console.error(' [MainApp]  FORCE-UPDATING active conversation with loaded subtabs');\r\n        console.error(' [MainApp]  Subtab statuses:', updatedActiveConv.subtabs.map(s => ({ title: s.title, status: s.status })));\r\n        console.error(' [MainApp]  Setting active conversation to trigger re-render...');\r\n        console.error(' [MainApp]  Old active conv ID:', activeConversation?.id);\r\n        console.error(' [MainApp]  New active conv ID:', updatedActiveConv.id);\r\n        \r\n        //  First update conversations dict\r\n        setConversations({\r\n          ...freshConversations\r\n        });\r\n        \r\n        //  Then update active conversation (this should trigger ChatInterface re-render)\r\n        setActiveConversation(updatedActiveConv);\r\n        return;\r\n      }\r\n\r\n      // Still loading, continue polling\r\n      if (attempts % 5 === 0 || attempts === 1) {\r\n        console.error(` [MainApp]  \"${targetConv.title}\": ${loadingSubtabs.length} subtabs still loading... (attempt ${attempts + 1})`);\r\n      }\r\n      pollForSubtabUpdates(conversationId, attempts + 1, maxAttempts);\r\n    } catch (error) {\r\n      console.error(' [MainApp]  Error polling for subtab updates:', error);\r\n    }\r\n  };\r\n\r\n  // Placeholder for game tab creation - will be implemented in Week 3\r\n  const handleCreateGameTab = async (gameInfo: { gameTitle: string; genre?: string; aiResponse?: Record<string, unknown>; isUnreleased?: boolean }): Promise<Conversation | null> => {\r\n        try {\r\n      const user = authService.getCurrentUser();\r\n      if (!user) {\r\n        console.error('User not authenticated for game tab creation');\r\n        toastService.error('Please sign in to create game tabs.');\r\n        return null;\r\n      }\r\n\r\n      // Generate unique conversation ID based on game title (without timestamp for consistency)\r\n      const sanitizedTitle = gameInfo.gameTitle.toLowerCase().replace(/[^a-z0-9\\s-]/g, '').replace(/\\s+/g, '-');\r\n      const conversationId = `game-${sanitizedTitle}`;\r\n      \r\n      // Check if game tab already exists\r\n      const existingConversation = conversations[conversationId];\r\n      if (existingConversation) {\r\n                return existingConversation;\r\n      }\r\n\r\n      // Create new game tab with AI response data\r\n      const newGameTab = await gameTabService.createGameTab({\r\n        gameTitle: gameInfo.gameTitle,\r\n        genre: gameInfo.genre || 'Action RPG',\r\n        conversationId,\r\n        userId: user.id,\r\n        aiResponse: gameInfo.aiResponse, // Pass AI response for subtab population\r\n        isUnreleased: gameInfo.isUnreleased || false // Pass unreleased status\r\n      });\r\n\r\n      // Add to conversations state\r\n      setConversations(prev => ({\r\n        ...prev,\r\n        [conversationId]: newGameTab\r\n      }));\r\n\r\n      //  GAME HUB TRACKING: Mark tab as created in game_hub_interactions table\r\n      if (user.authUserId) {\r\n        aiService.markGameHubTabCreated(user.authUserId, gameInfo.gameTitle, conversationId)\r\n          .catch(error => console.warn('Failed to track Game Hub tab creation:', error));\r\n      }\r\n\r\n            toastService.success(`Game tab \"${gameInfo.gameTitle}\" created!`);\r\n      return newGameTab;\r\n    } catch (error) {\r\n      console.error('Failed to create game tab:', error);\r\n      toastService.error('Failed to create game tab. Please try again.');\r\n      return null;\r\n    }\r\n  };\r\n\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  const handleSendMessage = async (message: string, imageUrl?: string) => {\r\n    //  RATE LIMITING: Prevent rapid-fire duplicate requests\r\n    const now = Date.now();\r\n    const timeSinceLastRequest = now - lastRequestTimeRef.current;\r\n    \r\n    if (timeSinceLastRequest < RATE_LIMIT_DELAY_MS) {\r\n      console.warn(` [MainApp] Rate limit: ${timeSinceLastRequest}ms since last request (min ${RATE_LIMIT_DELAY_MS}ms)`);\r\n      return; // Silently ignore - no user-visible delay\r\n    }\r\n    \r\n    lastRequestTimeRef.current = now;\r\n    \r\n    // Track user activity\r\n    sessionService.trackActivity('send_message');\r\n    \r\n    // Prevent duplicate/concurrent sends\r\n    if (!activeConversation || isLoading) {\r\n      if (isLoading) {\r\n              }\r\n      console.warn(' [MainApp] handleSendMessage blocked:', { \r\n        hasActiveConversation: !!activeConversation, \r\n        isLoading,\r\n        message: message?.substring(0, 50)\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Validate message content\r\n    if (!imageUrl && !message?.trim()) {\r\n      toastService.error('Please enter a message');\r\n      return;\r\n    }\r\n\r\n    if (message && message.length > 10000) {\r\n      toastService.error('Message is too long (max 10,000 characters)');\r\n      return;\r\n    }\r\n\r\n    console.log(' [MainApp] Sending message with image:', { message, hasImage: !!imageUrl, imageUrl: imageUrl?.substring(0, 50) + '...' });\r\n\r\n    // Auto-switch to Playing mode for game help requests (not in Game Hub)\r\n    const isGameHelpRequest = imageUrl || \r\n      (message && (\r\n        message.toLowerCase().includes('help') ||\r\n        message.toLowerCase().includes('how to') ||\r\n        message.toLowerCase().includes('what should') ||\r\n        message.toLowerCase().includes('stuck') ||\r\n        message.toLowerCase().includes('tutorial') ||\r\n        message.toLowerCase().includes('guide')\r\n      ));\r\n\r\n    if (isGameHelpRequest && !activeConversation.isGameHub) {\r\n      // Switch to Playing mode if not already active\r\n      if (!session.isActive || session.currentGameId !== activeConversation.id) {\r\n                setActiveSession(activeConversation.id, true);\r\n      }\r\n    }\r\n\r\n    const newMessage = {\r\n      id: `msg_${Date.now()}`,\r\n      content: message,\r\n      role: 'user' as const,\r\n      timestamp: Date.now(),\r\n      imageUrl,\r\n    };\r\n\r\n    // Optimized: Update state immediately without re-fetching\r\n    setConversations(prev => {\r\n      const updated = { ...prev };\r\n      if (updated[activeConversation.id]) {\r\n        updated[activeConversation.id] = {\r\n          ...updated[activeConversation.id],\r\n          messages: [...updated[activeConversation.id].messages, newMessage],\r\n          updatedAt: Date.now()\r\n        };\r\n        // Update activeConversation immediately so UI reflects the new message\r\n        setActiveConversation(updated[activeConversation.id]);\r\n      }\r\n      return updated;\r\n    });\r\n\r\n    // Add message to service - MUST await to ensure it's saved before potential migration\r\n    await ConversationService.addMessage(activeConversation.id, newMessage);\r\n\r\n    // Clear the input message after sending\r\n    setCurrentInputMessage('');\r\n\r\n    // Check if message contains a tab command (for Command Centre)\r\n    if (tabManagementService.hasTabCommand(message)) {\r\n      const command = tabManagementService.parseTabCommand(message, activeConversation);\r\n      if (command) {\r\n                console.log(' [MainApp] Command description:', tabManagementService.describeCommand(command));\r\n      }\r\n    }\r\n\r\n    // Track credit usage based on query type\r\n    const hasImage = !!imageUrl;\r\n    \r\n    // Determine query type: image+text or image-only = image query, text-only = text query\r\n    const queryType = hasImage ? 'image' : 'text';\r\n    \r\n    //  SOFT WARNING: Show warning at 90% usage\r\n    if (user) {\r\n      const currentCount = queryType === 'text' ? user.textCount : user.imageCount;\r\n      const limit = queryType === 'text' ? user.textLimit : user.imageLimit;\r\n      const usagePercent = (currentCount / limit) * 100;\r\n      \r\n      if (usagePercent >= 90 && usagePercent < 100) {\r\n        const remaining = limit - currentCount;\r\n        toastService.warning(\r\n          `${remaining} ${queryType} ${remaining === 1 ? 'query' : 'queries'} remaining this month (${Math.floor(usagePercent)}% used)`\r\n        );\r\n      }\r\n    }\r\n    \r\n    // Check if user can make the request\r\n    if (!UserService.canMakeRequest(queryType)) {\r\n      const errorMessage = {\r\n        id: `msg_${Date.now() + 1}`,\r\n        content: `You've reached your ${queryType} query limit for this month. Upgrade to Pro for more queries.`,\r\n        role: 'assistant' as const,\r\n        timestamp: Date.now(),\r\n      };\r\n      \r\n      // Add error message to conversation\r\n      setConversations(prev => {\r\n        const updated = { ...prev };\r\n        if (updated[activeConversation.id]) {\r\n          updated[activeConversation.id] = {\r\n            ...updated[activeConversation.id],\r\n            messages: [...updated[activeConversation.id].messages, errorMessage],\r\n            updatedAt: Date.now()\r\n          };\r\n          // Update activeConversation immediately so UI reflects the error message\r\n          setActiveConversation(updated[activeConversation.id]);\r\n        }\r\n        return updated;\r\n      });\r\n      \r\n      // Save error message (non-blocking)\r\n      ConversationService.addMessage(activeConversation.id, errorMessage)\r\n        .catch(error => console.error('Failed to save error message:', error));\r\n      \r\n      //  HARD BLOCK: Show upgrade prompt\r\n      toastService.error('Monthly limit reached! Upgrade to Pro for unlimited queries.');\r\n      return;\r\n    }\r\n\r\n    // Increment usage count\r\n    UserService.incrementUsage(queryType);\r\n    \r\n    // Update in Supabase (non-blocking - fire and forget)\r\n    if (user?.authUserId) {\r\n      const supabaseService = new SupabaseService();\r\n      supabaseService.incrementUsage(user.authUserId, queryType)\r\n        .then(() => {\r\n                    // Refresh user data in background to update credit indicator\r\n          return refreshUserData();\r\n        })\r\n        .catch(error => console.warn('Failed to update usage in Supabase:', error));\r\n    }\r\n\r\n    // Clear previous suggestions and start loading\r\n    setSuggestedPrompts([]);\r\n    setIsLoading(true);\r\n    \r\n    // Create abort controller for stop functionality\r\n    const controller = new AbortController();\r\n    setAbortController(controller);\r\n    \r\n    try {\r\n      const user = authService.getCurrentUser();\r\n      if (!user) {\r\n        throw new Error('User not authenticated');\r\n      }\r\n\r\n      // Apply context summarization before sending to AI (keeps context manageable)\r\n      let conversationWithOptimizedContext = activeConversation;\r\n      if (activeConversation.messages.length > 10) {\r\n        const { contextSummarizationService } = await import('../services/contextSummarizationService');\r\n        \r\n        if (contextSummarizationService.shouldSummarize(activeConversation)) {\r\n                    const summarizedConversation = await contextSummarizationService.applyContextSummarization(activeConversation);\r\n          \r\n          // Update conversation with summarized context\r\n          await ConversationService.updateConversation(activeConversation.id, summarizedConversation);\r\n          conversationWithOptimizedContext = summarizedConversation;\r\n          \r\n          // Update local state\r\n          setConversations(prev => ({\r\n            ...prev,\r\n            [activeConversation.id]: summarizedConversation\r\n          }));\r\n          setActiveConversation(summarizedConversation);\r\n          \r\n                  }\r\n      }\r\n\r\n      const response = await aiService.getChatResponseWithStructure(\r\n        conversationWithOptimizedContext,\r\n        user,\r\n        message,\r\n        session.isActive && session.currentGameId === activeConversation.id,\r\n        !!imageUrl,\r\n        imageUrl,\r\n        controller.signal\r\n      );\r\n\r\n      // Check if request was aborted before adding response to conversation\r\n      if (controller.signal.aborted) {\r\n                return;\r\n      }\r\n\r\n      const aiMessage = {\r\n        id: `msg_${Date.now() + 1}`,\r\n        content: response.content,\r\n        role: 'assistant' as const,\r\n        timestamp: Date.now(),\r\n      };\r\n\r\n      // Optimized: Update state immediately\r\n      setConversations(prev => {\r\n        const updated = { ...prev };\r\n        if (updated[activeConversation.id]) {\r\n          updated[activeConversation.id] = {\r\n            ...updated[activeConversation.id],\r\n            messages: [...updated[activeConversation.id].messages, aiMessage],\r\n            updatedAt: Date.now()\r\n          };\r\n          // Update activeConversation immediately so UI reflects the new message\r\n          setActiveConversation(updated[activeConversation.id]);\r\n        }\r\n        return updated;\r\n      });\r\n\r\n      // Add message to service - MUST await to ensure it's saved before potential migration\r\n      await ConversationService.addMessage(activeConversation.id, aiMessage);\r\n\r\n      //  Hands-Free Mode: Read AI response aloud if enabled\r\n      if (isHandsFreeMode && response.content) {\r\n        try {\r\n          // Extract only the Hint section for TTS - more precise matching\r\n          const hintMatch = response.content.match(/Hint:\\s*\\n*\\s*([\\s\\S]*?)(?=\\n\\s*(?:Lore:|Places of Interest:|Strategy:)|$)/i);\r\n          let textToSpeak = '';\r\n          \r\n          if (hintMatch && hintMatch[1]) {\r\n            // Found a hint section, extract only that part\r\n            textToSpeak = hintMatch[1]\r\n              .trim()\r\n              // Stop at first occurrence of section headers (case insensitive)\r\n              .split(/\\n\\s*(?:Lore:|Places of Interest:|Strategy:)/i)[0]\r\n              .trim();\r\n          } else if (!response.content.includes('Lore:') && !response.content.includes('Places of Interest:')) {\r\n            // No structured sections detected, read the entire content\r\n            textToSpeak = response.content;\r\n          }\r\n          \r\n          if (textToSpeak) {\r\n            // Strip markdown and special formatting for better TTS\r\n            const cleanText = textToSpeak\r\n              .replace(/[*_~`]/g, '') // Remove markdown formatting\r\n              .replace(/\\[([^\\]]+)\\]\\([^)]+\\)/g, '$1') // Convert [text](url) to text\r\n              .replace(/#{1,6}\\s/g, '') // Remove heading markers\r\n              .replace(/```[\\s\\S]*?```/g, '') // Remove code blocks\r\n              .replace(/`([^`]+)`/g, '$1') // Remove inline code markers\r\n              .trim();\r\n            \r\n            if (cleanText) {\r\n              // Don't await - let TTS run in background without blocking chat flow\r\n              ttsService.speak(cleanText).catch(err => console.error('TTS Error:', err));\r\n            }\r\n          }\r\n        } catch (ttsError) {\r\n          console.error('TTS Error:', ttsError);\r\n          // Don't block the flow if TTS fails\r\n        }\r\n      } else if (!isHandsFreeMode && response.content) {\r\n        //  Show notification if TTS is OFF and screen is locked\r\n        try {\r\n          const { showAINotification, isScreenLockedOrHidden } = await import('../services/toastService');\r\n          \r\n          if (isScreenLockedOrHidden()) {\r\n            // Extract hint for notification\r\n            const hintMatch = response.content.match(/Hint:\\s*\\n*\\s*([\\s\\S]*?)(?=\\n\\s*(?:Lore:|Places of Interest:|Strategy:)|$)/i);\r\n            let notificationText = '';\r\n            \r\n            if (hintMatch && hintMatch[1]) {\r\n              notificationText = hintMatch[1].trim().split(/\\n\\s*(?:Lore:|Places of Interest:|Strategy:)/i)[0].trim();\r\n            } else if (!response.content.includes('Lore:') && !response.content.includes('Places of Interest:')) {\r\n              notificationText = response.content;\r\n            }\r\n            \r\n            if (notificationText) {\r\n              // Clean markdown for notification\r\n              const cleanText = notificationText\r\n                .replace(/[*_~`]/g, '')\r\n                .replace(/\\[([^\\]]+)\\]\\([^)]+\\)/g, '$1')\r\n                .replace(/#{1,6}\\s/g, '')\r\n                .replace(/```[\\s\\S]*?```/g, '')\r\n                .replace(/`([^`]+)`/g, '$1')\r\n                .trim();\r\n              \r\n              if (cleanText) {\r\n                showAINotification(\r\n                  cleanText,\r\n                  activeConversation.title || 'Otagon AI'\r\n                );\r\n              }\r\n            }\r\n          }\r\n        } catch (notificationError) {\r\n          console.error('Notification Error:', notificationError);\r\n        }\r\n      }\r\n\r\n      //  DEFERRED: Process suggested prompts AFTER tab migration (moved to after tab switch)\r\n      // This ensures prompts are based on the FINAL active tab, not the intermediate Game Hub state\r\n                        const suggestionsToUse = response.followUpPrompts || response.suggestions;\r\n      console.log(' [MainApp] suggestionsToUse (before processing):', suggestionsToUse);\r\n      \r\n      const processedSuggestions = suggestedPromptsService.processAISuggestions(suggestionsToUse);\r\n      console.log(' [MainApp] processedSuggestions (after processing):', processedSuggestions);\r\n            // Handle state update tags (game progress, objectives, etc.)\r\n      if (response.stateUpdateTags && response.stateUpdateTags.length > 0) {\r\n        console.error(' [MainApp] Processing state update tags:', response.stateUpdateTags);\r\n        \r\n        for (const tag of response.stateUpdateTags) {\r\n          // Extract progress updates (e.g., \"PROGRESS: 45\")\r\n          if (tag.startsWith('PROGRESS:')) {\r\n            const progress = parseInt(tag.split(':')[1]?.trim() || '0', 10);\r\n            if (!isNaN(progress) && progress >= 0 && progress <= 100) {\r\n              console.error(` [MainApp] Updating game progress to ${progress}%`);\r\n              \r\n              // Update conversation with new progress\r\n              const updatedConv = {\r\n                ...activeConversation,\r\n                gameProgress: progress,\r\n                updatedAt: Date.now()\r\n              };\r\n              \r\n              // Update local state immediately\r\n              setConversations(prev => ({\r\n                ...prev,\r\n                [activeConversation.id]: updatedConv\r\n              }));\r\n              setActiveConversation(updatedConv);\r\n              \r\n              // Persist to storage (non-blocking)\r\n              ConversationService.updateConversation(activeConversation.id, {\r\n                gameProgress: progress,\r\n                updatedAt: Date.now()\r\n              }).catch(error => console.error('Failed to update game progress:', error));\r\n            }\r\n          }\r\n          \r\n          // Extract objective updates (e.g., \"OBJECTIVE: Defeat the boss\")\r\n          if (tag.startsWith('OBJECTIVE:')) {\r\n            const objective = tag.split(':')[1]?.trim();\r\n            if (objective) {\r\n              console.error(` [MainApp] Updating active objective: ${objective}`);\r\n              \r\n              // Update conversation with new objective\r\n              const updatedConv = {\r\n                ...activeConversation,\r\n                activeObjective: objective,\r\n                updatedAt: Date.now()\r\n              };\r\n              \r\n              // Update local state immediately\r\n              setConversations(prev => ({\r\n                ...prev,\r\n                [activeConversation.id]: updatedConv\r\n              }));\r\n              setActiveConversation(updatedConv);\r\n              \r\n              // Persist to storage (non-blocking)\r\n              ConversationService.updateConversation(activeConversation.id, {\r\n                activeObjective: objective,\r\n                updatedAt: Date.now()\r\n              }).catch(error => console.error('Failed to update objective:', error));\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      // Handle progressive insight updates (if AI provided updates to existing subtabs)\r\n      if (response.progressiveInsightUpdates && response.progressiveInsightUpdates.length > 0) {\r\n                // Update subtabs in background (non-blocking)\r\n        gameTabService.updateSubTabsFromAIResponse(\r\n          activeConversation.id,\r\n          response.progressiveInsightUpdates\r\n        ).then(() => {\r\n                    // Refresh conversations to show updated subtabs\r\n          ConversationService.getConversations().then(updatedConversations => {\r\n            const freshConversations = deepCloneConversations(updatedConversations);\r\n            setConversations(freshConversations);\r\n            \r\n            // Update active conversation to reflect changes\r\n            const refreshedConversation = freshConversations[activeConversation.id];\r\n            if (refreshedConversation) {\r\n              setActiveConversation(refreshedConversation);\r\n            }\r\n          });\r\n        }).catch(error => {\r\n          console.error(' [MainApp] Failed to update subtabs:', error);\r\n        });\r\n      }\r\n\r\n      // Handle tab management commands (Command Centre)\r\n      if (response.otakonTags.has('OTAKON_INSIGHT_UPDATE') || \r\n          response.otakonTags.has('OTAKON_INSIGHT_MODIFY_PENDING') || \r\n          response.otakonTags.has('OTAKON_INSIGHT_DELETE_REQUEST')) {\r\n        \r\n                // Handle INSIGHT_UPDATE (update content of existing tab)\r\n        if (response.otakonTags.has('OTAKON_INSIGHT_UPDATE')) {\r\n          const updateData = response.otakonTags.get('OTAKON_INSIGHT_UPDATE');\r\n                    if (typeof updateData === 'string') {\r\n            try {\r\n              const parsed = JSON.parse(updateData);\r\n              if (parsed.id && parsed.content) {\r\n                gameTabService.updateSubTabsFromAIResponse(\r\n                  activeConversation.id,\r\n                  [{ tabId: parsed.id, title: '', content: parsed.content }]\r\n                ).then(() => {\r\n                                    // Refresh UI\r\n                  ConversationService.getConversations().then(updatedConversations => {\r\n                    const freshConversations = deepCloneConversations(updatedConversations);\r\n                    setConversations(freshConversations);\r\n                    const refreshedConversation = freshConversations[activeConversation.id];\r\n                    if (refreshedConversation) {\r\n                      setActiveConversation(refreshedConversation);\r\n                    }\r\n                  });\r\n                }).catch(error => console.error('Failed to update tab:', error));\r\n              }\r\n            } catch (error) {\r\n              console.error('Failed to parse INSIGHT_UPDATE:', error);\r\n            }\r\n          }\r\n        }\r\n\r\n        // Handle INSIGHT_MODIFY_PENDING (modify/rename tab)\r\n        if (response.otakonTags.has('OTAKON_INSIGHT_MODIFY_PENDING')) {\r\n          const modifyData = response.otakonTags.get('OTAKON_INSIGHT_MODIFY_PENDING');\r\n                    if (typeof modifyData === 'string') {\r\n            try {\r\n              const parsed = JSON.parse(modifyData);\r\n              if (parsed.id && (parsed.title || parsed.content)) {\r\n                gameTabService.updateSubTabsFromAIResponse(\r\n                  activeConversation.id,\r\n                  [{ tabId: parsed.id, title: parsed.title || '', content: parsed.content || '' }]\r\n                ).then(() => {\r\n                                    // Refresh UI\r\n                  ConversationService.getConversations().then(updatedConversations => {\r\n                    const freshConversations = deepCloneConversations(updatedConversations);\r\n                    setConversations(freshConversations);\r\n                    const refreshedConversation = freshConversations[activeConversation.id];\r\n                    if (refreshedConversation) {\r\n                      setActiveConversation(refreshedConversation);\r\n                    }\r\n                  });\r\n                }).catch(error => console.error('Failed to modify tab:', error));\r\n              }\r\n            } catch (error) {\r\n              console.error('Failed to parse INSIGHT_MODIFY_PENDING:', error);\r\n            }\r\n          }\r\n        }\r\n\r\n        // Handle INSIGHT_DELETE_REQUEST (delete tab)\r\n        if (response.otakonTags.has('OTAKON_INSIGHT_DELETE_REQUEST')) {\r\n          const deleteData = response.otakonTags.get('OTAKON_INSIGHT_DELETE_REQUEST');\r\n                    if (typeof deleteData === 'string') {\r\n            try {\r\n              const parsed = JSON.parse(deleteData);\r\n              if (parsed.id) {\r\n                // Remove the subtab from conversation\r\n                const updatedSubtabs = activeConversation.subtabs?.filter(tab => tab.id !== parsed.id) || [];\r\n                ConversationService.updateConversation(activeConversation.id, {\r\n                  subtabs: updatedSubtabs\r\n                }).then(() => {\r\n                                    // Refresh UI\r\n                  ConversationService.getConversations().then(updatedConversations => {\r\n                    setConversations(updatedConversations);\r\n                    const refreshedConversation = updatedConversations[activeConversation.id];\r\n                    if (refreshedConversation) {\r\n                      setActiveConversation(refreshedConversation);\r\n                    }\r\n                  });\r\n                }).catch(error => console.error('Failed to delete tab:', error));\r\n              }\r\n            } catch (error) {\r\n              console.error('Failed to parse INSIGHT_DELETE_REQUEST:', error);\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      // Handle game tab creation if game is identified\r\n      if (response.otakonTags.has('GAME_ID')) {\r\n        const gameTitle = response.otakonTags.get('GAME_ID');\r\n        const confidence = response.otakonTags.get('CONFIDENCE');\r\n        const isUnreleased = response.otakonTags.get('GAME_STATUS') === 'unreleased';\r\n        const genre = response.otakonTags.get('GENRE') || 'Default';\r\n\r\n                // Create game tab if:\r\n        // 1. Confidence is high (game is valid)\r\n        // 2. IS_FULLSCREEN is true (actual gameplay, not launcher/menu)\r\n        // 3. Game can be unreleased OR released - both get tabs\r\n        // Invalid games (low confidence, no GAME_ID, menus/launchers) stay in Game Hub\r\n        const isFullscreen = response.otakonTags.get('IS_FULLSCREEN') === 'true';\r\n        const shouldCreateTab = confidence === 'high' && isFullscreen;\r\n\r\n        if (!shouldCreateTab) {\r\n          console.log(' [MainApp] Tab creation blocked:', {\r\n            gameTitle,\r\n            confidence,\r\n            isFullscreen,\r\n            reason: !isFullscreen ? ' Pre-game screen detected (main menu/launcher) - staying in Game Hub' : \r\n                    confidence !== 'high' ? ' Low confidence detection' : \r\n                    ' Generic detection',\r\n            hint: 'Take a gameplay or in-game menu screenshot (inventory, map, skills) to create a dedicated game tab'\r\n          });\r\n        }\r\n\r\n        if (shouldCreateTab) {\r\n          //  Check if game tab already exists using service (not stale state)\r\n          const targetConvId = gameTabService.generateGameConversationId(gameTitle);\r\n          const existingGameTab = await ConversationService.getConversation(targetConvId);\r\n\r\n          let targetConversationId: string;\r\n          \r\n          if (existingGameTab) {\r\n                        targetConversationId = existingGameTab.id;\r\n          } else {\r\n            console.log(' [MainApp] Creating new game tab for:', gameTitle, isUnreleased ? '(unreleased)' : '(released)');\r\n            const gameInfo = { gameTitle, genre, aiResponse: response, isUnreleased };\r\n            const newGameTab = await handleCreateGameTab(gameInfo);\r\n            targetConversationId = newGameTab?.id || '';\r\n            \r\n            //  CRITICAL: Refresh conversations immediately after creating new tab\r\n            // This ensures the new tab is available for message migration\r\n            const refreshedConversations = await ConversationService.getConversations();\r\n            setConversations(refreshedConversations);\r\n                      }\r\n\r\n          // Move the user message and AI response to the game tab if we detected a DIFFERENT game\r\n          // Allow migration from Game Hub OR from a different game tab\r\n          const shouldMigrateMessages = targetConversationId && targetConversationId !== activeConversation.id;\r\n                              if (shouldMigrateMessages) {\r\n                                                //  Use atomic migration service to prevent race conditions\r\n            await MessageRoutingService.migrateMessagesAtomic(\r\n              [newMessage.id, aiMessage.id],\r\n              activeConversation.id,\r\n              targetConversationId\r\n            );\r\n                        // Update state to reflect the changes\r\n            const updatedConversations = await ConversationService.getConversations();\r\n            setConversations(updatedConversations);\r\n            \r\n            // Switch to the game tab\r\n            const gameTab = updatedConversations[targetConversationId];\r\n            if (gameTab) {\r\n                            await ConversationService.setActiveConversation(targetConversationId);\r\n              setActiveConversation(gameTab);\r\n              // Auto-switch to Playing mode for new/existing game tabs\r\n              setActiveSession(targetConversationId, true);\r\n              // Close sidebar on mobile\r\n              setSidebarOpen(false);\r\n              \r\n              //  Set suggested prompts AFTER tab switch (based on FINAL active tab)\r\n              if (processedSuggestions.length > 0) {\r\n                                setSuggestedPrompts(processedSuggestions);\r\n              } else {\r\n                // Use fallback suggestions based on the GAME TAB, not Game Hub\r\n                const fallbackSuggestions = suggestedPromptsService.getFallbackSuggestions(gameTab.id, false);\r\n                                setSuggestedPrompts(fallbackSuggestions);\r\n              }\r\n              \r\n              // Poll for subtab updates if they're still loading\r\n              const hasLoadingSubtabs = gameTab.subtabs?.some(tab => tab.status === 'loading');\r\n              console.error(` [MainApp]  Checking if polling needed for \"${gameTab.title}\" (ID: ${targetConversationId})`);\r\n              console.error(` [MainApp]  Subtabs status: ${gameTab.subtabs?.length || 0} total, ${hasLoadingSubtabs ? 'HAS LOADING' : 'all loaded or none'}`);\r\n              \r\n              if (hasLoadingSubtabs) {\r\n                console.error(' [MainApp]  Starting background refresh for loading subtabs');\r\n                //  FIX: Increase delay to 8 seconds to give background AI task time to complete\r\n                // Background insight generation takes ~5-7 seconds, so we wait 8 to be safe.\r\n                // This prevents excessive polling when subtabs haven't been generated yet.\r\n                setTimeout(() => {\r\n                  console.error(` [MainApp]  Delay complete, starting poll for conversation: ${targetConversationId}`);\r\n                  pollForSubtabUpdates(targetConversationId);\r\n                }, 8000); // Wait 8 seconds before first poll (was 2 seconds)\r\n              } else {\r\n                console.error(` [MainApp]  No loading subtabs for \"${gameTab.title}\", skipping poll`);\r\n              }\r\n            }\r\n          } else {\r\n                        //  No migration - set prompts for current tab (Game Hub or existing game tab)\r\n            if (processedSuggestions.length > 0) {\r\n              console.log(' [MainApp] Setting AI-provided suggestions (no migration):', processedSuggestions);\r\n              setSuggestedPrompts(processedSuggestions);\r\n            } else {\r\n              const fallbackSuggestions = suggestedPromptsService.getFallbackSuggestions(activeConversation.id, activeConversation.isGameHub);\r\n                            setSuggestedPrompts(fallbackSuggestions);\r\n            }\r\n          }\r\n        } else {\r\n                  }\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error(\"Failed to get AI response:\", error);\r\n      \r\n      // Check if it was aborted\r\n      if (error instanceof Error && error.name === 'AbortError') {\r\n                return;\r\n      }\r\n      \r\n      // Use error recovery service\r\n      const recoveryAction = await errorRecoveryService.handleAIError(\r\n        error as Error,\r\n        {\r\n          operation: 'handleSendMessage',\r\n          conversationId: activeConversation.id,\r\n          userId: user?.id,\r\n          timestamp: Date.now(),\r\n          retryCount: 0\r\n        }\r\n      );\r\n      \r\n      // Add error message to chat\r\n      const errorMessage = {\r\n        id: `msg_${Date.now() + 1}`,\r\n        content: recoveryAction.message || \"Sorry, I'm having trouble thinking right now. Please try again.\",\r\n        role: 'assistant' as const,\r\n        timestamp: Date.now(),\r\n      };\r\n      \r\n      // Optimized: Update state immediately\r\n      setConversations(prev => {\r\n        const updated = { ...prev };\r\n        if (updated[activeConversation.id]) {\r\n          updated[activeConversation.id] = {\r\n            ...updated[activeConversation.id],\r\n            messages: [...updated[activeConversation.id].messages, errorMessage],\r\n            updatedAt: Date.now()\r\n          };\r\n          // Update activeConversation immediately so UI reflects the error message\r\n          setActiveConversation(updated[activeConversation.id]);\r\n        }\r\n        return updated;\r\n      });\r\n\r\n      await ConversationService.addMessage(activeConversation.id, errorMessage);\r\n      \r\n      // Display user notification if needed\r\n      if (recoveryAction.type === 'user_notification') {\r\n        errorRecoveryService.displayError(recoveryAction.message || 'An error occurred', 'error');\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n      setAbortController(null);\r\n    }\r\n  };\r\n\r\n  // Update ref whenever handleSendMessage changes\r\n  useEffect(() => {\r\n    handleSendMessageRef.current = handleSendMessage;\r\n  }, [handleSendMessage]);\r\n\r\n  if (isInitializing && (!user || Object.keys(conversations).length === 0)) {\r\n    return (\r\n      <div className=\"h-screen bg-background flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <LoadingSpinner size=\"lg\" className=\"mx-auto mb-4\" />\r\n          <p className=\"text-text-muted\">{!user ? 'Loading...' : 'Initializing chat...'}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // If no user but we have initialization done, still show error or redirect\r\n  if (!user && !isInitializing) {\r\n    return (\r\n      <div className=\"h-screen bg-background flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <p className=\"text-text-muted\">User not found. Please refresh the page.</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"h-screen bg-background flex overflow-hidden\">\r\n      {/* Sidebar */}\r\n      <ErrorBoundary fallback={\r\n        <div className=\"w-64 bg-[#1C1C1C] p-4 border-r border-[#424242] flex items-center justify-center\">\r\n          <div className=\"text-center text-[#CFCFCF]\">\r\n            <p className=\"mb-2 text-2xl\"></p>\r\n            <p className=\"text-sm mb-2\">Sidebar unavailable</p>\r\n            <button \r\n              onClick={() => window.location.reload()}\r\n              className=\"mt-2 px-3 py-1 bg-[#FF4D4D] rounded text-xs hover:bg-[#FF6B6B] transition-colors\"\r\n            >\r\n              Reload\r\n            </button>\r\n          </div>\r\n        </div>\r\n      }>\r\n        <Sidebar\r\n          isOpen={sidebarOpen}\r\n          onClose={() => setSidebarOpen(false)}\r\n          conversations={conversations}\r\n          activeConversation={activeConversation}\r\n          onConversationSelect={handleConversationSelect}\r\n          onDeleteConversation={handleDeleteConversation}\r\n          onPinConversation={handlePinConversation}\r\n          onUnpinConversation={handleUnpinConversation}\r\n          onClearConversation={handleClearConversation}\r\n          onAddGame={handleAddGame}\r\n        />\r\n      </ErrorBoundary>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"flex-1 flex flex-col overflow-hidden\">\r\n        {/* Header */}\r\n        <header className=\"chat-header-fixed bg-surface backdrop-blur-sm border-b border-surface-light/20 px-3 py-3 sm:px-4 sm:py-4 lg:px-6 lg:py-6 flex items-center justify-between\">\r\n          <div className=\"flex items-center space-x-1\">\r\n            <button\r\n              onClick={() => setSidebarOpen(true)}\r\n              className=\"lg:hidden btn-icon p-3 text-text-muted hover:text-text-primary min-h-[44px] min-w-[44px] flex items-center justify-center\"\r\n            >\r\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h16\" />\r\n              </svg>\r\n            </button>\r\n            \r\n            <Logo size=\"sm\" bounce={false} />\r\n          </div>\r\n\r\n          <div className=\"flex items-center space-x-2 sm:space-x-3 lg:space-x-4\">\r\n            <div className=\"mr-1 sm:mr-2\">\r\n              <CreditIndicator \r\n                user={currentUser} \r\n                onClick={handleCreditModalOpen}\r\n              />\r\n            </div>\r\n\r\n            <HandsFreeToggle\r\n              isHandsFree={isHandsFreeMode}\r\n              onToggle={handleHandsFreeToggle}\r\n            />\r\n            \r\n            <button\r\n              onClick={handleConnectionModalOpen}\r\n              className={`btn-icon p-3 transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center ${\r\n                connectionStatus === ConnectionStatus.CONNECTED \r\n                  ? 'text-green-400 hover:text-green-300' \r\n                  : 'text-text-muted hover:text-text-primary'\r\n              }`}\r\n              title={connectionStatus === ConnectionStatus.CONNECTED ? 'PC Connected - Click to manage' : 'Connect to PC'}\r\n            >\r\n              <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" />\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01\" />\r\n              </svg>\r\n            </button>\r\n            \r\n            <button\r\n              onClick={handleSettingsContextMenu}\r\n              className=\"btn-icon p-3 text-text-muted hover:text-text-primary transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center\"\r\n            >\r\n              <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" />\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n              </svg>\r\n            </button>\r\n            \r\n          </div>\r\n        </header>\r\n\r\n        {/* Chat Area */}\r\n        <div className=\"flex-1 flex flex-col overflow-hidden\">\r\n          {/* PWA Install Banner - Show if not installed */}\r\n          <div className=\"flex-shrink-0\">\r\n            <PWAInstallBanner />\r\n          </div>\r\n\r\n          {/* Profile Setup Banner - Show if user hasn't set up profile */}\r\n          {showProfileSetupBanner && onProfileSetupComplete && onProfileSetupDismiss && (\r\n            <div className=\"flex-shrink-0 pt-3 sm:pt-4 lg:pt-6\">\r\n              <ErrorBoundary fallback={<div className=\"px-6 py-2\"><p className=\"text-xs text-[#CFCFCF]\">Profile banner unavailable</p></div>}>\r\n                <ProfileSetupBanner\r\n                  onComplete={onProfileSetupComplete}\r\n                  onDismiss={onProfileSetupDismiss}\r\n                />\r\n              </ErrorBoundary>\r\n            </div>\r\n          )}\r\n\r\n          {/* AdSense Placeholder Banner - Always show for free users */}\r\n          {currentUser.tier === 'free' && (\r\n            <div className=\"px-3 sm:px-4 lg:px-6 pt-0 sm:pt-1 flex-shrink-0\">\r\n              <div className=\"bg-gradient-to-r from-gray-100/10 to-gray-200/10 border border-gray-300/20 rounded-xl p-3 sm:p-4 mb-4 sm:mb-6\">\r\n                <div className=\"flex items-center justify-center h-16 sm:h-20 lg:h-24 bg-gray-100/20 rounded-lg border-2 border-dashed border-gray-300/40\">\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-gray-400 text-xs sm:text-sm font-medium mb-1\">Advertisement</div>\r\n                    <div className=\"text-gray-300 text-xs\">AdSense Placeholder</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Game Progress Bar - Show for game conversations (not Game Hub) */}\r\n          {activeConversation && !activeConversation.isGameHub && activeConversation.gameTitle && (\r\n            <div className=\"px-3 sm:px-4 lg:px-6 pb-3 sm:pb-4 flex-shrink-0\">\r\n              <GameProgressBar \r\n                progress={activeConversation.gameProgress || 0}\r\n                className=\"px-3 sm:px-4\"\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {/* Chat Thread Name - Show on mobile when sidebar is collapsed */}\r\n          {activeConversation && (\r\n            <div className=\"lg:hidden px-3 sm:px-4 mb-3 sm:mb-4 flex-shrink-0\">\r\n              <div className=\"bg-gradient-to-r from-surface/30 to-background/30 backdrop-blur-sm border border-surface-light/20 rounded-lg px-4 py-3\">\r\n                <h2 className=\"text-sm sm:text-base font-semibold bg-gradient-to-r from-[#FF4D4D] to-[#FFAB40] bg-clip-text text-transparent text-center\">\r\n                  {activeConversation.title}\r\n                </h2>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          \r\n            {/* Chat Interface - Takes remaining space */}\r\n            <div className=\"flex-1 min-h-0\">\r\n              <ErrorBoundary fallback={<ChatErrorFallback />}>\r\n                <ChatInterface\r\n                  conversation={activeConversation}\r\n                  onSendMessage={handleSendMessage}\r\n                  isLoading={isLoading}\r\n                  isPCConnected={connectionStatus === ConnectionStatus.CONNECTED}\r\n                  onRequestConnect={handleConnectionModalOpen}\r\n                  userTier={currentUser.tier}\r\n                  onStop={handleStopAI}\r\n                  isManualUploadMode={isManualUploadMode}\r\n                  onToggleManualUploadMode={() => setIsManualUploadMode(!isManualUploadMode)}\r\n                  suggestedPrompts={suggestedPrompts}\r\n                  onSuggestedPromptClick={handleSuggestedPromptClick}\r\n                  activeSession={session}\r\n                  onToggleActiveSession={handleToggleActiveSession}\r\n                  initialMessage={currentInputMessage}\r\n                  onMessageChange={handleInputMessageChange}\r\n                  queuedImage={queuedScreenshot}\r\n                  onImageQueued={handleScreenshotQueued}\r\n                />\r\n              </ErrorBoundary>\r\n            </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Settings Modal */}\r\n      <SettingsModal\r\n        isOpen={settingsOpen}\r\n        onClose={() => setSettingsOpen(false)}\r\n        user={currentUser}\r\n      />\r\n\r\n      {/* Credit Modal */}\r\n      <CreditModal\r\n        isOpen={creditModalOpen}\r\n        onClose={handleCreditModalClose}\r\n        onUpgrade={handleUpgrade}\r\n        user={currentUser}\r\n      />\r\n\r\n      {/* Connection Modal */}\r\n      <ConnectionModal\r\n        isOpen={connectionModalOpen}\r\n        onClose={handleConnectionModalClose}\r\n        onConnect={handleConnect}\r\n        onDisconnect={handleDisconnect}\r\n        onClearError={handleClearConnectionError}\r\n        status={connectionStatus}\r\n        error={connectionError}\r\n        connectionCode={connectionCode}\r\n        lastSuccessfulConnection={lastSuccessfulConnection}\r\n      />\r\n\r\n      {/* Hands-Free Modal */}\r\n      <HandsFreeModal\r\n        isOpen={handsFreeModalOpen}\r\n        onClose={handleHandsFreeModalClose}\r\n        isHandsFree={isHandsFreeMode}\r\n        onToggleHandsFree={handleToggleHandsFreeFromModal}\r\n      />\r\n\r\n      {/* Add Game Modal */}\r\n      <AddGameModal\r\n        isOpen={addGameModalOpen}\r\n        onClose={() => setAddGameModalOpen(false)}\r\n        onCreateGame={handleCreateGame}\r\n      />\r\n\r\n      {/* Settings Context Menu */}\r\n      <SettingsContextMenu\r\n        isOpen={settingsContextMenu.isOpen}\r\n        position={settingsContextMenu.position}\r\n        onClose={closeSettingsContextMenu}\r\n        onOpenSettings={handleOpenSettings}\r\n        onOpenGuide={handleOpenGuide}\r\n        onLogout={handleLogout}\r\n        userTier={currentUser.tier}\r\n        onTrialStart={async () => {\r\n          // Refresh user data after trial starts\r\n          await authService.refreshUser();\r\n          const refreshedUser = authService.getCurrentUser();\r\n          if (refreshedUser) {\r\n            setUser(refreshedUser);\r\n          }\r\n        }}\r\n      />\r\n\r\n      {/* Welcome Screen / Guide */}\r\n      {welcomeScreenOpen && (\r\n        <WelcomeScreen\r\n          onStartChat={() => setWelcomeScreenOpen(false)}\r\n          onAddGame={handleAddGame}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MainApp;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useSearchParams, useLoaderData } from 'react-router-dom';\r\nimport LandingPage from '../../components/LandingPageFresh';\r\nimport AboutModal from '../../components/modals/AboutModal';\r\nimport PrivacyModal from '../../components/modals/PrivacyModal';\r\nimport TermsModal from '../../components/modals/TermsModal';\r\nimport RefundPolicyModal from '../../components/modals/RefundPolicyModal';\r\nimport ContactUsModal from '../../components/modals/ContactUsModal';\r\nimport type { User, OnboardingStatus } from '../../types';\r\n\r\n/**\r\n * Route wrapper for LandingPage - converts React Router navigation to component props\r\n * Handles modals via URL search params (?modal=about, ?modal=privacy, etc.)\r\n */\r\nconst LandingPageRoute: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const [activeModal, setActiveModal] = useState<string | null>(null);\r\n  const loaderData = useLoaderData() as { user: Partial<User> | null; onboardingStatus: OnboardingStatus };\r\n\r\n    console.log('[LandingPageRoute] Search params:', Object.fromEntries(searchParams.entries()));\r\n    // Redirect authenticated users to appropriate screen\r\n  useEffect(() => {\r\n    if (loaderData?.user && loaderData.onboardingStatus) {\r\n      const { onboardingStatus } = loaderData;\r\n            // Only redirect if onboarding status is valid\r\n      if (onboardingStatus === 'complete') {\r\n                navigate('/app', { replace: true });\r\n      } else if (onboardingStatus !== 'login') {\r\n                navigate('/onboarding', { replace: true });\r\n      }\r\n    }\r\n  }, [loaderData, navigate]);\r\n\r\n  // Sync modal state with URL params\r\n  useEffect(() => {\r\n    const modal = searchParams.get('modal');\r\n    setActiveModal(modal);\r\n  }, [searchParams]);\r\n\r\n  const handleGetStarted = () => {\r\n        navigate('/login');\r\n  };\r\n\r\n  const handleOpenAbout = () => {\r\n    setSearchParams({ modal: 'about' });\r\n  };\r\n\r\n  const handleOpenPrivacy = () => {\r\n    setSearchParams({ modal: 'privacy' });\r\n  };\r\n\r\n  const handleOpenRefund = () => {\r\n    setSearchParams({ modal: 'refund' });\r\n  };\r\n\r\n  const handleOpenTerms = () => {\r\n    setSearchParams({ modal: 'terms' });\r\n  };\r\n\r\n  const handleOpenContact = () => {\r\n    setSearchParams({ modal: 'contact' });\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setSearchParams({});\r\n  };\r\n\r\n  const handleDirectNavigation = (path: string) => {\r\n    navigate(path);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <LandingPage\r\n        onGetStarted={handleGetStarted}\r\n        onOpenAbout={handleOpenAbout}\r\n        onOpenPrivacy={handleOpenPrivacy}\r\n        onOpenRefund={handleOpenRefund}\r\n        onOpenTerms={handleOpenTerms}\r\n        onOpenContact={handleOpenContact}\r\n        onDirectNavigation={handleDirectNavigation}\r\n      />\r\n      {/* Modals controlled by URL params */}\r\n      <AboutModal isOpen={activeModal === 'about'} onClose={handleCloseModal} />\r\n      <PrivacyModal isOpen={activeModal === 'privacy'} onClose={handleCloseModal} />\r\n      <TermsModal isOpen={activeModal === 'terms'} onClose={handleCloseModal} />\r\n      <RefundPolicyModal isOpen={activeModal === 'refund'} onClose={handleCloseModal} />\r\n      <ContactUsModal isOpen={activeModal === 'contact'} onClose={handleCloseModal} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default LandingPageRoute;\r\n","import React, { useEffect } from 'react';\r\nimport { useNavigate, useLoaderData } from 'react-router-dom';\r\nimport LoginSplashScreen from '../../components/splash/LoginSplashScreen';\r\nimport type { User, OnboardingStatus } from '../../types';\r\n\r\n/**\r\n * Route wrapper for LoginSplashScreen\r\n * Bridges React Router navigation with component props\r\n * Note: LoginSplashScreen has its own modal state (Terms & Privacy)\r\n */\r\nconst LoginRoute: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const loaderData = useLoaderData() as { user: Partial<User> | null; onboardingStatus: OnboardingStatus };\r\n\r\n  // Redirect authenticated users to appropriate screen\r\n  useEffect(() => {\r\n    if (loaderData?.user) {\r\n      const { onboardingStatus } = loaderData;\r\n            if (onboardingStatus === 'complete') {\r\n                navigate('/app', { replace: true });\r\n      } else {\r\n                navigate('/onboarding', { replace: true });\r\n      }\r\n    }\r\n  }, [loaderData, navigate]);\r\n\r\n  const handleComplete = () => {\r\n    // After login, navigate to onboarding (loader will determine correct step)\r\n    navigate('/onboarding');\r\n  };\r\n\r\n  const handleBackToLanding = () => {\r\n    // Return to landing page\r\n    navigate('/');\r\n  };\r\n\r\n  const handleSetAppState = () => {\r\n    // In router mode, state updates are handled by router loaders\r\n    // This is a no-op since navigation state is derived from URL\r\n      };\r\n\r\n  return (\r\n    <LoginSplashScreen\r\n      onComplete={handleComplete}\r\n      onBackToLanding={handleBackToLanding}\r\n      onSetAppState={handleSetAppState}\r\n    />\r\n  );\r\n};\r\n\r\nexport default LoginRoute;\r\n","import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport AuthCallback from '../../components/auth/AuthCallback';\r\n\r\n/**\r\n * Route wrapper for AuthCallback\r\n * Handles OAuth callback flow in React Router mode\r\n */\r\nconst AuthCallbackRoute: React.FC = () => {\r\n  const navigate = useNavigate();\r\n\r\n  const handleAuthSuccess = () => {\r\n        // After successful OAuth, navigate to onboarding\r\n    // The onboarding loader will determine the correct step\r\n    navigate('/onboarding');\r\n  };\r\n\r\n  const handleAuthError = (error: string) => {\r\n    console.error('[AuthCallbackRoute] Auth error:', error);\r\n    // On error, navigate back to landing page\r\n    navigate('/');\r\n  };\r\n\r\n  return (\r\n    <AuthCallback\r\n      onAuthSuccess={handleAuthSuccess}\r\n      onAuthError={handleAuthError}\r\n    />\r\n  );\r\n};\r\n\r\nexport default AuthCallbackRoute;\r\n","import React from 'react';\r\nimport { useNavigate, useLoaderData } from 'react-router-dom';\r\nimport InitialSplashScreen from '../../components/splash/InitialSplashScreen';\r\nimport type { User } from '../../types';\r\n\r\n/**\r\n * Route wrapper for InitialSplashScreen\r\n * Bridges React Router navigation with component props\r\n */\r\nconst InitialOnboardingRoute: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useLoaderData() as { user: User | null };\r\n\r\n  const handleComplete = () => {\r\n    // After initial splash, navigate to how-to-use screen\r\n    navigate('/onboarding/how-to-use');\r\n  };\r\n\r\n  return (\r\n    <InitialSplashScreen\r\n      onComplete={handleComplete}\r\n      user={user}\r\n    />\r\n  );\r\n};\r\n\r\nexport default InitialOnboardingRoute;\r\n","import React from 'react';\r\nimport { useNavigate, useLoaderData } from 'react-router-dom';\r\nimport SplashScreen from '../../components/splash/SplashScreen';\r\nimport { ConnectionStatus } from '../../types';\r\nimport type { User } from '../../types';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { connect as connectWebSocket, disconnect as disconnectWebSocket } from '../../services/websocketService';\r\n\r\n/**\r\n * Route wrapper for SplashScreen (connection setup)\r\n * Bridges React Router navigation with component props\r\n */\r\nconst HowToUseRoute: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useLoaderData() as { user: User | null };\r\n  \r\n  const [status, setStatus] = React.useState<ConnectionStatus>(ConnectionStatus.DISCONNECTED);\r\n  const [error, setError] = React.useState<string | null>(null);\r\n  const [connectionCode, setConnectionCode] = React.useState<string | null>(null);\r\n\r\n  // Restore connection code from localStorage on mount\r\n  React.useEffect(() => {\r\n    const savedCode = localStorage.getItem('otakon_connection_code');\r\n    if (savedCode) {\r\n      setConnectionCode(savedCode);\r\n          }\r\n  }, []);\r\n\r\n  // Cleanup: Disconnect WebSocket when user navigates away from this screen\r\n  React.useEffect(() => {\r\n    return () => {\r\n      // Only disconnect if we're in CONNECTING state (user navigated away before completion)\r\n      // Don't disconnect if CONNECTED - user successfully connected and moved forward\r\n      if (status === ConnectionStatus.CONNECTING) {\r\n                disconnectWebSocket();\r\n        // Clear the pending connection code so user can try again\r\n        setConnectionCode(null);\r\n        setStatus(ConnectionStatus.DISCONNECTED);\r\n      }\r\n    };\r\n  }, [status]);\r\n\r\n  const handleSkipConnection = async () => {\r\n        // Update database before navigation\r\n    if (user) {\r\n      try {\r\n        const { error } = await supabase\r\n          .from('users')\r\n          .update({\r\n            pc_connection_skipped: true,\r\n            has_seen_how_to_use: true,\r\n            app_state: {\r\n              onboardingStatus: 'pro-features',\r\n              hasSeenHowToUse: true,\r\n              pcConnectionSkipped: true,\r\n              completedHowToUseAt: new Date().toISOString()\r\n            }\r\n          })\r\n          .eq('auth_user_id', user.authUserId);\r\n          \r\n        if (error) {\r\n          console.error('[HowToUseRoute] Failed to update database:', error);\r\n        } else {\r\n          console.log('[HowToUseRoute] Database updated, onboarding status: pro-features (skipped connection)');\r\n        }\r\n      } catch (error) {\r\n        console.error('[HowToUseRoute] Error updating database:', error);\r\n      }\r\n    }\r\n    \r\n    // Skip users go directly to Pro Features screen\r\n    navigate('/onboarding/pro-features');\r\n  };\r\n\r\n  const handleConnect = (code: string) => {\r\n        // Reset error state for retry\r\n    setError(null);\r\n    setStatus(ConnectionStatus.CONNECTING);\r\n    setConnectionCode(code);\r\n\r\n    // Store code in localStorage for persistence (use same key as MainApp)\r\n    localStorage.setItem('otakon_connection_code', code);\r\n    localStorage.setItem('otakon_last_connection', new Date().toISOString());\r\n\r\n    // Connect via WebSocket\r\n    connectWebSocket(\r\n      code,\r\n      // onOpen\r\n      () => {\r\n                // Don't set as connected yet - wait for PC client response\r\n      },\r\n      // onMessage\r\n      (data: Record<string, unknown>) => {\r\n                // Check if this is a connection confirmation from PC client\r\n        // PC client sends: {type: 'partner_connected'} immediately, then {type: 'connection_alive'} later\r\n        if (data.type === 'partner_connected' || data.type === 'connection_alive' || data.type === 'connected' || data.status === 'connected') {\r\n                    setStatus(ConnectionStatus.CONNECTED);\r\n          setError(null);\r\n          \r\n          // Mark as having connected before\r\n          localStorage.setItem('otakonHasConnectedBefore', 'true');\r\n          \r\n          // Update user database record with connection status\r\n          if (user) {\r\n            supabase\r\n              .from('users')\r\n              .update({\r\n                pc_connected: true\r\n              })\r\n              .eq('auth_user_id', user.authUserId)\r\n              .then(({ error: dbError }) => {\r\n                if (dbError) {\r\n                  console.error('[HowToUseRoute] Failed to update PC connection in database:', dbError);\r\n                } else {\r\n                                  }\r\n              });\r\n          }\r\n        }\r\n      },\r\n      // onError\r\n      (errorMsg: string) => {\r\n        console.error('[HowToUseRoute] WebSocket error:', errorMsg);\r\n        // User-friendly error messages\r\n        let displayError = errorMsg;\r\n        if (errorMsg.includes('Connection to the server failed')) {\r\n          displayError = 'Unable to connect. Please check that:\\n The code is correct\\n PC client is running\\n Both devices are online';\r\n        } else if (errorMsg.includes('Invalid code')) {\r\n          displayError = 'Please enter a valid 6-digit code';\r\n        }\r\n        setError(displayError);\r\n        setStatus(ConnectionStatus.ERROR);\r\n        // Reset connection code so user can try again\r\n        setConnectionCode(code);\r\n      },\r\n      // onClose\r\n      () => {\r\n                // Only set to disconnected if not in error state\r\n        if (status !== ConnectionStatus.ERROR) {\r\n          setStatus(ConnectionStatus.DISCONNECTED);\r\n        }\r\n      }\r\n    );\r\n  };\r\n\r\n  const handleConnectionSuccess = async () => {\r\n        // Navigate immediately for smooth UX\r\n    navigate('/onboarding/features');\r\n    \r\n    // Update database in background (optimistic navigation)\r\n    if (user) {\r\n      try {\r\n        const { error } = await supabase\r\n          .from('users')\r\n          .update({\r\n            pc_connected: true,\r\n            has_seen_how_to_use: true,\r\n            app_state: {\r\n              onboardingStatus: 'features-connected',\r\n              hasSeenHowToUse: true,\r\n              pcConnected: true,\r\n              completedHowToUseAt: new Date().toISOString()\r\n            }\r\n          })\r\n          .eq('auth_user_id', user.authUserId);\r\n          \r\n        if (error) {\r\n          console.error('[HowToUseRoute] Background DB update failed:', error);\r\n        } else {\r\n                  }\r\n      } catch (error) {\r\n        console.error('[HowToUseRoute] Background DB update error:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <SplashScreen\r\n      onSkipConnection={handleSkipConnection}\r\n      onConnect={handleConnect}\r\n      status={status}\r\n      error={error}\r\n      connectionCode={connectionCode}\r\n      onConnectionSuccess={handleConnectionSuccess}\r\n    />\r\n  );\r\n};\r\n\r\nexport default HowToUseRoute;\r\n","import React from 'react';\r\nimport { useNavigate, useLoaderData } from 'react-router-dom';\r\nimport HowToUseSplashScreen from '../../components/splash/HowToUseSplashScreen';\r\nimport type { User } from '../../types';\r\nimport { supabase } from '../../lib/supabase';\r\n\r\n/**\r\n * Route wrapper for HowToUseSplashScreen (\"You're Connected!\" screen)\r\n * Shown only after successful PC connection\r\n * Bridges React Router navigation with component props\r\n */\r\nconst FeaturesConnectedRoute: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useLoaderData() as { user: User | null };\r\n\r\n  const handleComplete = async () => {\r\n        // Navigate immediately for smooth UX\r\n    navigate('/onboarding/pro-features');\r\n    \r\n    // Update database in background (optimistic navigation)\r\n    if (user) {\r\n      try {\r\n        const { error } = await supabase\r\n          .from('users')\r\n          .update({\r\n            has_seen_features_connected: true,\r\n            app_state: {\r\n              onboardingStatus: 'pro-features',\r\n              hasSeenFeaturesConnected: true,\r\n              completedFeaturesAt: new Date().toISOString()\r\n            }\r\n          })\r\n          .eq('auth_user_id', user.authUserId);\r\n          \r\n        if (error) {\r\n          console.error('[FeaturesConnectedRoute] Background DB update failed:', error);\r\n        } else {\r\n                  }\r\n      } catch (error) {\r\n        console.error('[FeaturesConnectedRoute] Background DB update error:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <HowToUseSplashScreen\r\n      onComplete={handleComplete}\r\n    />\r\n  );\r\n};\r\n\r\nexport default FeaturesConnectedRoute;\r\n","import React from 'react';\r\nimport { useNavigate, useLoaderData } from 'react-router-dom';\r\nimport ProFeaturesSplashScreen from '../../components/splash/ProFeaturesSplashScreen';\r\nimport type { User } from '../../types';\r\nimport { supabase } from '../../lib/supabase';\r\n\r\n/**\r\n * Route wrapper for ProFeaturesSplashScreen\r\n * Bridges React Router navigation with component props\r\n */\r\nconst ProFeaturesRoute: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useLoaderData() as { user: User | null };\r\n\r\n  const handleComplete = async () => {\r\n        // Update database FIRST to avoid race condition with router loader\r\n    if (user) {\r\n      try {\r\n        const { error } = await supabase\r\n          .from('users')\r\n          .update({\r\n            has_seen_pro_features: true,\r\n            onboarding_completed: true,\r\n            app_state: {\r\n              onboardingStatus: 'complete',\r\n              hasSeenProFeatures: true,\r\n              onboardingCompleted: true,\r\n              completedOnboardingAt: new Date().toISOString()\r\n            }\r\n          })\r\n          .eq('auth_user_id', user.authUserId);\r\n          \r\n        if (error) {\r\n          console.error('[ProFeaturesRoute] DB update failed:', error);\r\n        } else {\r\n                  }\r\n      } catch (error) {\r\n        console.error('[ProFeaturesRoute] DB update error:', error);\r\n      }\r\n    }\r\n    \r\n    // Navigate after DB update to prevent race condition\r\n    navigate('/app');\r\n  };\r\n\r\n  const handleUpgrade = () => {\r\n    // TODO: Implement upgrade modal/flow\r\n      };\r\n\r\n  const handleUpgradeToVanguard = () => {\r\n    // TODO: Implement Vanguard upgrade modal/flow\r\n      };\r\n\r\n  return (\r\n    <ProFeaturesSplashScreen\r\n      onComplete={handleComplete}\r\n      onUpgrade={handleUpgrade}\r\n      onUpgradeToVanguard={handleUpgradeToVanguard}\r\n    />\r\n  );\r\n};\r\n\r\nexport default ProFeaturesRoute;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useLoaderData, useSearchParams } from 'react-router-dom';\r\nimport MainApp from '../../components/MainApp';\r\nimport AboutModal from '../../components/modals/AboutModal';\r\nimport PrivacyModal from '../../components/modals/PrivacyModal';\r\nimport TermsModal from '../../components/modals/TermsModal';\r\nimport { ConnectionStatus } from '../../types';\r\nimport type { User } from '../../types';\r\n\r\n/**\r\n * Route wrapper for MainApp\r\n * Bridges React Router navigation with component props\r\n * Handles footer modals via URL search params\r\n */\r\nconst MainAppRoute: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useLoaderData() as { user: User | null };\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const [activeModal, setActiveModal] = useState<string | null>(null);\r\n  const [connectionStatus, setConnectionStatus] = useState<ConnectionStatus>(ConnectionStatus.DISCONNECTED);\r\n  const [connectionCode, setConnectionCode] = useState<string | null>(null);\r\n\r\n  // Initialize connection state from localStorage on mount\r\n  useEffect(() => {\r\n    const savedCode = localStorage.getItem('otakon_connection_code');\r\n    if (savedCode) {\r\n            setConnectionCode(savedCode);\r\n      setConnectionStatus(ConnectionStatus.CONNECTED);\r\n    }\r\n  }, []);\r\n\r\n  // Sync modal state with URL params\r\n  useEffect(() => {\r\n    const modal = searchParams.get('modal');\r\n    setActiveModal(modal);\r\n  }, [searchParams]);\r\n\r\n  const handleLogout = async () => {\r\n    // Import authService dynamically to avoid circular deps\r\n    const { authService } = await import('../../services/authService');\r\n    await authService.signOut();\r\n    // Navigate to login page after logout\r\n    navigate('/login');\r\n  };\r\n\r\n  const handleOpenSettings = () => {\r\n    // TODO: Implement settings navigation\r\n      };\r\n\r\n  const handleOpenAbout = () => {\r\n    setSearchParams({ modal: 'about' });\r\n  };\r\n\r\n  const handleOpenPrivacy = () => {\r\n    setSearchParams({ modal: 'privacy' });\r\n  };\r\n\r\n  const handleOpenTerms = () => {\r\n    setSearchParams({ modal: 'terms' });\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setSearchParams({});\r\n  };\r\n\r\n  const handleConnect = (code: string) => {\r\n        setConnectionCode(code);\r\n    setConnectionStatus(ConnectionStatus.CONNECTED);\r\n  };\r\n\r\n  const handleDisconnect = () => {\r\n        setConnectionCode(null);\r\n    setConnectionStatus(ConnectionStatus.DISCONNECTED);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <MainApp\r\n        user={user}\r\n        onLogout={handleLogout}\r\n        onOpenSettings={handleOpenSettings}\r\n        onOpenAbout={handleOpenAbout}\r\n        onOpenPrivacy={handleOpenPrivacy}\r\n        onOpenTerms={handleOpenTerms}\r\n        connectionStatus={connectionStatus}\r\n        onConnect={handleConnect}\r\n        onDisconnect={handleDisconnect}\r\n        pcConnectionCode={connectionCode}\r\n        pcConnectionError={null}\r\n        isGamesRefreshing={false}\r\n        isConversationsRefreshing={false}\r\n        isOAuthProcessing={false}\r\n        isPcConnecting={false}\r\n        isPcDisconnecting={false}\r\n        hasPendingRequests={false}\r\n        showProfileSetupBanner={!user?.hasProfileSetup}\r\n        onProfileSetupComplete={async (profileData) => {\r\n                    // Save profile data and mark setup as complete\r\n          const { authService } = await import('../../services/authService');\r\n          await authService.updateUser({ \r\n            has_profile_setup: true,\r\n            profile_data: profileData\r\n          });\r\n          // Refresh to show updated state\r\n          window.location.reload();\r\n        }}\r\n        onProfileSetupDismiss={async () => {\r\n                    // Mark as dismissed in database (without saving profile data)\r\n          const { authService } = await import('../../services/authService');\r\n          await authService.updateUser({ has_profile_setup: true });\r\n          // Force re-render without full page reload\r\n          window.location.reload();\r\n        }}\r\n      />\r\n      {/* Footer modals controlled by URL params */}\r\n      <AboutModal isOpen={activeModal === 'about'} onClose={handleCloseModal} />\r\n      <PrivacyModal isOpen={activeModal === 'privacy'} onClose={handleCloseModal} />\r\n      <TermsModal isOpen={activeModal === 'terms'} onClose={handleCloseModal} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MainAppRoute;\r\n","import { createBrowserRouter, RouteObject, redirect, LoaderFunctionArgs } from 'react-router-dom';\r\nimport { supabase } from '../lib/supabase';\r\nimport type { User, OnboardingStatus, UserTier } from '../types';\r\n\r\n// Import route wrapper components directly (not lazy - they're already wrapped in Suspense in App.tsx)\r\nimport LandingPageRoute from './routes/LandingPageRoute';\r\nimport LoginRoute from './routes/LoginRoute';\r\nimport AuthCallbackRoute from './routes/AuthCallbackRoute';\r\nimport InitialOnboardingRoute from './routes/InitialOnboardingRoute';\r\nimport HowToUseRoute from './routes/HowToUseRoute';\r\nimport FeaturesConnectedRoute from './routes/FeaturesConnectedRoute';\r\nimport ProFeaturesRoute from './routes/ProFeaturesRoute';\r\nimport MainAppRoute from './routes/MainAppRoute';\r\n\r\n/**\r\n * Router loader: Check authentication and onboarding status\r\n * This runs before each route renders to ensure proper navigation flow\r\n */\r\nasync function authLoader({ request }: LoaderFunctionArgs) {\r\n  const url = new URL(request.url);\r\n  const pathname = url.pathname;\r\n\r\n    // Get current auth session\r\n  const { data: { session } } = await supabase.auth.getSession();\r\n  \r\n  if (!session) {\r\n    // Not authenticated - allow access to landing and login pages\r\n        if (pathname !== '/' && pathname !== '/earlyaccess') {\r\n            return redirect('/');\r\n    }\r\n    return { user: null, onboardingStatus: 'login' as OnboardingStatus };\r\n  }\r\n\r\n    // Use RPC function to get complete user data\r\n  const { data: rpcData, error: rpcError } = await supabase\r\n    .rpc('get_complete_user_data', { p_auth_user_id: session.user.id });\r\n\r\n  if (rpcError || !rpcData || rpcData.length === 0) {\r\n    // If user has a session but no database record, redirect to onboarding\r\n    if (session) {\r\n            if (pathname === '/' || pathname === '/login') {\r\n        return redirect('/onboarding');\r\n      }\r\n      return { user: null, onboardingStatus: 'initial' as OnboardingStatus };\r\n    }\r\n    \r\n        return { user: null, onboardingStatus: 'login' as OnboardingStatus };\r\n  }\r\n\r\n  const userData = rpcData[0];\r\n\r\n  // Parse app_state to get onboarding status\r\n  const appState = (userData.app_state || {}) as import('../types/enhanced').UserAppState;\r\n  const onboardingStatus: OnboardingStatus = (appState.onboardingStatus as OnboardingStatus) || 'initial';\r\n\r\n    // Redirect authenticated users away from landing/login pages\r\n  if (pathname === '/' || pathname === '/earlyaccess') {\r\n    if (onboardingStatus === 'complete') {\r\n            return redirect('/app');\r\n    } else if (onboardingStatus !== 'login') {\r\n            return redirect('/onboarding');\r\n    }\r\n  }\r\n\r\n  // Map user data to User type\r\n  const user: Partial<User> = {\r\n    id: userData.id,\r\n    authUserId: userData.auth_user_id,\r\n    email: userData.email,\r\n    tier: userData.tier as UserTier,\r\n    hasProfileSetup: userData.has_profile_setup ?? undefined,\r\n    hasSeenSplashScreens: userData.has_seen_splash_screens ?? undefined,\r\n    hasSeenHowToUse: userData.has_seen_how_to_use ?? undefined,\r\n    hasSeenFeaturesConnected: userData.has_seen_features_connected ?? undefined,\r\n    hasSeenProFeatures: userData.has_seen_pro_features ?? undefined,\r\n    pcConnected: userData.pc_connected ?? undefined,\r\n    pcConnectionSkipped: userData.pc_connection_skipped ?? undefined,\r\n    onboardingCompleted: userData.onboarding_completed ?? undefined,\r\n    hasWelcomeMessage: userData.has_welcome_message ?? undefined,\r\n    isNewUser: userData.is_new_user ?? undefined,\r\n    hasUsedTrial: userData.has_used_trial ?? undefined,\r\n    textCount: userData.text_count || 0,\r\n    imageCount: userData.image_count || 0,\r\n    textLimit: userData.text_limit || 0,\r\n    imageLimit: userData.image_limit || 0,\r\n    totalRequests: userData.total_requests || 0,\r\n    lastReset: userData.last_reset ? new Date(userData.last_reset).getTime() : Date.now(),\r\n    createdAt: userData.created_at ? new Date(userData.created_at).getTime() : Date.now(),\r\n    updatedAt: userData.updated_at ? new Date(userData.updated_at).getTime() : Date.now(),\r\n  };\r\n\r\n  return { user, onboardingStatus };\r\n}\r\n\r\n/**\r\n * Onboarding guard: Redirect to appropriate onboarding step\r\n */\r\nasync function onboardingLoader({ request }: LoaderFunctionArgs) {\r\n  const result = await authLoader({ request, params: {}, context: {} });\r\n  const { user, onboardingStatus } = result as { user: Partial<User>; onboardingStatus: string };\r\n  \r\n  if (!user) {\r\n        return redirect('/');\r\n  }\r\n\r\n    const currentPath = new URL(request.url).pathname;\r\n\r\n  // If onboarding is complete, redirect to app (unless they're explicitly viewing onboarding screens)\r\n  if (onboardingStatus === 'complete') {\r\n        return redirect('/app');\r\n  }\r\n\r\n  // Define valid onboarding paths\r\n  const validOnboardingPaths = [\r\n    '/onboarding/welcome',\r\n    '/onboarding/how-to-use',\r\n    '/onboarding/features',\r\n    '/onboarding/pro-features',\r\n  ];\r\n\r\n  // Allow free navigation through all onboarding screens\r\n  if (validOnboardingPaths.includes(currentPath)) {\r\n        return { user, onboardingStatus };\r\n  }\r\n\r\n  // Handle /onboarding root path - redirect to first screen\r\n  if (currentPath === '/onboarding') {\r\n        return redirect('/onboarding/welcome');\r\n  }\r\n\r\n  // Invalid path - redirect to welcome\r\n    return redirect('/onboarding/welcome');\r\n}\r\n\r\n/**\r\n * App guard: Ensure onboarding is complete before accessing main app\r\n */\r\nasync function appLoader({ request }: LoaderFunctionArgs) {\r\n  const result = await authLoader({ request, params: {}, context: {} });\r\n  const { user, onboardingStatus } = result as { user: Partial<User>; onboardingStatus: string };\r\n  \r\n  if (!user) {\r\n        return redirect('/');\r\n  }\r\n\r\n    if (onboardingStatus !== 'complete') {\r\n        return redirect('/onboarding');\r\n  }\r\n\r\n    return { user, onboardingStatus };\r\n}\r\n\r\n/**\r\n * Route definitions\r\n */\r\nconst routes: RouteObject[] = [\r\n  {\r\n    path: '/',\r\n    loader: authLoader,\r\n    element: <LandingPageRoute />,\r\n  },\r\n  {\r\n    path: '/earlyaccess',\r\n    loader: authLoader,\r\n    element: <LoginRoute />,\r\n  },\r\n  {\r\n    path: '/auth/callback',\r\n    element: <AuthCallbackRoute />,\r\n  },\r\n  {\r\n    path: '/onboarding',\r\n    loader: onboardingLoader,\r\n    children: [\r\n      {\r\n        index: true,\r\n        loader: onboardingLoader,\r\n        element: <InitialOnboardingRoute />,\r\n      },\r\n      {\r\n        path: 'welcome',\r\n        loader: onboardingLoader,\r\n        element: <InitialOnboardingRoute />,\r\n      },\r\n      {\r\n        path: 'how-to-use',\r\n        loader: onboardingLoader,\r\n        element: <HowToUseRoute />,\r\n      },\r\n      {\r\n        path: 'features',\r\n        loader: onboardingLoader,\r\n        element: <FeaturesConnectedRoute />,\r\n      },\r\n      {\r\n        path: 'pro-features',\r\n        loader: onboardingLoader,\r\n        element: <ProFeaturesRoute />,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    path: '/app',\r\n    loader: appLoader,\r\n    element: <MainAppRoute />,\r\n  },\r\n  {\r\n    path: '/app/*',\r\n    loader: appLoader,\r\n    element: <MainAppRoute />,\r\n  },\r\n  // Catch-all: redirect to home\r\n  {\r\n    path: '*',\r\n    loader: () => redirect('/'),\r\n  },\r\n];\r\n\r\n/**\r\n * Create router with base path support for GitHub Pages\r\n */\r\nexport const router = createBrowserRouter(routes, {\r\n  basename: '/',\r\n});\r\n\r\n/**\r\n * Helper function to check if router should be used\r\n */\r\nexport function shouldUseRouter(): boolean {\r\n  return import.meta.env.VITE_USE_ROUTER === 'true';\r\n}\r\n","import { Suspense } from 'react';\r\nimport App from './App';\r\nimport { RouterProvider } from 'react-router-dom';\r\nimport { router } from './router';\r\n\r\n// Wrapper to handle router switching since App.tsx won't reload\r\nexport default function AppWrapper() {\r\n  const envValue = import.meta.env.VITE_USE_ROUTER;\r\n  const useRouter = envValue === 'true' || envValue === true;\r\n\r\n  if (useRouter) {\r\n    return (\r\n      <Suspense fallback={\r\n        <div className=\"min-h-screen bg-[#0A0A0A] flex items-center justify-center\">\r\n          <div className=\"text-white text-xl\">Loading...</div>\r\n        </div>\r\n      }>\r\n        <RouterProvider router={router} />\r\n      </Suspense>\r\n    );\r\n  }\r\n\r\n  return <App />;\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport AppWrapper from './AppWrapper.tsx';\r\nimport ErrorBoundary from './components/ErrorBoundary.tsx';\r\nimport './styles/globals.css';\r\n\r\n// Application entry point\r\nReactDOM.createRoot(document.getElementById('root')!).render(\r\n  <React.StrictMode>\r\n    <ErrorBoundary>\r\n      <AppWrapper />\r\n    </ErrorBoundary>\r\n  </React.StrictMode>,\r\n)"],"file":"assets/index-BgDESiM8.js"}